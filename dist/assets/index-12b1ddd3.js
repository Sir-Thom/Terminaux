(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))k(T);new MutationObserver(T=>{for(const H of T)if(H.type==="childList")for(const B of H.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&k(B)}).observe(document,{childList:!0,subtree:!0});function b(T){const H={};return T.integrity&&(H.integrity=T.integrity),T.referrerPolicy&&(H.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?H.credentials="include":T.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function k(T){if(T.ep)return;T.ep=!0;const H=b(T);fetch(T.href,H)}})();const At=(u,f)=>u===f,Ue={equals:At};let Ge=Ze;const ne=1,ve=2,Xe={owned:null,cleanups:null,context:null,owner:null};var ee=null;let Ae=null,J=null,ie=null,re=null,we=0;function Rt(u,f){const b=J,k=ee,T=u.length===0,H=T?Xe:{owned:null,cleanups:null,context:null,owner:f===void 0?k:f},B=T?u:()=>u(()=>ue(()=>Le(H)));ee=H,J=null;try{return _e(B,!0)}finally{J=b,ee=k}}function Me(u,f){f=f?Object.assign({},Ue,f):Ue;const b={value:u,observers:null,observerSlots:null,comparator:f.equals||void 0},k=T=>(typeof T=="function"&&(T=T(b.value)),Ye(b,T));return[Tt.bind(b),k]}function de(u,f,b){const k=Je(u,f,!1,ne);Ee(k)}function xt(u,f,b){Ge=Ot;const k=Je(u,f,!1,ne);(!b||!b.render)&&(k.user=!0),re?re.push(k):Ee(k)}function ue(u){if(J===null)return u();const f=J;J=null;try{return u()}finally{J=f}}function Mt(u){return ee===null||(ee.cleanups===null?ee.cleanups=[u]:ee.cleanups.push(u)),u}function Tt(){if(this.sources&&this.state)if(this.state===ne)Ee(this);else{const u=ie;ie=null,_e(()=>ge(this),!1),ie=u}if(J){const u=this.observers?this.observers.length:0;J.sources?(J.sources.push(this),J.sourceSlots.push(u)):(J.sources=[this],J.sourceSlots=[u]),this.observers?(this.observers.push(J),this.observerSlots.push(J.sources.length-1)):(this.observers=[J],this.observerSlots=[J.sources.length-1])}return this.value}function Ye(u,f,b){let k=u.value;return(!u.comparator||!u.comparator(k,f))&&(u.value=f,u.observers&&u.observers.length&&_e(()=>{for(let T=0;T<u.observers.length;T+=1){const H=u.observers[T],B=Ae&&Ae.running;B&&Ae.disposed.has(H),(B?!H.tState:!H.state)&&(H.pure?ie.push(H):re.push(H),H.observers&&Qe(H)),B||(H.state=ne)}if(ie.length>1e6)throw ie=[],new Error},!1)),f}function Ee(u){if(!u.fn)return;Le(u);const f=ee,b=J,k=we;J=ee=u,Bt(u,u.value,k),J=b,ee=f}function Bt(u,f,b){let k;try{k=u.fn(f)}catch(T){return u.pure&&(u.state=ne,u.owned&&u.owned.forEach(Le),u.owned=null),u.updatedAt=b+1,et(T)}(!u.updatedAt||u.updatedAt<=b)&&(u.updatedAt!=null&&"observers"in u?Ye(u,k):u.value=k,u.updatedAt=b)}function Je(u,f,b,k=ne,T){const H={fn:u,state:k,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:f,owner:ee,context:null,pure:b};return ee===null||ee!==Xe&&(ee.owned?ee.owned.push(H):ee.owned=[H]),H}function pe(u){if(u.state===0)return;if(u.state===ve)return ge(u);if(u.suspense&&ue(u.suspense.inFallback))return u.suspense.effects.push(u);const f=[u];for(;(u=u.owner)&&(!u.updatedAt||u.updatedAt<we);)u.state&&f.push(u);for(let b=f.length-1;b>=0;b--)if(u=f[b],u.state===ne)Ee(u);else if(u.state===ve){const k=ie;ie=null,_e(()=>ge(u,f[0]),!1),ie=k}}function _e(u,f){if(ie)return u();let b=!1;f||(ie=[]),re?b=!0:re=[],we++;try{const k=u();return Pt(b),k}catch(k){b||(re=null),ie=null,et(k)}}function Pt(u){if(ie&&(Ze(ie),ie=null),u)return;const f=re;re=null,f.length&&_e(()=>Ge(f),!1)}function Ze(u){for(let f=0;f<u.length;f++)pe(u[f])}function Ot(u){let f,b=0;for(f=0;f<u.length;f++){const k=u[f];k.user?u[b++]=k:pe(k)}for(f=0;f<b;f++)pe(u[f])}function ge(u,f){u.state=0;for(let b=0;b<u.sources.length;b+=1){const k=u.sources[b];if(k.sources){const T=k.state;T===ne?k!==f&&(!k.updatedAt||k.updatedAt<we)&&pe(k):T===ve&&ge(k,f)}}}function Qe(u){for(let f=0;f<u.observers.length;f+=1){const b=u.observers[f];b.state||(b.state=ve,b.pure?ie.push(b):re.push(b),b.observers&&Qe(b))}}function Le(u){let f;if(u.sources)for(;u.sources.length;){const b=u.sources.pop(),k=u.sourceSlots.pop(),T=b.observers;if(T&&T.length){const H=T.pop(),B=b.observerSlots.pop();k<T.length&&(H.sourceSlots[B]=k,T[k]=H,b.observerSlots[k]=B)}}if(u.owned){for(f=u.owned.length-1;f>=0;f--)Le(u.owned[f]);u.owned=null}if(u.cleanups){for(f=u.cleanups.length-1;f>=0;f--)u.cleanups[f]();u.cleanups=null}u.state=0,u.context=null}function It(u){return u instanceof Error?u:new Error(typeof u=="string"?u:"Unknown error",{cause:u})}function et(u,f=ee){throw It(u)}let Ht=!1;function ke(u,f){return ue(()=>u(f||{}))}function Ft(u,f,b){let k=b.length,T=f.length,H=k,B=0,t=0,n=f[T-1].nextSibling,l=null;for(;B<T||t<H;){if(f[B]===b[t]){B++,t++;continue}for(;f[T-1]===b[H-1];)T--,H--;if(T===B){const v=H<k?t?b[t-1].nextSibling:b[H-t]:n;for(;t<H;)u.insertBefore(b[t++],v)}else if(H===t)for(;B<T;)(!l||!l.has(f[B]))&&f[B].remove(),B++;else if(f[B]===b[H-1]&&b[t]===f[T-1]){const v=f[--T].nextSibling;u.insertBefore(b[t++],f[B++].nextSibling),u.insertBefore(b[--H],v),f[T]=b[H]}else{if(!l){l=new Map;let h=t;for(;h<H;)l.set(b[h],h++)}const v=l.get(f[B]);if(v!=null)if(t<v&&v<H){let h=B,_=1,m;for(;++h<T&&h<H&&!((m=l.get(f[h]))==null||m!==v+_);)_++;if(_>v-t){const p=f[B];for(;t<v;)u.insertBefore(b[t++],p)}else u.replaceChild(b[t++],f[B++])}else B++;else f[B++].remove()}}}const Ne="_$DX_DELEGATE";function Wt(u,f,b,k={}){let T;return Rt(H=>{T=H,f===document?u():le(f,u(),f.firstChild?null:void 0,b)},k.owner),()=>{T(),f.textContent=""}}function De(u,f,b){let k;const T=()=>{const B=document.createElement("template");return B.innerHTML=u,b?B.content.firstChild.firstChild:B.content.firstChild},H=f?()=>ue(()=>document.importNode(k||(k=T()),!0)):()=>(k||(k=T())).cloneNode(!0);return H.cloneNode=H,H}function $t(u,f=window.document){const b=f[Ne]||(f[Ne]=new Set);for(let k=0,T=u.length;k<T;k++){const H=u[k];b.has(H)||(b.add(H),f.addEventListener(H,Nt))}}function ze(u,f,b){b==null?u.removeAttribute(f):u.setAttribute(f,b)}function je(u,f){f==null?u.removeAttribute("class"):u.className=f}function Ut(u,f,b){return ue(()=>u(f,b))}function le(u,f,b,k){if(b!==void 0&&!k&&(k=[]),typeof f!="function")return me(u,f,k,b);de(T=>me(u,f(),T,b),k)}function Nt(u){const f=`$$${u.type}`;let b=u.composedPath&&u.composedPath()[0]||u.target;for(u.target!==b&&Object.defineProperty(u,"target",{configurable:!0,value:b}),Object.defineProperty(u,"currentTarget",{configurable:!0,get(){return b||document}});b;){const k=b[f];if(k&&!b.disabled){const T=b[`${f}Data`];if(T!==void 0?k.call(b,T,u):k.call(b,u),u.cancelBubble)return}b=b._$host||b.parentNode||b.host}}function me(u,f,b,k,T){for(;typeof b=="function";)b=b();if(f===b)return b;const H=typeof f,B=k!==void 0;if(u=B&&b[0]&&b[0].parentNode||u,H==="string"||H==="number")if(H==="number"&&(f=f.toString()),B){let t=b[0];t&&t.nodeType===3?t.data=f:t=document.createTextNode(f),b=ae(u,b,k,t)}else b!==""&&typeof b=="string"?b=u.firstChild.data=f:b=u.textContent=f;else if(f==null||H==="boolean")b=ae(u,b,k);else{if(H==="function")return de(()=>{let t=f();for(;typeof t=="function";)t=t();b=me(u,t,b,k)}),()=>b;if(Array.isArray(f)){const t=[],n=b&&Array.isArray(b);if(Te(t,f,b,T))return de(()=>b=me(u,t,b,k,!0)),()=>b;if(t.length===0){if(b=ae(u,b,k),B)return b}else n?b.length===0?Ke(u,t,k):Ft(u,b,t):(b&&ae(u),Ke(u,t));b=t}else if(f.nodeType){if(Array.isArray(b)){if(B)return b=ae(u,b,k,f);ae(u,b,null,f)}else b==null||b===""||!u.firstChild?u.appendChild(f):u.replaceChild(f,u.firstChild);b=f}else console.warn("Unrecognized value. Skipped inserting",f)}return b}function Te(u,f,b,k){let T=!1;for(let H=0,B=f.length;H<B;H++){let t=f[H],n=b&&b[H],l;if(!(t==null||t===!0||t===!1))if((l=typeof t)=="object"&&t.nodeType)u.push(t);else if(Array.isArray(t))T=Te(u,t,n)||T;else if(l==="function")if(k){for(;typeof t=="function";)t=t();T=Te(u,Array.isArray(t)?t:[t],Array.isArray(n)?n:[n])||T}else u.push(t),T=!0;else{const v=String(t);n&&n.nodeType===3&&n.data===v?u.push(n):u.push(document.createTextNode(v))}}return T}function Ke(u,f,b=null){for(let k=0,T=f.length;k<T;k++)u.insertBefore(f[k],b)}function ae(u,f,b,k){if(b===void 0)return u.textContent="";const T=k||document.createTextNode("");if(f.length){let H=!1;for(let B=f.length-1;B>=0;B--){const t=f[B];if(T!==t){const n=t.parentNode===u;!H&&!B?n?u.replaceChild(T,t):u.insertBefore(T,b):n&&t.remove()}else H=!0}}else u.insertBefore(T,b);return[T]}var tt={exports:{}};(function(u,f){(function(b,k){u.exports=k()})(self,()=>(()=>{var b={4567:function(B,t,n){var l=this&&this.__decorate||function(i,o,d,g){var S,a=arguments.length,C=a<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,o,d,g);else for(var w=i.length-1;w>=0;w--)(S=i[w])&&(C=(a<3?S(C):a>3?S(o,d,C):S(o,d))||C);return a>3&&C&&Object.defineProperty(o,d,C),C},v=this&&this.__param||function(i,o){return function(d,g){o(d,g,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const h=n(9042),_=n(6114),m=n(9924),p=n(844),c=n(5596),e=n(4725),r=n(3656);let s=class extends p.Disposable{constructor(i,o){super(),this._terminal=i,this._renderService=o,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let d=0;d<this._terminal.rows;d++)this._rowElements[d]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[d]);if(this._topBoundaryFocusListener=d=>this._handleBoundaryFocus(d,0),this._bottomBoundaryFocusListener=d=>this._handleBoundaryFocus(d,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new m.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(d=>this._handleResize(d.rows))),this.register(this._terminal.onRender(d=>this._refreshRows(d.start,d.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(d=>this._handleChar(d))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(d=>this._handleTab(d))),this.register(this._terminal.onKey(d=>this._handleKey(d.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new c.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,r.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,p.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(i){for(let o=0;o<i;o++)this._handleChar(" ")}_handleChar(i){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==i&&(this._charsToAnnounce+=i):this._charsToAnnounce+=i,i===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)),_.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,_.isMac&&this._liveRegion.remove()}_handleKey(i){this._clearLiveRegion(),/\p{Control}/u.test(i)||this._charsToConsume.push(i)}_refreshRows(i,o){this._liveRegionDebouncer.refresh(i,o,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(i,o){const d=i.target,g=this._rowElements[o===0?1:this._rowElements.length-2];if(d.getAttribute("aria-posinset")===(o===0?"1":`${this._terminal.buffer.lines.length}`)||i.relatedTarget!==g)return;let S,a;if(o===0?(S=d,a=this._rowElements.pop(),this._rowContainer.removeChild(a)):(S=this._rowElements.shift(),a=d,this._rowContainer.removeChild(S)),S.removeEventListener("focus",this._topBoundaryFocusListener),a.removeEventListener("focus",this._bottomBoundaryFocusListener),o===0){const C=this._createAccessibilityTreeNode();this._rowElements.unshift(C),this._rowContainer.insertAdjacentElement("afterbegin",C)}else{const C=this._createAccessibilityTreeNode();this._rowElements.push(C),this._rowContainer.appendChild(C)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(o===0?-1:1),this._rowElements[o===0?1:this._rowElements.length-2].focus(),i.preventDefault(),i.stopImmediatePropagation()}_handleResize(i){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let o=this._rowContainer.children.length;o<this._terminal.rows;o++)this._rowElements[o]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[o]);for(;this._rowElements.length>i;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const i=document.createElement("div");return i.setAttribute("role","listitem"),i.tabIndex=-1,this._refreshRowDimensions(i),i}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let i=0;i<this._terminal.rows;i++)this._refreshRowDimensions(this._rowElements[i])}}_refreshRowDimensions(i){i.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s=l([v(1,e.IRenderService)],s),t.AccessibilityManager=s},3614:(B,t)=>{function n(_){return _.replace(/\r?\n/g,"\r")}function l(_,m){return m?"\x1B[200~"+_+"\x1B[201~":_}function v(_,m,p){_=l(_=n(_),p.decPrivateModes.bracketedPasteMode),p.triggerDataEvent(_,!0),m.value=""}function h(_,m,p){const c=p.getBoundingClientRect(),e=_.clientX-c.left-10,r=_.clientY-c.top-10;m.style.width="20px",m.style.height="20px",m.style.left=`${e}px`,m.style.top=`${r}px`,m.style.zIndex="1000",m.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=n,t.bracketTextForPaste=l,t.copyHandler=function(_,m){_.clipboardData&&_.clipboardData.setData("text/plain",m.selectionText),_.preventDefault()},t.handlePasteEvent=function(_,m,p){_.stopPropagation(),_.clipboardData&&v(_.clipboardData.getData("text/plain"),m,p)},t.paste=v,t.moveTextAreaUnderMouseCursor=h,t.rightClickHandler=function(_,m,p,c,e){h(_,m,p),e&&c.rightClickSelect(_),m.value=c.selectionText,m.select()}},7239:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const l=n(1505);t.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(v,h,_){this._css.set(v,h,_)}getCss(v,h){return this._css.get(v,h)}setColor(v,h,_){this._color.set(v,h,_)}getColor(v,h){return this._color.get(v,h)}clear(){this._color.clear(),this._css.clear()}}},3656:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(n,l,v,h){n.addEventListener(l,v,h);let _=!1;return{dispose:()=>{_||(_=!0,n.removeEventListener(l,v,h))}}}},6465:function(B,t,n){var l=this&&this.__decorate||function(e,r,s,i){var o,d=arguments.length,g=d<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,r,s,i);else for(var S=e.length-1;S>=0;S--)(o=e[S])&&(g=(d<3?o(g):d>3?o(r,s,g):o(r,s))||g);return d>3&&g&&Object.defineProperty(r,s,g),g},v=this&&this.__param||function(e,r){return function(s,i){r(s,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;const h=n(2585),_=n(8460),m=n(844),p=n(3656);let c=class extends m.Disposable{constructor(e){super(),this._bufferService=e,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new _.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new _.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,m.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,m.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(e){return this._linkProviders.push(e),{dispose:()=>{const r=this._linkProviders.indexOf(e);r!==-1&&this._linkProviders.splice(r,1)}}}attachToDom(e,r,s){this._element=e,this._mouseService=r,this._renderService=s,this.register((0,p.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,p.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){if(this._lastMouseEvent=e,!this._element||!this._mouseService)return;const r=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!r)return;this._isMouseOut=!1;const s=e.composedPath();for(let i=0;i<s.length;i++){const o=s[i];if(o.classList.contains("xterm"))break;if(o.classList.contains("xterm-hover"))return}this._lastBufferCell&&r.x===this._lastBufferCell.x&&r.y===this._lastBufferCell.y||(this._handleHover(r),this._lastBufferCell=r)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,r){var s,i;this._activeProviderReplies&&r||((s=this._activeProviderReplies)===null||s===void 0||s.forEach(d=>{d==null||d.forEach(g=>{g.link.dispose&&g.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let o=!1;for(const[d,g]of this._linkProviders.entries())r?!((i=this._activeProviderReplies)===null||i===void 0)&&i.get(d)&&(o=this._checkLinkProviderResult(d,e,o)):g.provideLinks(e.y,S=>{var a,C;if(this._isMouseOut)return;const w=S==null?void 0:S.map(D=>({link:D}));(a=this._activeProviderReplies)===null||a===void 0||a.set(d,w),o=this._checkLinkProviderResult(d,e,o),((C=this._activeProviderReplies)===null||C===void 0?void 0:C.size)===this._linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,r){const s=new Set;for(let i=0;i<r.size;i++){const o=r.get(i);if(o)for(let d=0;d<o.length;d++){const g=o[d],S=g.link.range.start.y<e?0:g.link.range.start.x,a=g.link.range.end.y>e?this._bufferService.cols:g.link.range.end.x;for(let C=S;C<=a;C++){if(s.has(C)){o.splice(d--,1);break}s.add(C)}}}}_checkLinkProviderResult(e,r,s){var i;if(!this._activeProviderReplies)return s;const o=this._activeProviderReplies.get(e);let d=!1;for(let g=0;g<e;g++)this._activeProviderReplies.has(g)&&!this._activeProviderReplies.get(g)||(d=!0);if(!d&&o){const g=o.find(S=>this._linkAtPosition(S.link,r));g&&(s=!0,this._handleNewLink(g))}if(this._activeProviderReplies.size===this._linkProviders.length&&!s)for(let g=0;g<this._activeProviderReplies.size;g++){const S=(i=this._activeProviderReplies.get(g))===null||i===void 0?void 0:i.find(a=>this._linkAtPosition(a.link,r));if(S){s=!0,this._handleNewLink(S);break}}return s}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._element||!this._mouseService||!this._currentLink)return;const r=this._positionFromMouseEvent(e,this._element,this._mouseService);r&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,r)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,r){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!r||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=r)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,m.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const r=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);r&&this._linkAtPosition(e.link,r)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0||e.link.decorations.underline,pointerCursor:e.link.decorations===void 0||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.pointerCursor},set:s=>{var i,o;!((i=this._currentLink)===null||i===void 0)&&i.state&&this._currentLink.state.decorations.pointerCursor!==s&&(this._currentLink.state.decorations.pointerCursor=s,this._currentLink.state.isHovered&&((o=this._element)===null||o===void 0||o.classList.toggle("xterm-cursor-pointer",s)))}},underline:{get:()=>{var s,i;return(i=(s=this._currentLink)===null||s===void 0?void 0:s.state)===null||i===void 0?void 0:i.decorations.underline},set:s=>{var i,o,d;!((i=this._currentLink)===null||i===void 0)&&i.state&&((d=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||d===void 0?void 0:d.decorations.underline)!==s&&(this._currentLink.state.decorations.underline=s,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,s))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(s=>{if(!this._currentLink)return;const i=s.start===0?0:s.start+1+this._bufferService.buffer.ydisp,o=this._bufferService.buffer.ydisp+1+s.end;if(this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=o&&(this._clearCurrentLink(i,o),this._lastMouseEvent&&this._element)){const d=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);d&&this._askForLink(d,!1)}})))}_linkHover(e,r,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),r.hover&&r.hover(s,r.text)}_fireUnderlineEvent(e,r){const s=e.range,i=this._bufferService.buffer.ydisp,o=this._createLinkUnderlineEvent(s.start.x-1,s.start.y-i-1,s.end.x,s.end.y-i-1,void 0);(r?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(o)}_linkLeave(e,r,s){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(r,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),r.leave&&r.leave(s,r.text)}_linkAtPosition(e,r){const s=e.range.start.y*this._bufferService.cols+e.range.start.x,i=e.range.end.y*this._bufferService.cols+e.range.end.x,o=r.y*this._bufferService.cols+r.x;return s<=o&&o<=i}_positionFromMouseEvent(e,r,s){const i=s.getCoords(e,r,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,r,s,i,o){return{x1:e,y1:r,x2:s,y2:i,cols:this._bufferService.cols,fg:o}}};c=l([v(0,h.IBufferService)],c),t.Linkifier2=c},9042:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(B,t,n){var l=this&&this.__decorate||function(c,e,r,s){var i,o=arguments.length,d=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,r,s);else for(var g=c.length-1;g>=0;g--)(i=c[g])&&(d=(o<3?i(d):o>3?i(e,r,d):i(e,r))||d);return o>3&&d&&Object.defineProperty(e,r,d),d},v=this&&this.__param||function(c,e){return function(r,s){e(r,s,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const h=n(511),_=n(2585);let m=class{constructor(c,e,r){this._bufferService=c,this._optionsService=e,this._oscLinkService=r}provideLinks(c,e){var r;const s=this._bufferService.buffer.lines.get(c-1);if(!s)return void e(void 0);const i=[],o=this._optionsService.rawOptions.linkHandler,d=new h.CellData,g=s.getTrimmedLength();let S=-1,a=-1,C=!1;for(let w=0;w<g;w++)if(a!==-1||s.hasContent(w)){if(s.loadCell(w,d),d.hasExtendedAttrs()&&d.extended.urlId){if(a===-1){a=w,S=d.extended.urlId;continue}C=d.extended.urlId!==S}else a!==-1&&(C=!0);if(C||a!==-1&&w===g-1){const D=(r=this._oscLinkService.getLinkData(S))===null||r===void 0?void 0:r.uri;if(D){const L={start:{x:a+1,y:c},end:{x:w+(C||w!==g-1?0:1),y:c}};let P=!1;if(!(o!=null&&o.allowNonHttpProtocols))try{const W=new URL(D);["http:","https:"].includes(W.protocol)||(P=!0)}catch{P=!0}P||i.push({text:D,range:L,activate:(W,j)=>o?o.activate(W,j,L):p(0,j),hover:(W,j)=>{var U;return(U=o==null?void 0:o.hover)===null||U===void 0?void 0:U.call(o,W,j,L)},leave:(W,j)=>{var U;return(U=o==null?void 0:o.leave)===null||U===void 0?void 0:U.call(o,W,j,L)}})}C=!1,d.hasExtendedAttrs()&&d.extended.urlId?(a=w,S=d.extended.urlId):(a=-1,S=-1)}}e(i)}};function p(c,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){const r=window.open();if(r){try{r.opener=null}catch{}r.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}m=l([v(0,_.IBufferService),v(1,_.IOptionsService),v(2,_.IOscLinkService)],m),t.OscLinkProvider=m},6193:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(n,l){this._parentWindow=n,this._renderCallback=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,l,v){this._rowCount=v,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},5596:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;const l=n(844);class v extends l.Disposable{constructor(_){super(),this._parentWindow=_,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,l.toDisposable)(()=>{this.clearListener()}))}setListener(_){this._listener&&this.clearListener(),this._listener=_,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)===null||_===void 0||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}t.ScreenDprMonitor=v},3236:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const l=n(2950),v=n(1680),h=n(3614),_=n(2584),m=n(5435),p=n(9312),c=n(6114),e=n(3656),r=n(9042),s=n(4567),i=n(1296),o=n(7399),d=n(8460),g=n(8437),S=n(3230),a=n(4725),C=n(428),w=n(8934),D=n(6465),L=n(5114),P=n(8969),W=n(8055),j=n(4269),U=n(5941),y=n(3107),E=n(5744),R=n(9074),M=n(2585),$=n(3730),q=n(844),G=n(6731),N=typeof window<"u"?window.document:null;class V extends P.CoreTerminal{constructor(A={}){super(A),this.browser=c,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new d.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new d.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new d.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new d.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new d.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new d.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new d.EventEmitter),this._onBlur=this.register(new d.EventEmitter),this._onA11yCharEmitter=this.register(new d.EventEmitter),this._onA11yTabEmitter=this.register(new d.EventEmitter),this._onWillOpen=this.register(new d.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(D.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance($.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(R.DecorationService),this._instantiationService.setService(M.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((O,F)=>this.refresh(O,F))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(O=>this._reportWindowsOptions(O))),this.register(this._inputHandler.onColor(O=>this._handleColorEvent(O))),this.register((0,d.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,d.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,d.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,d.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(O=>this._afterResize(O.cols,O.rows))),this.register((0,q.toDisposable)(()=>{var O,F;this._customKeyEventHandler=void 0,(F=(O=this.element)===null||O===void 0?void 0:O.parentNode)===null||F===void 0||F.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(A){if(this._themeService)for(const O of A){let F,z="";switch(O.index){case 256:F="foreground",z="10";break;case 257:F="background",z="11";break;case 258:F="cursor",z="12";break;default:F="ansi",z="4;"+O.index}switch(O.type){case 0:const Y=W.color.toColorRGB(F==="ansi"?this._themeService.colors.ansi[O.index]:this._themeService.colors[F]);this.coreService.triggerDataEvent(`${_.C0.ESC}]${z};${(0,U.toRgbString)(Y)}${_.C1_ESCAPED.ST}`);break;case 1:if(F==="ansi")this._themeService.modifyColors(K=>K.ansi[O.index]=W.rgba.toColor(...O.color));else{const K=F;this._themeService.modifyColors(Z=>Z[K]=W.rgba.toColor(...O.color))}break;case 2:this._themeService.restoreColor(O.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){var O;A?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)):((O=this._accessibilityManager)===null||O===void 0||O.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const A=this.buffer.ybase+this.buffer.y,O=this.buffer.lines.get(A);if(!O)return;const F=Math.min(this.buffer.x,this.cols-1),z=this._renderService.dimensions.css.cell.height,Y=O.getWidth(F),K=this._renderService.dimensions.css.cell.width*Y,Z=this.buffer.y*this._renderService.dimensions.css.cell.height,te=F*this._renderService.dimensions.css.cell.width;this.textarea.style.left=te+"px",this.textarea.style.top=Z+"px",this.textarea.style.width=K+"px",this.textarea.style.height=z+"px",this.textarea.style.lineHeight=z+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,e.addDisposableDomListener)(this.element,"copy",O=>{this.hasSelection()&&(0,h.copyHandler)(O,this._selectionService)}));const A=O=>(0,h.handlePasteEvent)(O,this.textarea,this.coreService);this.register((0,e.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,e.addDisposableDomListener)(this.element,"paste",A)),c.isFirefox?this.register((0,e.addDisposableDomListener)(this.element,"mousedown",O=>{O.button===2&&(0,h.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,e.addDisposableDomListener)(this.element,"contextmenu",O=>{(0,h.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),c.isLinux&&this.register((0,e.addDisposableDomListener)(this.element,"auxclick",O=>{O.button===1&&(0,h.moveTextAreaUnderMouseCursor)(O,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,e.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,e.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var O;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),A.appendChild(this.element);const F=N.createDocumentFragment();this._viewportElement=N.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),F.appendChild(this._viewportElement),this._viewportScrollArea=N.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=N.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=N.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),F.appendChild(this.screenElement),this.textarea=N.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",r.promptLabel),c.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(L.CoreBrowserService,this.textarea,(O=this._document.defaultView)!==null&&O!==void 0?O:window),this._instantiationService.setService(a.ICoreBrowserService,this._coreBrowserService),this.register((0,e.addDisposableDomListener)(this.textarea,"focus",z=>this._handleTextAreaFocus(z))),this.register((0,e.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(C.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(a.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(G.ThemeService),this._instantiationService.setService(a.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(j.CharacterJoinerService),this._instantiationService.setService(a.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(a.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(z=>this._onRender.fire(z))),this.onResize(z=>this._renderService.resize(z.cols,z.rows)),this._compositionView=N.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(l.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(F);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(w.MouseService),this._instantiationService.setService(a.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(v.Viewport,z=>this.scrollLines(z,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(p.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(a.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(z=>this.scrollLines(z.amount,z.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(z=>this._renderService.handleSelectionChanged(z.start,z.end,z.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(z=>{this.textarea.value=z,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(z=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,e.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(y.BufferDecorationRenderer,this.screenElement)),this.register((0,e.addDisposableDomListener)(this.element,"mousedown",z=>this._selectionService.handleMouseDown(z))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(s.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",z=>this._handleScreenReaderModeOptionChange(z))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(E.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",z=>{!this._overviewRulerRenderer&&z&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(E.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const A=this,O=this.element;function F(K){const Z=A._mouseService.getMouseReportCoords(K,A.screenElement);if(!Z)return!1;let te,Q;switch(K.overrideType||K.type){case"mousemove":Q=32,K.buttons===void 0?(te=3,K.button!==void 0&&(te=K.button<3?K.button:3)):te=1&K.buttons?0:4&K.buttons?1:2&K.buttons?2:3;break;case"mouseup":Q=0,te=K.button<3?K.button:3;break;case"mousedown":Q=1,te=K.button<3?K.button:3;break;case"wheel":if(A.viewport.getLinesScrolled(K)===0)return!1;Q=K.deltaY<0?0:1,te=4;break;default:return!1}return!(Q===void 0||te===void 0||te>4)&&A.coreMouseService.triggerMouseEvent({col:Z.col,row:Z.row,x:Z.x,y:Z.y,button:te,action:Q,ctrl:K.ctrlKey,alt:K.altKey,shift:K.shiftKey})}const z={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:K=>(F(K),K.buttons||(this._document.removeEventListener("mouseup",z.mouseup),z.mousedrag&&this._document.removeEventListener("mousemove",z.mousedrag)),this.cancel(K)),wheel:K=>(F(K),this.cancel(K,!0)),mousedrag:K=>{K.buttons&&F(K)},mousemove:K=>{K.buttons||F(K)}};this.register(this.coreMouseService.onProtocolChange(K=>{K?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(K)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&K?z.mousemove||(O.addEventListener("mousemove",Y.mousemove),z.mousemove=Y.mousemove):(O.removeEventListener("mousemove",z.mousemove),z.mousemove=null),16&K?z.wheel||(O.addEventListener("wheel",Y.wheel,{passive:!1}),z.wheel=Y.wheel):(O.removeEventListener("wheel",z.wheel),z.wheel=null),2&K?z.mouseup||(z.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",z.mouseup),z.mouseup=null),4&K?z.mousedrag||(z.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",z.mousedrag),z.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,e.addDisposableDomListener)(O,"mousedown",K=>{if(K.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(K))return F(K),z.mouseup&&this._document.addEventListener("mouseup",z.mouseup),z.mousedrag&&this._document.addEventListener("mousemove",z.mousedrag),this.cancel(K)})),this.register((0,e.addDisposableDomListener)(O,"wheel",K=>{if(!z.wheel){if(!this.buffer.hasScrollback){const Z=this.viewport.getLinesScrolled(K);if(Z===0)return;const te=_.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(K.deltaY<0?"A":"B");let Q="";for(let X=0;X<Math.abs(Z);X++)Q+=te;return this.coreService.triggerDataEvent(Q,!0),this.cancel(K,!0)}return this.viewport.handleWheel(K)?this.cancel(K):void 0}},{passive:!1})),this.register((0,e.addDisposableDomListener)(O,"touchstart",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(K),this.cancel(K)},{passive:!0})),this.register((0,e.addDisposableDomListener)(O,"touchmove",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(K)?void 0:this.cancel(K)},{passive:!1}))}refresh(A,O){var F;(F=this._renderService)===null||F===void 0||F.refreshRows(A,O)}updateCursorStyle(A){var O;!((O=this._selectionService)===null||O===void 0)&&O.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,O,F=0){super.scrollLines(A,O,F),this.refresh(0,this.rows-1)}paste(A){(0,h.paste)(A,this.textarea,this.coreService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const O=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),O}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,O,F){this._selectionService.setSelection(A,O,F)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,O){var F;(F=this._selectionService)===null||F===void 0||F.selectLines(A,O)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;const O=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!O&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;O||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const F=(0,o.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),F.type===3||F.type===2){const z=this.rows-1;return this.scrollLines(F.type===2?-z:z),this.cancel(A,!0)}return F.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(F.cancel&&this.cancel(A,!0),!F.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(F.key!==_.C0.ETX&&F.key!==_.C0.CR||(this.textarea.value=""),this._onKey.fire({key:F.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(F.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,O){const F=A.isMac&&!this.options.macOptionIsMeta&&O.altKey&&!O.ctrlKey&&!O.metaKey||A.isWindows&&O.altKey&&O.ctrlKey&&!O.metaKey||A.isWindows&&O.getModifierState("AltGraph");return O.type==="keypress"?F:F&&(!O.keyCode||O.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function(O){return O.keyCode===16||O.keyCode===17||O.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let O;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)O=A.charCode;else if(A.which===null||A.which===void 0)O=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;O=A.which}return!(!O||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||(O=String.fromCharCode(O),this._onKey.fire({key:O,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(O,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const O=A.data;return this.coreService.triggerDataEvent(O,!0),this.cancel(A),!0}return!1}resize(A,O){A!==this.cols||O!==this.rows?super.resize(A,O):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,O){var F,z;(F=this._charSizeService)===null||F===void 0||F.measure(),(z=this.viewport)===null||z===void 0||z.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(g.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var A,O;this.options.rows=this.rows,this.options.cols=this.cols;const F=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1),(O=this.viewport)===null||O===void 0||O.syncScrollArea()}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(_.C0.ESC+"[I"):this.coreService.triggerDataEvent(_.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case m.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const O=this._renderService.dimensions.css.canvas.width.toFixed(0),F=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${_.C0.ESC}[4;${F};${O}t`);break;case m.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const z=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${_.C0.ESC}[6;${Y};${z}t`)}}cancel(A,O){if(this.options.cancelEvents||O)return A.preventDefault(),A.stopPropagation(),!1}}t.Terminal=V},9924:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(n,l=1e3){this._renderCallback=n,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,l,v){this._rowCount=v,n=n!==void 0?n:0,l=l!==void 0?l:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,l):l;const h=Date.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){const _=h-this._lastRefreshMs,m=this._debounceThresholdMS-_;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,l)}}},1680:function(B,t,n){var l=this&&this.__decorate||function(e,r,s,i){var o,d=arguments.length,g=d<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,r,s,i);else for(var S=e.length-1;S>=0;S--)(o=e[S])&&(g=(d<3?o(g):d>3?o(r,s,g):o(r,s))||g);return d>3&&g&&Object.defineProperty(r,s,g),g},v=this&&this.__param||function(e,r){return function(s,i){r(s,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const h=n(844),_=n(3656),m=n(4725),p=n(2585);let c=class extends h.Disposable{constructor(e,r,s,i,o,d,g,S,a){super(),this._scrollLines=e,this._viewportElement=r,this._scrollArea=s,this._bufferService=i,this._optionsService=o,this._charSizeService=d,this._renderService=g,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(a.colors),this.register(a.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}_refresh(e){if(e)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const r=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==r&&(this._lastRecordedBufferHeight=r,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const r=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(r)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,r){const s=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(r<0&&this._viewportElement.scrollTop!==0||r>0&&s<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const r=this._getPixelsScrolled(e);return r!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+r:this._smoothScrollState.target+=r,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=r,this._bubbleScroll(e,r))}_getPixelsScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let r=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._bufferService.rows),r}getBufferElements(e,r){var s;let i,o="";const d=[],g=r!=null?r:this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let a=e;a<g;a++){const C=S.get(a);if(!C)continue;const w=(s=S.get(a+1))===null||s===void 0?void 0:s.isWrapped;if(o+=C.translateToString(!w),!w||a===S.length-1){const D=document.createElement("div");D.textContent=o,d.push(D),o.length>0&&(i=D),o=""}}return{bufferElements:d,cursorElement:i}}getLinesScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let r=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._bufferService.rows),r}_applyScrollModifier(e,r){const s=this._optionsService.rawOptions.fastScrollModifier;return s==="alt"&&r.altKey||s==="ctrl"&&r.ctrlKey||s==="shift"&&r.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const r=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,this._bubbleScroll(e,r))}};c=l([v(3,p.IBufferService),v(4,p.IOptionsService),v(5,m.ICharSizeService),v(6,m.IRenderService),v(7,m.ICoreBrowserService),v(8,m.IThemeService)],c),t.Viewport=c},3107:function(B,t,n){var l=this&&this.__decorate||function(e,r,s,i){var o,d=arguments.length,g=d<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,r,s,i);else for(var S=e.length-1;S>=0;S--)(o=e[S])&&(g=(d<3?o(g):d>3?o(r,s,g):o(r,s))||g);return d>3&&g&&Object.defineProperty(r,s,g),g},v=this&&this.__param||function(e,r){return function(s,i){r(s,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const h=n(3656),_=n(4725),m=n(844),p=n(2585);let c=class extends m.Disposable{constructor(e,r,s,i){super(),this._screenElement=e,this._bufferService=r,this._decorationService=s,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,h.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(o=>this._removeDecoration(o))),this.register((0,m.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){var r,s;const i=document.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer",((r=e==null?void 0:e.options)===null||r===void 0?void 0:r.layer)==="top"),i.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",i.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const o=(s=e.options.x)!==null&&s!==void 0?s:0;return o&&o>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(e,i),i}_refreshStyle(e){const r=e.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let s=this._decorationElements.get(e);s||(s=this._createElement(e),e.element=s,this._decorationElements.set(e,s),this._container.appendChild(s)),s.style.top=r*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(s)}}_refreshXPosition(e,r=e.element){var s;if(!r)return;const i=(s=e.options.x)!==null&&s!==void 0?s:0;(e.options.anchor||"left")==="right"?r.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":r.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){var r;(r=this._decorationElements.get(e))===null||r===void 0||r.remove(),this._decorationElements.delete(e),e.dispose()}};c=l([v(1,p.IBufferService),v(2,p.IDecorationService),v(3,_.IRenderService)],c),t.BufferDecorationRenderer=c},5871:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const l of this._zones)if(l.color===n.options.overviewRulerOptions.color&&l.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,n.marker.line))return;if(this._lineAdjacentToZone(l,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(l,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,l){return l>=n.startBufferLine&&l<=n.endBufferLine}_lineAdjacentToZone(n,l,v){return l>=n.startBufferLine-this._linePadding[v||"full"]&&l<=n.endBufferLine+this._linePadding[v||"full"]}_addLineToZone(n,l){n.startBufferLine=Math.min(n.startBufferLine,l),n.endBufferLine=Math.max(n.endBufferLine,l)}}},5744:function(B,t,n){var l=this&&this.__decorate||function(o,d,g,S){var a,C=arguments.length,w=C<3?d:S===null?S=Object.getOwnPropertyDescriptor(d,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,d,g,S);else for(var D=o.length-1;D>=0;D--)(a=o[D])&&(w=(C<3?a(w):C>3?a(d,g,w):a(d,g))||w);return C>3&&w&&Object.defineProperty(d,g,w),w},v=this&&this.__param||function(o,d){return function(g,S){d(g,S,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const h=n(5871),_=n(3656),m=n(4725),p=n(844),c=n(2585),e={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let i=class extends p.Disposable{constructor(o,d,g,S,a,C,w){var D;super(),this._viewportElement=o,this._screenElement=d,this._bufferService=g,this._decorationService=S,this._renderService=a,this._optionsService=C,this._coreBrowseService=w,this._colorZoneStore=new h.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(D=this._viewportElement.parentElement)===null||D===void 0||D.insertBefore(this._canvas,this._viewportElement);const L=this._canvas.getContext("2d");if(!L)throw new Error("Ctx cannot be null");this._ctx=L,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,p.toDisposable)(()=>{var P;(P=this._canvas)===null||P===void 0||P.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,_.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const o=Math.floor(this._canvas.width/3),d=Math.ceil(this._canvas.width/3);r.full=this._canvas.width,r.left=o,r.center=d,r.right=o,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=r.left,s.right=r.left+r.center}_refreshDrawHeightConstants(){e.full=Math.round(2*this._coreBrowseService.dpr);const o=this._canvas.height/this._bufferService.buffer.lines.length,d=Math.round(Math.max(Math.min(o,12),6)*this._coreBrowseService.dpr);e.left=d,e.center=d,e.right=d}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const d of this._decorationService.decorations)this._colorZoneStore.addDecoration(d);this._ctx.lineWidth=1;const o=this._colorZoneStore.zones;for(const d of o)d.position!=="full"&&this._renderColorZone(d);for(const d of o)d.position==="full"&&this._renderColorZone(d);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(o){this._ctx.fillStyle=o.color,this._ctx.fillRect(s[o.position||"full"],Math.round((this._canvas.height-1)*(o.startBufferLine/this._bufferService.buffers.active.lines.length)-e[o.position||"full"]/2),r[o.position||"full"],Math.round((this._canvas.height-1)*((o.endBufferLine-o.startBufferLine)/this._bufferService.buffers.active.lines.length)+e[o.position||"full"]))}_queueRefresh(o,d){this._shouldUpdateDimensions=o||this._shouldUpdateDimensions,this._shouldUpdateAnchor=d||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i=l([v(2,c.IBufferService),v(3,c.IDecorationService),v(4,m.IRenderService),v(5,c.IOptionsService),v(6,m.ICoreBrowserService)],i),t.OverviewRulerRenderer=i},2950:function(B,t,n){var l=this&&this.__decorate||function(c,e,r,s){var i,o=arguments.length,d=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,r,s);else for(var g=c.length-1;g>=0;g--)(i=c[g])&&(d=(o<3?i(d):o>3?i(e,r,d):i(e,r))||d);return o>3&&d&&Object.defineProperty(e,r,d),d},v=this&&this.__param||function(c,e){return function(r,s){e(r,s,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const h=n(4725),_=n(2585),m=n(2584);let p=class{constructor(c,e,r,s,i,o){this._textarea=c,this._compositionView=e,this._bufferService=r,this._optionsService=s,this._coreService=i,this._renderService=o,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(c){this._compositionView.textContent=c.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(c){if(this._isComposing||this._isSendingComposition){if(c.keyCode===229||c.keyCode===16||c.keyCode===17||c.keyCode===18)return!1;this._finalizeComposition(!1)}return c.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(c){if(this._compositionView.classList.remove("active"),this._isComposing=!1,c){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let r;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,r=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),r.length>0&&this._coreService.triggerDataEvent(r,!0)}},0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const c=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const e=this._textarea.value,r=e.replace(c,"");this._dataAlreadySent=r,e.length>c.length?this._coreService.triggerDataEvent(r,!0):e.length<c.length?this._coreService.triggerDataEvent(`${m.C0.DEL}`,!0):e.length===c.length&&e!==c&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(c){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.css.cell.height,s=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,i=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const o=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(o.width,1)+"px",this._textarea.style.height=Math.max(o.height,1)+"px",this._textarea.style.lineHeight=o.height+"px"}c||setTimeout(()=>this.updateCompositionElements(!0),0)}}};p=l([v(2,_.IBufferService),v(3,_.IOptionsService),v(4,_.ICoreService),v(5,h.IRenderService)],p),t.CompositionHelper=p},9806:(B,t)=>{function n(l,v,h){const _=h.getBoundingClientRect(),m=l.getComputedStyle(h),p=parseInt(m.getPropertyValue("padding-left")),c=parseInt(m.getPropertyValue("padding-top"));return[v.clientX-_.left-p,v.clientY-_.top-c]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=n,t.getCoords=function(l,v,h,_,m,p,c,e,r){if(!p)return;const s=n(l,v,h);return s?(s[0]=Math.ceil((s[0]+(r?c/2:0))/c),s[1]=Math.ceil(s[1]/e),s[0]=Math.min(Math.max(s[0],1),_+(r?1:0)),s[1]=Math.min(Math.max(s[1],1),m),s):void 0}},9504:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const l=n(2584);function v(e,r,s,i){const o=e-h(e,s),d=r-h(r,s),g=Math.abs(o-d)-function(S,a,C){let w=0;const D=S-h(S,C),L=a-h(a,C);for(let P=0;P<Math.abs(D-L);P++){const W=_(S,a)==="A"?-1:1,j=C.buffer.lines.get(D+W*P);j!=null&&j.isWrapped&&w++}return w}(e,r,s);return c(g,p(_(e,r),i))}function h(e,r){let s=0,i=r.buffer.lines.get(e),o=i==null?void 0:i.isWrapped;for(;o&&e>=0&&e<r.rows;)s++,i=r.buffer.lines.get(--e),o=i==null?void 0:i.isWrapped;return s}function _(e,r){return e>r?"A":"B"}function m(e,r,s,i,o,d){let g=e,S=r,a="";for(;g!==s||S!==i;)g+=o?1:-1,o&&g>d.cols-1?(a+=d.buffer.translateBufferLineToString(S,!1,e,g),g=0,e=0,S++):!o&&g<0&&(a+=d.buffer.translateBufferLineToString(S,!1,0,e+1),g=d.cols-1,e=g,S--);return a+d.buffer.translateBufferLineToString(S,!1,e,g)}function p(e,r){const s=r?"O":"[";return l.C0.ESC+s+e}function c(e,r){e=Math.floor(e);let s="";for(let i=0;i<e;i++)s+=r;return s}t.moveToCellSequence=function(e,r,s,i){const o=s.buffer.x,d=s.buffer.y;if(!s.buffer.hasScrollback)return function(a,C,w,D,L,P){return v(C,D,L,P).length===0?"":c(m(a,C,a,C-h(C,L),!1,L).length,p("D",P))}(o,d,0,r,s,i)+v(d,r,s,i)+function(a,C,w,D,L,P){let W;W=v(C,D,L,P).length>0?D-h(D,L):C;const j=D,U=function(y,E,R,M,$,q){let G;return G=v(R,M,$,q).length>0?M-h(M,$):E,y<R&&G<=M||y>=R&&G<M?"C":"D"}(a,C,w,D,L,P);return c(m(a,W,w,j,U==="C",L).length,p(U,P))}(o,d,e,r,s,i);let g;if(d===r)return g=o>e?"D":"C",c(Math.abs(o-e),p(g,i));g=d>r?"D":"C";const S=Math.abs(d-r);return c(function(a,C){return C.cols-a}(d>r?e:o,s)+(S-1)*s.cols+1+((d>r?o:e)-1),p(g,i))}},1296:function(B,t,n){var l=this&&this.__decorate||function(S,a,C,w){var D,L=arguments.length,P=L<3?a:w===null?w=Object.getOwnPropertyDescriptor(a,C):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(S,a,C,w);else for(var W=S.length-1;W>=0;W--)(D=S[W])&&(P=(L<3?D(P):L>3?D(a,C,P):D(a,C))||P);return L>3&&P&&Object.defineProperty(a,C,P),P},v=this&&this.__param||function(S,a){return function(C,w){a(C,w,S)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const h=n(3787),_=n(2223),m=n(6171),p=n(4725),c=n(8055),e=n(8460),r=n(844),s=n(2585),i="xterm-dom-renderer-owner-",o="xterm-focus";let d=1,g=class extends r.Disposable{constructor(S,a,C,w,D,L,P,W,j,U){super(),this._element=S,this._screenElement=a,this._viewportElement=C,this._linkifier2=w,this._charSizeService=L,this._optionsService=P,this._bufferService=W,this._coreBrowserService=j,this._themeService=U,this._terminalClass=d++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new e.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,m.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(y=>this._injectCss(y))),this._injectCss(this._themeService.colors),this._rowFactory=D.createInstance(h.DomRendererRowFactory,document),this._element.classList.add(i+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(y=>this._handleLinkHover(y))),this.register(this._linkifier2.onHideLinkUnderline(y=>this._handleLinkLeave(y))),this.register((0,r.toDisposable)(()=>{this._element.classList.remove(i+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const S=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*S,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*S),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/S),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/S),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const C of this._rowElements)C.style.width=`${this.dimensions.css.canvas.width}px`,C.style.height=`${this.dimensions.css.cell.height}px`,C.style.lineHeight=`${this.dimensions.css.cell.height}px`,C.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const a=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=a,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(S){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let a=`${this._terminalSelector} .xterm-rows { color: ${S.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;a+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${c.color.multiplyOpacity(S.foreground,.5).css};}`,a+=`${this._terminalSelector} span:not(.${h.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${h.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${h.ITALIC_CLASS} { font-style: italic;}`,a+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",a+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${S.cursor.css};  color: ${S.cursorAccent.css}; } 50% {  background-color: ${S.cursorAccent.css};  color: ${S.cursor.css}; }}`,a+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${S.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${h.CURSOR_CLASS}.${h.CURSOR_BLINK_CLASS}:not(.${h.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${h.CURSOR_CLASS}.${h.CURSOR_BLINK_CLASS}.${h.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${S.cursor.css}; color: ${S.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${S.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${h.CURSOR_CLASS}.${h.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${S.cursor.css} inset;}`,a+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${S.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${S.selectionInactiveBackgroundOpaque.css};}`;for(const[C,w]of S.ansi.entries())a+=`${this._terminalSelector} .xterm-fg-${C} { color: ${w.css}; }${this._terminalSelector} .xterm-fg-${C}.${h.DIM_CLASS} { color: ${c.color.multiplyOpacity(w,.5).css}; }${this._terminalSelector} .xterm-bg-${C} { background-color: ${w.css}; }`;a+=`${this._terminalSelector} .xterm-fg-${_.INVERTED_DEFAULT_COLOR} { color: ${c.color.opaque(S.background).css}; }${this._terminalSelector} .xterm-fg-${_.INVERTED_DEFAULT_COLOR}.${h.DIM_CLASS} { color: ${c.color.multiplyOpacity(c.color.opaque(S.background),.5).css}; }${this._terminalSelector} .xterm-bg-${_.INVERTED_DEFAULT_COLOR} { background-color: ${S.foreground.css}; }`,this._themeStyleElement.textContent=a}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(S,a){for(let C=this._rowElements.length;C<=a;C++){const w=document.createElement("div");this._rowContainer.appendChild(w),this._rowElements.push(w)}for(;this._rowElements.length>a;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(S,a){this._refreshRowElements(S,a),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(o)}handleFocus(){this._rowContainer.classList.add(o)}handleSelectionChanged(S,a,C){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(S,a,C),this.renderRows(0,this._bufferService.rows-1),!S||!a)return;const w=S[1]-this._bufferService.buffer.ydisp,D=a[1]-this._bufferService.buffer.ydisp,L=Math.max(w,0),P=Math.min(D,this._bufferService.rows-1);if(L>=this._bufferService.rows||P<0)return;const W=document.createDocumentFragment();if(C){const j=S[0]>a[0];W.appendChild(this._createSelectionElement(L,j?a[0]:S[0],j?S[0]:a[0],P-L+1))}else{const j=w===L?S[0]:0,U=L===D?a[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(L,j,U));const y=P-L-1;if(W.appendChild(this._createSelectionElement(L+1,0,this._bufferService.cols,y)),L!==P){const E=D===P?a[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(P,0,E))}}this._selectionContainer.appendChild(W)}_createSelectionElement(S,a,C,w=1){const D=document.createElement("div");return D.style.height=w*this.dimensions.css.cell.height+"px",D.style.top=S*this.dimensions.css.cell.height+"px",D.style.left=a*this.dimensions.css.cell.width+"px",D.style.width=this.dimensions.css.cell.width*(C-a)+"px",D}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const S of this._rowElements)S.replaceChildren()}renderRows(S,a){const C=this._bufferService.buffer.ybase+this._bufferService.buffer.y,w=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),D=this._optionsService.rawOptions.cursorBlink;for(let L=S;L<=a;L++){const P=this._rowElements[L],W=L+this._bufferService.buffer.ydisp,j=this._bufferService.buffer.lines.get(W),U=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[L]&&this._cellToRowElements[L].length===this._bufferService.cols||(this._cellToRowElements[L]=new Int16Array(this._bufferService.cols)),P.replaceChildren(this._rowFactory.createRow(j,W,W===C,U,w,D,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[L]))}}get _terminalSelector(){return`.${i}${this._terminalClass}`}_handleLinkHover(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!0)}_handleLinkLeave(S){this._setCellUnderline(S.x1,S.x2,S.y1,S.y2,S.cols,!1)}_setCellUnderline(S,a,C,w,D,L){C<0&&(S=0),w<0&&(a=0);const P=this._cellToRowElements.length-1;C=Math.max(Math.min(C,P),0),w=Math.max(Math.min(w,P),0);const W=this._cellToRowElements[C],j=this._cellToRowElements[w];if(!(S>=W.length||a>=j.length)&&(S=W[S],a=j[a],S!==-1&&a!==-1))for(;S!==a||C!==w;){const U=this._rowElements[C];if(!U)return;const y=U.children[S];y&&(y.style.textDecoration=L?"underline":"none"),++S>=D&&(S=0,C++)}}};g=l([v(4,s.IInstantiationService),v(5,p.ICharSizeService),v(6,s.IOptionsService),v(7,s.IBufferService),v(8,p.ICoreBrowserService),v(9,p.IThemeService)],g),t.DomRenderer=g},3787:function(B,t,n){var l=this&&this.__decorate||function(g,S,a,C){var w,D=arguments.length,L=D<3?S:C===null?C=Object.getOwnPropertyDescriptor(S,a):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(g,S,a,C);else for(var P=g.length-1;P>=0;P--)(w=g[P])&&(L=(D<3?w(L):D>3?w(S,a,L):w(S,a))||L);return D>3&&L&&Object.defineProperty(S,a,L),L},v=this&&this.__param||function(g,S){return function(a,C){S(a,C,g)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.OVERLINE_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;const h=n(2223),_=n(643),m=n(511),p=n(2585),c=n(8055),e=n(4725),r=n(4269),s=n(6171),i=n(3734);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.OVERLINE_CLASS="xterm-overline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let o=class{constructor(g,S,a,C,w,D,L){this._document=g,this._characterJoinerService=S,this._optionsService=a,this._coreBrowserService=C,this._coreService=w,this._decorationService=D,this._themeService=L,this._workCell=new m.CellData,this._columnSelectMode=!1}handleSelectionChanged(g,S,a){this._selectionStart=g,this._selectionEnd=S,this._columnSelectMode=a}createRow(g,S,a,C,w,D,L,P,W){const j=this._document.createDocumentFragment(),U=this._characterJoinerService.getJoinedCharacters(S);let y=0;for(let $=Math.min(g.length,P)-1;$>=0;$--)if(g.loadCell($,this._workCell).getCode()!==_.NULL_CELL_CODE||a&&$===w){y=$+1;break}const E=this._themeService.colors;let R=-1,M=0;for(;M<y;M++){g.loadCell(M,this._workCell);let $=this._workCell.getWidth();if($===0){W[M]=R;continue}let q=!1,G=M,N=this._workCell;if(U.length>0&&M===U[0][0]){q=!0;const X=U.shift();N=new r.JoinedCellData(this._workCell,g.translateToString(!0,X[0],X[1]),X[1]-X[0]),G=X[1]-1,$=N.getWidth()}const V=this._document.createElement("span");if($>1&&(V.style.width=L*$+"px"),q&&(V.style.display="inline",w>=M&&w<=G&&(w=M)),!this._coreService.isCursorHidden&&a&&M===w)switch(V.classList.add(t.CURSOR_CLASS),D&&V.classList.add(t.CURSOR_BLINK_CLASS),C){case"bar":V.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":V.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:V.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}if(N.isBold()&&V.classList.add(t.BOLD_CLASS),N.isItalic()&&V.classList.add(t.ITALIC_CLASS),N.isDim()&&V.classList.add(t.DIM_CLASS),N.isInvisible()?V.textContent=_.WHITESPACE_CELL_CHAR:V.textContent=N.getChars()||_.WHITESPACE_CELL_CHAR,N.isUnderline()&&(V.classList.add(`${t.UNDERLINE_CLASS}-${N.extended.underlineStyle}`),V.textContent===" "&&(V.textContent=""),!N.isUnderlineColorDefault()))if(N.isUnderlineColorRGB())V.style.textDecorationColor=`rgb(${i.AttributeData.toColorRGB(N.getUnderlineColor()).join(",")})`;else{let X=N.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&N.isBold()&&X<8&&(X+=8),V.style.textDecorationColor=E.ansi[X].css}N.isOverline()&&(V.classList.add(t.OVERLINE_CLASS),V.textContent===" "&&(V.textContent="")),N.isStrikethrough()&&V.classList.add(t.STRIKETHROUGH_CLASS);let x=N.getFgColor(),A=N.getFgColorMode(),O=N.getBgColor(),F=N.getBgColorMode();const z=!!N.isInverse();if(z){const X=x;x=O,O=X;const Dt=A;A=F,F=Dt}let Y,K,Z=!1;this._decorationService.forEachDecorationAtCell(M,S,void 0,X=>{X.options.layer!=="top"&&Z||(X.backgroundColorRGB&&(F=50331648,O=X.backgroundColorRGB.rgba>>8&16777215,Y=X.backgroundColorRGB),X.foregroundColorRGB&&(A=50331648,x=X.foregroundColorRGB.rgba>>8&16777215,K=X.foregroundColorRGB),Z=X.options.layer==="top")});const te=this._isCellInSelection(M,S);let Q;switch(Z||E.selectionForeground&&te&&(A=50331648,x=E.selectionForeground.rgba>>8&16777215,K=E.selectionForeground),te&&(Y=this._coreBrowserService.isFocused?E.selectionBackgroundOpaque:E.selectionInactiveBackgroundOpaque,Z=!0),Z&&V.classList.add("xterm-decoration-top"),F){case 16777216:case 33554432:Q=E.ansi[O],V.classList.add(`xterm-bg-${O}`);break;case 50331648:Q=c.rgba.toColor(O>>16,O>>8&255,255&O),this._addStyle(V,`background-color:#${d((O>>>0).toString(16),"0",6)}`);break;default:z?(Q=E.foreground,V.classList.add(`xterm-bg-${h.INVERTED_DEFAULT_COLOR}`)):Q=E.background}switch(Y||N.isDim()&&(Y=c.color.multiplyOpacity(Q,.5)),A){case 16777216:case 33554432:N.isBold()&&x<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(x+=8),this._applyMinimumContrast(V,Q,E.ansi[x],N,Y,void 0)||V.classList.add(`xterm-fg-${x}`);break;case 50331648:const X=c.rgba.toColor(x>>16&255,x>>8&255,255&x);this._applyMinimumContrast(V,Q,X,N,Y,K)||this._addStyle(V,`color:#${d(x.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(V,Q,E.foreground,N,Y,void 0)||z&&V.classList.add(`xterm-fg-${h.INVERTED_DEFAULT_COLOR}`)}j.appendChild(V),W[M]=++R,M=G}return M<P-1&&W.subarray(M).fill(++R),j}_applyMinimumContrast(g,S,a,C,w,D){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,s.excludeFromContrastRatioDemands)(C.getCode()))return!1;let L;return w||D||(L=this._themeService.colors.contrastCache.getColor(S.rgba,a.rgba)),L===void 0&&(L=c.color.ensureContrastRatio(w||S,D||a,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((w||S).rgba,(D||a).rgba,L!=null?L:null)),!!L&&(this._addStyle(g,`color:${L.css}`),!0)}_addStyle(g,S){g.setAttribute("style",`${g.getAttribute("style")||""}${S};`)}_isCellInSelection(g,S){const a=this._selectionStart,C=this._selectionEnd;return!(!a||!C)&&(this._columnSelectMode?a[0]<=C[0]?g>=a[0]&&S>=a[1]&&g<C[0]&&S<=C[1]:g<a[0]&&S>=a[1]&&g>=C[0]&&S<=C[1]:S>a[1]&&S<C[1]||a[1]===C[1]&&S===a[1]&&g>=a[0]&&g<C[0]||a[1]<C[1]&&S===C[1]&&g<C[0]||a[1]<C[1]&&S===a[1]&&g>=a[0])}};function d(g,S,a){for(;g.length<a;)g=S+g;return g}o=l([v(1,e.ICharacterJoinerService),v(2,p.IOptionsService),v(3,e.ICoreBrowserService),v(4,p.ICoreService),v(5,p.IDecorationService),v(6,e.IThemeService)],o),t.DomRendererRowFactory=o},2223:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const l=n(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(B,t)=>{function n(l){return 57508<=l&&l<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(l){if(!l)throw new Error("value must not be falsy");return l},t.isPowerlineGlyph=n,t.isRestrictedPowerlineGlyph=function(l){return 57520<=l&&l<=57527},t.excludeFromContrastRatioDemands=function(l){return n(l)||function(v){return 9472<=v&&v<=9631}(l)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,l=this.selectionEnd;return!(!n||!l)&&(n[1]>l[1]||n[1]===l[1]&&n[0]>l[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(B,t,n){var l=this&&this.__decorate||function(e,r,s,i){var o,d=arguments.length,g=d<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,r,s,i);else for(var S=e.length-1;S>=0;S--)(o=e[S])&&(g=(d<3?o(g):d>3?o(r,s,g):o(r,s))||g);return d>3&&g&&Object.defineProperty(r,s,g),g},v=this&&this.__param||function(e,r){return function(s,i){r(s,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const h=n(2585),_=n(8460),m=n(844);let p=class extends m.Disposable{constructor(e,r,s){super(),this._optionsService=s,this.width=0,this.height=0,this._onCharSizeChange=this.register(new _.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new c(e,r,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};p=l([v(2,h.IOptionsService)],p),t.CharSizeService=p;class c{constructor(r,s,i){this._document=r,this._parentElement=s,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const r=this._measureElement.getBoundingClientRect();return r.width!==0&&r.height!==0&&(this._result.width=r.width,this._result.height=Math.ceil(r.height)),this._result}}},4269:function(B,t,n){var l=this&&this.__decorate||function(r,s,i,o){var d,g=arguments.length,S=g<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,i):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(r,s,i,o);else for(var a=r.length-1;a>=0;a--)(d=r[a])&&(S=(g<3?d(S):g>3?d(s,i,S):d(s,i))||S);return g>3&&S&&Object.defineProperty(s,i,S),S},v=this&&this.__param||function(r,s){return function(i,o){s(i,o,r)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const h=n(3734),_=n(643),m=n(511),p=n(2585);class c extends h.AttributeData{constructor(s,i,o){super(),this.content=0,this.combinedData="",this.fg=s.fg,this.bg=s.bg,this.combinedData=i,this._width=o}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(s){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=c;let e=class it{constructor(s){this._bufferService=s,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new m.CellData}register(s){const i={id:this._nextCharacterJoinerId++,handler:s};return this._characterJoiners.push(i),i.id}deregister(s){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===s)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(s){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(s);if(!i||i.length===0)return[];const o=[],d=i.translateToString(!0);let g=0,S=0,a=0,C=i.getFg(0),w=i.getBg(0);for(let D=0;D<i.getTrimmedLength();D++)if(i.loadCell(D,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==w){if(D-g>1){const L=this._getJoinedRanges(d,a,S,i,g);for(let P=0;P<L.length;P++)o.push(L[P])}g=D,a=S,C=this._workCell.fg,w=this._workCell.bg}S+=this._workCell.getChars().length||_.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-g>1){const D=this._getJoinedRanges(d,a,S,i,g);for(let L=0;L<D.length;L++)o.push(D[L])}return o}_getJoinedRanges(s,i,o,d,g){const S=s.substring(i,o);let a=[];try{a=this._characterJoiners[0].handler(S)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{const w=this._characterJoiners[C].handler(S);for(let D=0;D<w.length;D++)it._mergeRanges(a,w[D])}catch(w){console.error(w)}return this._stringRangesToCellRanges(a,d,g),a}_stringRangesToCellRanges(s,i,o){let d=0,g=!1,S=0,a=s[d];if(a){for(let C=o;C<this._bufferService.cols;C++){const w=i.getWidth(C),D=i.getString(C).length||_.WHITESPACE_CELL_CHAR.length;if(w!==0){if(!g&&a[0]<=S&&(a[0]=C,g=!0),a[1]<=S){if(a[1]=C,a=s[++d],!a)break;a[0]<=S?(a[0]=C,g=!0):g=!1}S+=D}}a&&(a[1]=this._bufferService.cols)}}static _mergeRanges(s,i){let o=!1;for(let d=0;d<s.length;d++){const g=s[d];if(o){if(i[1]<=g[0])return s[d-1][1]=i[1],s;if(i[1]<=g[1])return s[d-1][1]=Math.max(i[1],g[1]),s.splice(d,1),s;s.splice(d,1),d--}else{if(i[1]<=g[0])return s.splice(d,0,i),s;if(i[1]<=g[1])return g[0]=Math.min(i[0],g[0]),s;i[0]<g[1]&&(g[0]=Math.min(i[0],g[0]),o=!0)}}return o?s[s.length-1][1]=i[1]:s.push(i),s}};e=l([v(0,p.IBufferService)],e),t.CharacterJoinerService=e},5114:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0,t.CoreBrowserService=class{constructor(n,l){this._textarea=n,this.window=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(B,t,n){var l=this&&this.__decorate||function(p,c,e,r){var s,i=arguments.length,o=i<3?c:r===null?r=Object.getOwnPropertyDescriptor(c,e):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(p,c,e,r);else for(var d=p.length-1;d>=0;d--)(s=p[d])&&(o=(i<3?s(o):i>3?s(c,e,o):s(c,e))||o);return i>3&&o&&Object.defineProperty(c,e,o),o},v=this&&this.__param||function(p,c){return function(e,r){c(e,r,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const h=n(4725),_=n(9806);let m=class{constructor(p,c){this._renderService=p,this._charSizeService=c}getCoords(p,c,e,r,s){return(0,_.getCoords)(window,p,c,e,r,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,s)}getMouseReportCoords(p,c){const e=(0,_.getCoordsRelativeToElement)(window,p,c);if(!(!this._charSizeService.hasValidSize||e[0]<0||e[1]<0||e[0]>=this._renderService.dimensions.css.canvas.width||e[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(e[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(e[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(e[0]),y:Math.floor(e[1])}}};m=l([v(0,h.IRenderService),v(1,h.ICharSizeService)],m),t.MouseService=m},3230:function(B,t,n){var l=this&&this.__decorate||function(o,d,g,S){var a,C=arguments.length,w=C<3?d:S===null?S=Object.getOwnPropertyDescriptor(d,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(o,d,g,S);else for(var D=o.length-1;D>=0;D--)(a=o[D])&&(w=(C<3?a(w):C>3?a(d,g,w):a(d,g))||w);return C>3&&w&&Object.defineProperty(d,g,w),w},v=this&&this.__param||function(o,d){return function(g,S){d(g,S,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const h=n(6193),_=n(8460),m=n(844),p=n(5596),c=n(3656),e=n(2585),r=n(4725),s=n(7226);let i=class extends m.Disposable{constructor(o,d,g,S,a,C,w,D){if(super(),this._rowCount=o,this._charSizeService=S,this._pausedResizeTask=new s.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new _.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new _.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new _.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new _.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var L;return(L=this._renderer)===null||L===void 0?void 0:L.dispose()}}),this._renderDebouncer=new h.RenderDebouncer(w.window,(L,P)=>this._renderRows(L,P)),this.register(this._renderDebouncer),this._screenDprMonitor=new p.ScreenDprMonitor(w.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var L;return(L=this._renderer)===null||L===void 0?void 0:L.clear()})),this.register(g.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(a.onDecorationRegistered(()=>this._fullRefresh())),this.register(a.onDecorationRemoved(()=>this._fullRefresh())),this.register(g.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(g.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register((0,c.addDisposableDomListener)(w.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(D.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in w.window){const L=new w.window.IntersectionObserver(P=>this._handleIntersectionChange(P[P.length-1]),{threshold:0});L.observe(d),this.register({dispose:()=>L.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(o){this._isPaused=o.isIntersecting===void 0?o.intersectionRatio===0:!o.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(o,d,g=!1){this._isPaused?this._needsFullRefresh=!0:(g||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(o,d,this._rowCount))}_renderRows(o,d){this._renderer&&(o=Math.min(o,this._rowCount-1),d=Math.min(d,this._rowCount-1),this._renderer.renderRows(o,d),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:o,end:d}),this._onRender.fire({start:o,end:d}),this._isNextRenderRedrawOnly=!0)}resize(o,d){this._rowCount=d,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(o){var d;(d=this._renderer)===null||d===void 0||d.dispose(),this._renderer=o,this._renderer.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(o){return this._renderDebouncer.addRefreshCallback(o)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var o,d;this._renderer&&((d=(o=this._renderer).clearTextureAtlas)===null||d===void 0||d.call(o),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(o,d){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(o,d)):this._renderer.handleResize(o,d),this._fullRefresh())}handleCharSizeChanged(){var o;(o=this._renderer)===null||o===void 0||o.handleCharSizeChanged()}handleBlur(){var o;(o=this._renderer)===null||o===void 0||o.handleBlur()}handleFocus(){var o;(o=this._renderer)===null||o===void 0||o.handleFocus()}handleSelectionChanged(o,d,g){var S;this._selectionState.start=o,this._selectionState.end=d,this._selectionState.columnSelectMode=g,(S=this._renderer)===null||S===void 0||S.handleSelectionChanged(o,d,g)}handleCursorMove(){var o;(o=this._renderer)===null||o===void 0||o.handleCursorMove()}clear(){var o;(o=this._renderer)===null||o===void 0||o.clear()}};i=l([v(2,e.IOptionsService),v(3,r.ICharSizeService),v(4,e.IDecorationService),v(5,e.IBufferService),v(6,r.ICoreBrowserService),v(7,r.IThemeService)],i),t.RenderService=i},9312:function(B,t,n){var l=this&&this.__decorate||function(a,C,w,D){var L,P=arguments.length,W=P<3?C:D===null?D=Object.getOwnPropertyDescriptor(C,w):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(a,C,w,D);else for(var j=a.length-1;j>=0;j--)(L=a[j])&&(W=(P<3?L(W):P>3?L(C,w,W):L(C,w))||W);return P>3&&W&&Object.defineProperty(C,w,W),W},v=this&&this.__param||function(a,C){return function(w,D){C(w,D,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const h=n(6114),_=n(456),m=n(511),p=n(8460),c=n(4725),e=n(2585),r=n(9806),s=n(9504),i=n(844),o=n(4841),d=String.fromCharCode(160),g=new RegExp(d,"g");let S=class extends i.Disposable{constructor(a,C,w,D,L,P,W,j,U){super(),this._element=a,this._screenElement=C,this._linkifier=w,this._bufferService=D,this._coreService=L,this._mouseService=P,this._optionsService=W,this._renderService=j,this._coreBrowserService=U,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new m.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new p.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new p.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new p.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new p.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=y=>this._handleMouseMove(y),this._mouseUpListener=y=>this._handleMouseUp(y),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(y=>this._handleTrim(y)),this.register(this._bufferService.buffers.onBufferActivate(y=>this._handleBufferActivate(y))),this.enable(),this._model=new _.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const a=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!a||!C||a[0]===C[0]&&a[1]===C[1])}get selectionText(){const a=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!a||!C)return"";const w=this._bufferService.buffer,D=[];if(this._activeSelectionMode===3){if(a[0]===C[0])return"";const L=a[0]<C[0]?a[0]:C[0],P=a[0]<C[0]?C[0]:a[0];for(let W=a[1];W<=C[1];W++){const j=w.translateBufferLineToString(W,!0,L,P);D.push(j)}}else{const L=a[1]===C[1]?C[0]:void 0;D.push(w.translateBufferLineToString(a[1],!0,a[0],L));for(let P=a[1]+1;P<=C[1]-1;P++){const W=w.lines.get(P),j=w.translateBufferLineToString(P,!0);W!=null&&W.isWrapped?D[D.length-1]+=j:D.push(j)}if(a[1]!==C[1]){const P=w.lines.get(C[1]),W=w.translateBufferLineToString(C[1],!0,0,C[0]);P&&P.isWrapped?D[D.length-1]+=W:D.push(W)}}return D.map(L=>L.replace(g," ")).join(h.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(a){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),h.isLinux&&a&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(a){const C=this._getMouseBufferCoords(a),w=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(w&&D&&C)&&this._areCoordsInSelection(C,w,D)}isCellInSelection(a,C){const w=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!w||!D)&&this._areCoordsInSelection([a,C],w,D)}_areCoordsInSelection(a,C,w){return a[1]>C[1]&&a[1]<w[1]||C[1]===w[1]&&a[1]===C[1]&&a[0]>=C[0]&&a[0]<w[0]||C[1]<w[1]&&a[1]===w[1]&&a[0]<w[0]||C[1]<w[1]&&a[1]===C[1]&&a[0]>=C[0]}_selectWordAtCursor(a,C){var w,D;const L=(D=(w=this._linkifier.currentLink)===null||w===void 0?void 0:w.link)===null||D===void 0?void 0:D.range;if(L)return this._model.selectionStart=[L.start.x-1,L.start.y-1],this._model.selectionStartLength=(0,o.getRangeLength)(L,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const P=this._getMouseBufferCoords(a);return!!P&&(this._selectWordAt(P,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(a,C){this._model.clearSelection(),a=Math.max(a,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,a],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(a){this._model.handleTrim(a)&&this.refresh()}_getMouseBufferCoords(a){const C=this._mouseService.getCoords(a,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(a){let C=(0,r.getCoordsRelativeToElement)(this._coreBrowserService.window,a,this._screenElement)[1];const w=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=w?0:(C>w&&(C-=w),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(a){return h.isMac?a.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:a.shiftKey}handleMouseDown(a){if(this._mouseDownTimeStamp=a.timeStamp,(a.button!==2||!this.hasSelection)&&a.button===0){if(!this._enabled){if(!this.shouldForceSelection(a))return;a.stopPropagation()}a.preventDefault(),this._dragScrollAmount=0,this._enabled&&a.shiftKey?this._handleIncrementalClick(a):a.detail===1?this._handleSingleClick(a):a.detail===2?this._handleDoubleClick(a):a.detail===3&&this._handleTripleClick(a),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(a){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(a))}_handleSingleClick(a){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(a)?3:0,this._model.selectionStart=this._getMouseBufferCoords(a),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(a){this._selectWordAtCursor(a,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(a){const C=this._getMouseBufferCoords(a);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(a){return a.altKey&&!(h.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(a){if(a.stopImmediatePropagation(),!this._model.selectionStart)return;const C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(a),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(a),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const w=this._bufferService.buffer;if(this._model.selectionEnd[1]<w.lines.length){const D=w.lines.get(this._model.selectionEnd[1]);D&&D.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const a=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(a.ydisp+this._bufferService.rows,a.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=a.ydisp),this.refresh()}}_handleMouseUp(a){const C=a.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&a.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const w=this._mouseService.getCoords(a,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(w&&w[0]!==void 0&&w[1]!==void 0){const D=(0,s.moveToCellSequence)(w[0]-1,w[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const a=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,w=!(!a||!C||a[0]===C[0]&&a[1]===C[1]);w?a&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&a[0]===this._oldSelectionStart[0]&&a[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(a,C,w)):this._oldHasSelection&&this._fireOnSelectionChange(a,C,w)}_fireOnSelectionChange(a,C,w){this._oldSelectionStart=a,this._oldSelectionEnd=C,this._oldHasSelection=w,this._onSelectionChange.fire()}_handleBufferActivate(a){this.clearSelection(),this._trimListener.dispose(),this._trimListener=a.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(a,C){let w=C;for(let D=0;C>=D;D++){const L=a.loadCell(D,this._workCell).getChars().length;this._workCell.getWidth()===0?w--:L>1&&C!==D&&(w+=L-1)}return w}setSelection(a,C,w){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[a,C],this._model.selectionStartLength=w,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(a){this._isClickInSelection(a)||(this._selectWordAtCursor(a,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(a,C,w=!0,D=!0){if(a[0]>=this._bufferService.cols)return;const L=this._bufferService.buffer,P=L.lines.get(a[1]);if(!P)return;const W=L.translateBufferLineToString(a[1],!1);let j=this._convertViewportColToCharacterIndex(P,a[0]),U=j;const y=a[0]-j;let E=0,R=0,M=0,$=0;if(W.charAt(j)===" "){for(;j>0&&W.charAt(j-1)===" ";)j--;for(;U<W.length&&W.charAt(U+1)===" ";)U++}else{let N=a[0],V=a[0];P.getWidth(N)===0&&(E++,N--),P.getWidth(V)===2&&(R++,V++);const x=P.getString(V).length;for(x>1&&($+=x-1,U+=x-1);N>0&&j>0&&!this._isCharWordSeparator(P.loadCell(N-1,this._workCell));){P.loadCell(N-1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===0?(E++,N--):A>1&&(M+=A-1,j-=A-1),j--,N--}for(;V<P.length&&U+1<W.length&&!this._isCharWordSeparator(P.loadCell(V+1,this._workCell));){P.loadCell(V+1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===2?(R++,V++):A>1&&($+=A-1,U+=A-1),U++,V++}}U++;let q=j+y-E+M,G=Math.min(this._bufferService.cols,U-j+E+R-M-$);if(C||W.slice(j,U).trim()!==""){if(w&&q===0&&P.getCodePoint(0)!==32){const N=L.lines.get(a[1]-1);if(N&&P.isWrapped&&N.getCodePoint(this._bufferService.cols-1)!==32){const V=this._getWordAt([this._bufferService.cols-1,a[1]-1],!1,!0,!1);if(V){const x=this._bufferService.cols-V.start;q-=x,G+=x}}}if(D&&q+G===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const N=L.lines.get(a[1]+1);if(N!=null&&N.isWrapped&&N.getCodePoint(0)!==32){const V=this._getWordAt([0,a[1]+1],!1,!1,!0);V&&(G+=V.length)}}return{start:q,length:G}}}_selectWordAt(a,C){const w=this._getWordAt(a,C);if(w){for(;w.start<0;)w.start+=this._bufferService.cols,a[1]--;this._model.selectionStart=[w.start,a[1]],this._model.selectionStartLength=w.length}}_selectToWordAt(a){const C=this._getWordAt(a,!0);if(C){let w=a[1];for(;C.start<0;)C.start+=this._bufferService.cols,w--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,w++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,w]}}_isCharWordSeparator(a){return a.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(a.getChars())>=0}_selectLineAt(a){const C=this._bufferService.buffer.getWrappedRangeForLine(a),w={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,o.getRangeLength)(w,this._bufferService.cols)}};S=l([v(3,e.IBufferService),v(4,e.ICoreService),v(5,c.IMouseService),v(6,e.IOptionsService),v(7,c.IRenderService),v(8,c.ICoreBrowserService)],S),t.SelectionService=S},4725:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const l=n(8343);t.ICharSizeService=(0,l.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),t.IMouseService=(0,l.createDecorator)("MouseService"),t.IRenderService=(0,l.createDecorator)("RenderService"),t.ISelectionService=(0,l.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,l.createDecorator)("ThemeService")},6731:function(B,t,n){var l=this&&this.__decorate||function(S,a,C,w){var D,L=arguments.length,P=L<3?a:w===null?w=Object.getOwnPropertyDescriptor(a,C):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(S,a,C,w);else for(var W=S.length-1;W>=0;W--)(D=S[W])&&(P=(L<3?D(P):L>3?D(a,C,P):D(a,C))||P);return L>3&&P&&Object.defineProperty(a,C,P),P},v=this&&this.__param||function(S,a){return function(C,w){a(C,w,S)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const h=n(7239),_=n(8055),m=n(8460),p=n(844),c=n(2585),e=_.css.toColor("#ffffff"),r=_.css.toColor("#000000"),s=_.css.toColor("#ffffff"),i=_.css.toColor("#000000"),o={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const S=[_.css.toColor("#2e3436"),_.css.toColor("#cc0000"),_.css.toColor("#4e9a06"),_.css.toColor("#c4a000"),_.css.toColor("#3465a4"),_.css.toColor("#75507b"),_.css.toColor("#06989a"),_.css.toColor("#d3d7cf"),_.css.toColor("#555753"),_.css.toColor("#ef2929"),_.css.toColor("#8ae234"),_.css.toColor("#fce94f"),_.css.toColor("#729fcf"),_.css.toColor("#ad7fa8"),_.css.toColor("#34e2e2"),_.css.toColor("#eeeeec")],a=[0,95,135,175,215,255];for(let C=0;C<216;C++){const w=a[C/36%6|0],D=a[C/6%6|0],L=a[C%6];S.push({css:_.channels.toCss(w,D,L),rgba:_.channels.toRgba(w,D,L)})}for(let C=0;C<24;C++){const w=8+10*C;S.push({css:_.channels.toCss(w,w,w),rgba:_.channels.toRgba(w,w,w)})}return S})());let d=class extends p.Disposable{constructor(S){super(),this._optionsService=S,this._onChangeColors=this.register(new m.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new h.ColorContrastCache,this._colors={foreground:e,background:r,cursor:s,cursorAccent:i,selectionForeground:void 0,selectionBackgroundTransparent:o,selectionBackgroundOpaque:_.color.blend(r,o),selectionInactiveBackgroundTransparent:o,selectionInactiveBackgroundOpaque:_.color.blend(r,o),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(S={}){const a=this._colors;if(a.foreground=g(S.foreground,e),a.background=g(S.background,r),a.cursor=g(S.cursor,s),a.cursorAccent=g(S.cursorAccent,i),a.selectionBackgroundTransparent=g(S.selectionBackground,o),a.selectionBackgroundOpaque=_.color.blend(a.background,a.selectionBackgroundTransparent),a.selectionInactiveBackgroundTransparent=g(S.selectionInactiveBackground,a.selectionBackgroundTransparent),a.selectionInactiveBackgroundOpaque=_.color.blend(a.background,a.selectionInactiveBackgroundTransparent),a.selectionForeground=S.selectionForeground?g(S.selectionForeground,_.NULL_COLOR):void 0,a.selectionForeground===_.NULL_COLOR&&(a.selectionForeground=void 0),_.color.isOpaque(a.selectionBackgroundTransparent)&&(a.selectionBackgroundTransparent=_.color.opacity(a.selectionBackgroundTransparent,.3)),_.color.isOpaque(a.selectionInactiveBackgroundTransparent)&&(a.selectionInactiveBackgroundTransparent=_.color.opacity(a.selectionInactiveBackgroundTransparent,.3)),a.ansi=t.DEFAULT_ANSI_COLORS.slice(),a.ansi[0]=g(S.black,t.DEFAULT_ANSI_COLORS[0]),a.ansi[1]=g(S.red,t.DEFAULT_ANSI_COLORS[1]),a.ansi[2]=g(S.green,t.DEFAULT_ANSI_COLORS[2]),a.ansi[3]=g(S.yellow,t.DEFAULT_ANSI_COLORS[3]),a.ansi[4]=g(S.blue,t.DEFAULT_ANSI_COLORS[4]),a.ansi[5]=g(S.magenta,t.DEFAULT_ANSI_COLORS[5]),a.ansi[6]=g(S.cyan,t.DEFAULT_ANSI_COLORS[6]),a.ansi[7]=g(S.white,t.DEFAULT_ANSI_COLORS[7]),a.ansi[8]=g(S.brightBlack,t.DEFAULT_ANSI_COLORS[8]),a.ansi[9]=g(S.brightRed,t.DEFAULT_ANSI_COLORS[9]),a.ansi[10]=g(S.brightGreen,t.DEFAULT_ANSI_COLORS[10]),a.ansi[11]=g(S.brightYellow,t.DEFAULT_ANSI_COLORS[11]),a.ansi[12]=g(S.brightBlue,t.DEFAULT_ANSI_COLORS[12]),a.ansi[13]=g(S.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),a.ansi[14]=g(S.brightCyan,t.DEFAULT_ANSI_COLORS[14]),a.ansi[15]=g(S.brightWhite,t.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){const C=Math.min(a.ansi.length-16,S.extendedAnsi.length);for(let w=0;w<C;w++)a.ansi[w+16]=g(S.extendedAnsi[w],t.DEFAULT_ANSI_COLORS[w+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let a=0;a<this._restoreColors.ansi.length;++a)this._colors.ansi[a]=this._restoreColors.ansi[a]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function g(S,a){if(S!==void 0)try{return _.css.toColor(S)}catch{}return a}d=l([v(0,c.IOptionsService)],d),t.ThemeService=d},6349:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const l=n(8460),v=n(844);class h extends v.Disposable{constructor(m){super(),this._maxLength=m,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(m){if(this._maxLength===m)return;const p=new Array(m);for(let c=0;c<Math.min(m,this.length);c++)p[c]=this._array[this._getCyclicIndex(c)];this._array=p,this._maxLength=m,this._startIndex=0}get length(){return this._length}set length(m){if(m>this._length)for(let p=this._length;p<m;p++)this._array[p]=void 0;this._length=m}get(m){return this._array[this._getCyclicIndex(m)]}set(m,p){this._array[this._getCyclicIndex(m)]=p}push(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(m,p,...c){if(p){for(let e=m;e<this._length-p;e++)this._array[this._getCyclicIndex(e)]=this._array[this._getCyclicIndex(e+p)];this._length-=p,this.onDeleteEmitter.fire({index:m,amount:p})}for(let e=this._length-1;e>=m;e--)this._array[this._getCyclicIndex(e+c.length)]=this._array[this._getCyclicIndex(e)];for(let e=0;e<c.length;e++)this._array[this._getCyclicIndex(m+e)]=c[e];if(c.length&&this.onInsertEmitter.fire({index:m,amount:c.length}),this._length+c.length>this._maxLength){const e=this._length+c.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=c.length}trimStart(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)}shiftElements(m,p,c){if(!(p<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+c<0)throw new Error("Cannot shift elements in list beyond index 0");if(c>0){for(let r=p-1;r>=0;r--)this.set(m+r+c,this.get(m+r));const e=m+p+c-this._length;if(e>0)for(this._length+=e;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let e=0;e<p;e++)this.set(m+e+c,this.get(m+e))}}_getCyclicIndex(m){return(this._startIndex+m)%this._maxLength}}t.CircularList=h},1439:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function n(l,v=5){if(typeof l!="object")return l;const h=Array.isArray(l)?[]:{};for(const _ in l)h[_]=v<=1?l[_]:l[_]&&n(l[_],v-1);return h}},8055:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;const l=n(6114);let v=0,h=0,_=0,m=0;var p,c,e;function r(i){const o=i.toString(16);return o.length<2?"0"+o:o}function s(i,o){return i<o?(o+.05)/(i+.05):(i+.05)/(o+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(o,d,g,S){return S!==void 0?`#${r(o)}${r(d)}${r(g)}${r(S)}`:`#${r(o)}${r(d)}${r(g)}`},i.toRgba=function(o,d,g,S=255){return(o<<24|d<<16|g<<8|S)>>>0}}(p=t.channels||(t.channels={})),function(i){function o(d,g){return m=Math.round(255*g),[v,h,_]=e.toChannels(d.rgba),{css:p.toCss(v,h,_,m),rgba:p.toRgba(v,h,_,m)}}i.blend=function(d,g){if(m=(255&g.rgba)/255,m===1)return{css:g.css,rgba:g.rgba};const S=g.rgba>>24&255,a=g.rgba>>16&255,C=g.rgba>>8&255,w=d.rgba>>24&255,D=d.rgba>>16&255,L=d.rgba>>8&255;return v=w+Math.round((S-w)*m),h=D+Math.round((a-D)*m),_=L+Math.round((C-L)*m),{css:p.toCss(v,h,_),rgba:p.toRgba(v,h,_)}},i.isOpaque=function(d){return(255&d.rgba)==255},i.ensureContrastRatio=function(d,g,S){const a=e.ensureContrastRatio(d.rgba,g.rgba,S);if(a)return e.toColor(a>>24&255,a>>16&255,a>>8&255)},i.opaque=function(d){const g=(255|d.rgba)>>>0;return[v,h,_]=e.toChannels(g),{css:p.toCss(v,h,_),rgba:g}},i.opacity=o,i.multiplyOpacity=function(d,g){return m=255&d.rgba,o(d,m*g/255)},i.toColorRGB=function(d){return[d.rgba>>24&255,d.rgba>>16&255,d.rgba>>8&255]}}(t.color||(t.color={})),function(i){let o,d;if(!l.isNode){const g=document.createElement("canvas");g.width=1,g.height=1;const S=g.getContext("2d",{willReadFrequently:!0});S&&(o=S,o.globalCompositeOperation="copy",d=o.createLinearGradient(0,0,1,1))}i.toColor=function(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return v=parseInt(g.slice(1,2).repeat(2),16),h=parseInt(g.slice(2,3).repeat(2),16),_=parseInt(g.slice(3,4).repeat(2),16),e.toColor(v,h,_);case 5:return v=parseInt(g.slice(1,2).repeat(2),16),h=parseInt(g.slice(2,3).repeat(2),16),_=parseInt(g.slice(3,4).repeat(2),16),m=parseInt(g.slice(4,5).repeat(2),16),e.toColor(v,h,_,m);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}const S=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return v=parseInt(S[1]),h=parseInt(S[2]),_=parseInt(S[3]),m=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),e.toColor(v,h,_,m);if(!o||!d)throw new Error("css.toColor: Unsupported css format");if(o.fillStyle=d,o.fillStyle=g,typeof o.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(o.fillRect(0,0,1,1),[v,h,_,m]=o.getImageData(0,0,1,1).data,m!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:p.toRgba(v,h,_,m),css:g}}}(t.css||(t.css={})),function(i){function o(d,g,S){const a=d/255,C=g/255,w=S/255;return .2126*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}i.relativeLuminance=function(d){return o(d>>16&255,d>>8&255,255&d)},i.relativeLuminance2=o}(c=t.rgb||(t.rgb={})),function(i){function o(g,S,a){const C=g>>24&255,w=g>>16&255,D=g>>8&255;let L=S>>24&255,P=S>>16&255,W=S>>8&255,j=s(c.relativeLuminance2(L,P,W),c.relativeLuminance2(C,w,D));for(;j<a&&(L>0||P>0||W>0);)L-=Math.max(0,Math.ceil(.1*L)),P-=Math.max(0,Math.ceil(.1*P)),W-=Math.max(0,Math.ceil(.1*W)),j=s(c.relativeLuminance2(L,P,W),c.relativeLuminance2(C,w,D));return(L<<24|P<<16|W<<8|255)>>>0}function d(g,S,a){const C=g>>24&255,w=g>>16&255,D=g>>8&255;let L=S>>24&255,P=S>>16&255,W=S>>8&255,j=s(c.relativeLuminance2(L,P,W),c.relativeLuminance2(C,w,D));for(;j<a&&(L<255||P<255||W<255);)L=Math.min(255,L+Math.ceil(.1*(255-L))),P=Math.min(255,P+Math.ceil(.1*(255-P))),W=Math.min(255,W+Math.ceil(.1*(255-W))),j=s(c.relativeLuminance2(L,P,W),c.relativeLuminance2(C,w,D));return(L<<24|P<<16|W<<8|255)>>>0}i.ensureContrastRatio=function(g,S,a){const C=c.relativeLuminance(g>>8),w=c.relativeLuminance(S>>8);if(s(C,w)<a){if(w<C){const P=o(g,S,a),W=s(C,c.relativeLuminance(P>>8));if(W<a){const j=d(g,S,a);return W>s(C,c.relativeLuminance(j>>8))?P:j}return P}const D=d(g,S,a),L=s(C,c.relativeLuminance(D>>8));if(L<a){const P=o(g,S,a);return L>s(C,c.relativeLuminance(P>>8))?D:P}return D}},i.reduceLuminance=o,i.increaseLuminance=d,i.toChannels=function(g){return[g>>24&255,g>>16&255,g>>8&255,255&g]},i.toColor=function(g,S,a,C){return{css:p.toCss(g,S,a,C),rgba:p.toRgba(g,S,a,C)}}}(e=t.rgba||(t.rgba={})),t.toPaddedHex=r,t.contrastRatio=s},8969:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const l=n(844),v=n(2585),h=n(4348),_=n(7866),m=n(744),p=n(7302),c=n(6975),e=n(8460),r=n(1753),s=n(1480),i=n(7994),o=n(9282),d=n(5435),g=n(5981),S=n(2660);let a=!1;class C extends l.Disposable{constructor(D){super(),this._onBinary=this.register(new e.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new e.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new e.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new e.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new e.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new e.EventEmitter),this._instantiationService=new h.InstantiationService,this.optionsService=this.register(new p.OptionsService(D)),this._instantiationService.setService(v.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(m.BufferService)),this._instantiationService.setService(v.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(_.LogService)),this._instantiationService.setService(v.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(c.CoreService)),this._instantiationService.setService(v.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(r.CoreMouseService)),this._instantiationService.setService(v.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(s.UnicodeService)),this._instantiationService.setService(v.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(i.CharsetService),this._instantiationService.setService(v.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(v.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new d.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,e.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,e.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,e.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,e.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(L=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(L=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new g.WriteBuffer((L,P)=>this._inputHandler.parse(L,P))),this.register((0,e.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,l.toDisposable)(()=>{var L;(L=this._windowsWrappingHeuristics)===null||L===void 0||L.dispose(),this._windowsWrappingHeuristics=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new e.EventEmitter),this._onScroll.event(D=>{var L;(L=this._onScrollApi)===null||L===void 0||L.fire(D.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(const L in D)this.optionsService.options[L]=D[L]}write(D,L){this._writeBuffer.write(D,L)}writeSync(D,L){this._logService.logLevel<=v.LogLevelEnum.WARN&&!a&&(this._logService.warn("writeSync is unreliable and will be removed soon."),a=!0),this._writeBuffer.writeSync(D,L)}resize(D,L){isNaN(D)||isNaN(L)||(D=Math.max(D,m.MINIMUM_COLS),L=Math.max(L,m.MINIMUM_ROWS),this._bufferService.resize(D,L))}scroll(D,L=!1){this._bufferService.scroll(D,L)}scrollLines(D,L,P){this._bufferService.scrollLines(D,L,P)}scrollPages(D){this._bufferService.scrollPages(D)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(D){this._bufferService.scrollToLine(D)}registerEscHandler(D,L){return this._inputHandler.registerEscHandler(D,L)}registerDcsHandler(D,L){return this._inputHandler.registerDcsHandler(D,L)}registerCsiHandler(D,L){return this._inputHandler.registerCsiHandler(D,L)}registerOscHandler(D,L){return this._inputHandler.registerOscHandler(D,L)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){var D;let L=!1;const P=this.optionsService.rawOptions.windowsPty;P&&P.buildNumber!==void 0&&P.buildNumber!==void 0?L=P.backend==="conpty"&&P.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(L=!0),L?this._enableWindowsWrappingHeuristics():((D=this._windowsWrappingHeuristics)===null||D===void 0||D.dispose(),this._windowsWrappingHeuristics=void 0)}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics){const D=[];D.push(this.onLineFeed(o.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},()=>((0,o.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics=(0,l.toDisposable)(()=>{for(const L of D)L.dispose()})}}}t.CoreTerminal=C},8460:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===n)return void this._listeners.splice(l,1)}}})),this._event}fire(n,l){const v=[];for(let h=0;h<this._listeners.length;h++)v.push(this._listeners[h]);for(let h=0;h<v.length;h++)v[h].call(void 0,n,l)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},t.forwardEvent=function(n,l){return n(v=>l.fire(v))}},5435:function(B,t,n){var l=this&&this.__decorate||function(U,y,E,R){var M,$=arguments.length,q=$<3?y:R===null?R=Object.getOwnPropertyDescriptor(y,E):R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")q=Reflect.decorate(U,y,E,R);else for(var G=U.length-1;G>=0;G--)(M=U[G])&&(q=($<3?M(q):$>3?M(y,E,q):M(y,E))||q);return $>3&&q&&Object.defineProperty(y,E,q),q},v=this&&this.__param||function(U,y){return function(E,R){y(E,R,U)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const h=n(2584),_=n(7116),m=n(2015),p=n(844),c=n(482),e=n(8437),r=n(8460),s=n(643),i=n(511),o=n(3734),d=n(2585),g=n(6242),S=n(6351),a=n(5941),C={"(":0,")":1,"*":2,"+":3,"-":1,".":2},w=131072;function D(U,y){if(U>24)return y.setWinLines||!1;switch(U){case 1:return!!y.restoreWin;case 2:return!!y.minimizeWin;case 3:return!!y.setWinPosition;case 4:return!!y.setWinSizePixels;case 5:return!!y.raiseWin;case 6:return!!y.lowerWin;case 7:return!!y.refreshWin;case 8:return!!y.setWinSizeChars;case 9:return!!y.maximizeWin;case 10:return!!y.fullscreenWin;case 11:return!!y.getWinState;case 13:return!!y.getWinPosition;case 14:return!!y.getWinSizePixels;case 15:return!!y.getScreenSizePixels;case 16:return!!y.getCellSizePixels;case 18:return!!y.getWinSizeChars;case 19:return!!y.getScreenSizeChars;case 20:return!!y.getIconTitle;case 21:return!!y.getWinTitle;case 22:return!!y.pushTitle;case 23:return!!y.popTitle;case 24:return!!y.setWinLines}return!1}var L;(function(U){U[U.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",U[U.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(L=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));let P=0;class W extends p.Disposable{constructor(y,E,R,M,$,q,G,N,V=new m.EscapeSequenceParser){super(),this._bufferService=y,this._charsetService=E,this._coreService=R,this._logService=M,this._optionsService=$,this._oscLinkService=q,this._coreMouseService=G,this._unicodeService=N,this._parser=V,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new c.StringToUtf32,this._utf8Decoder=new c.Utf8ToUtf32,this._workCell=new i.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new r.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new r.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new r.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new r.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new r.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new r.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new r.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new r.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new r.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new r.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new r.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new r.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new r.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new j(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(x=>this._activeBuffer=x.activeBuffer)),this._parser.setCsiHandlerFallback((x,A)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(x),params:A.toArray()})}),this._parser.setEscHandlerFallback(x=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(x)})}),this._parser.setExecuteHandlerFallback(x=>{this._logService.debug("Unknown EXECUTE code: ",{code:x})}),this._parser.setOscHandlerFallback((x,A,O)=>{this._logService.debug("Unknown OSC code: ",{identifier:x,action:A,data:O})}),this._parser.setDcsHandlerFallback((x,A,O)=>{A==="HOOK"&&(O=O.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(x),action:A,payload:O})}),this._parser.setPrintHandler((x,A,O)=>this.print(x,A,O)),this._parser.registerCsiHandler({final:"@"},x=>this.insertChars(x)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},x=>this.scrollLeft(x)),this._parser.registerCsiHandler({final:"A"},x=>this.cursorUp(x)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},x=>this.scrollRight(x)),this._parser.registerCsiHandler({final:"B"},x=>this.cursorDown(x)),this._parser.registerCsiHandler({final:"C"},x=>this.cursorForward(x)),this._parser.registerCsiHandler({final:"D"},x=>this.cursorBackward(x)),this._parser.registerCsiHandler({final:"E"},x=>this.cursorNextLine(x)),this._parser.registerCsiHandler({final:"F"},x=>this.cursorPrecedingLine(x)),this._parser.registerCsiHandler({final:"G"},x=>this.cursorCharAbsolute(x)),this._parser.registerCsiHandler({final:"H"},x=>this.cursorPosition(x)),this._parser.registerCsiHandler({final:"I"},x=>this.cursorForwardTab(x)),this._parser.registerCsiHandler({final:"J"},x=>this.eraseInDisplay(x,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},x=>this.eraseInDisplay(x,!0)),this._parser.registerCsiHandler({final:"K"},x=>this.eraseInLine(x,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},x=>this.eraseInLine(x,!0)),this._parser.registerCsiHandler({final:"L"},x=>this.insertLines(x)),this._parser.registerCsiHandler({final:"M"},x=>this.deleteLines(x)),this._parser.registerCsiHandler({final:"P"},x=>this.deleteChars(x)),this._parser.registerCsiHandler({final:"S"},x=>this.scrollUp(x)),this._parser.registerCsiHandler({final:"T"},x=>this.scrollDown(x)),this._parser.registerCsiHandler({final:"X"},x=>this.eraseChars(x)),this._parser.registerCsiHandler({final:"Z"},x=>this.cursorBackwardTab(x)),this._parser.registerCsiHandler({final:"`"},x=>this.charPosAbsolute(x)),this._parser.registerCsiHandler({final:"a"},x=>this.hPositionRelative(x)),this._parser.registerCsiHandler({final:"b"},x=>this.repeatPrecedingCharacter(x)),this._parser.registerCsiHandler({final:"c"},x=>this.sendDeviceAttributesPrimary(x)),this._parser.registerCsiHandler({prefix:">",final:"c"},x=>this.sendDeviceAttributesSecondary(x)),this._parser.registerCsiHandler({final:"d"},x=>this.linePosAbsolute(x)),this._parser.registerCsiHandler({final:"e"},x=>this.vPositionRelative(x)),this._parser.registerCsiHandler({final:"f"},x=>this.hVPosition(x)),this._parser.registerCsiHandler({final:"g"},x=>this.tabClear(x)),this._parser.registerCsiHandler({final:"h"},x=>this.setMode(x)),this._parser.registerCsiHandler({prefix:"?",final:"h"},x=>this.setModePrivate(x)),this._parser.registerCsiHandler({final:"l"},x=>this.resetMode(x)),this._parser.registerCsiHandler({prefix:"?",final:"l"},x=>this.resetModePrivate(x)),this._parser.registerCsiHandler({final:"m"},x=>this.charAttributes(x)),this._parser.registerCsiHandler({final:"n"},x=>this.deviceStatus(x)),this._parser.registerCsiHandler({prefix:"?",final:"n"},x=>this.deviceStatusPrivate(x)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},x=>this.softReset(x)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},x=>this.setCursorStyle(x)),this._parser.registerCsiHandler({final:"r"},x=>this.setScrollRegion(x)),this._parser.registerCsiHandler({final:"s"},x=>this.saveCursor(x)),this._parser.registerCsiHandler({final:"t"},x=>this.windowOptions(x)),this._parser.registerCsiHandler({final:"u"},x=>this.restoreCursor(x)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},x=>this.insertColumns(x)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},x=>this.deleteColumns(x)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},x=>this.selectProtected(x)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},x=>this.requestMode(x,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},x=>this.requestMode(x,!1)),this._parser.setExecuteHandler(h.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(h.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(h.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(h.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(h.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(h.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(h.C1.IND,()=>this.index()),this._parser.setExecuteHandler(h.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(h.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new g.OscHandler(x=>(this.setTitle(x),this.setIconName(x),!0))),this._parser.registerOscHandler(1,new g.OscHandler(x=>this.setIconName(x))),this._parser.registerOscHandler(2,new g.OscHandler(x=>this.setTitle(x))),this._parser.registerOscHandler(4,new g.OscHandler(x=>this.setOrReportIndexedColor(x))),this._parser.registerOscHandler(8,new g.OscHandler(x=>this.setHyperlink(x))),this._parser.registerOscHandler(10,new g.OscHandler(x=>this.setOrReportFgColor(x))),this._parser.registerOscHandler(11,new g.OscHandler(x=>this.setOrReportBgColor(x))),this._parser.registerOscHandler(12,new g.OscHandler(x=>this.setOrReportCursorColor(x))),this._parser.registerOscHandler(104,new g.OscHandler(x=>this.restoreIndexedColor(x))),this._parser.registerOscHandler(110,new g.OscHandler(x=>this.restoreFgColor(x))),this._parser.registerOscHandler(111,new g.OscHandler(x=>this.restoreBgColor(x))),this._parser.registerOscHandler(112,new g.OscHandler(x=>this.restoreCursorColor(x))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const x in _.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:x},()=>this.selectCharset("("+x)),this._parser.registerEscHandler({intermediates:")",final:x},()=>this.selectCharset(")"+x)),this._parser.registerEscHandler({intermediates:"*",final:x},()=>this.selectCharset("*"+x)),this._parser.registerEscHandler({intermediates:"+",final:x},()=>this.selectCharset("+"+x)),this._parser.registerEscHandler({intermediates:"-",final:x},()=>this.selectCharset("-"+x)),this._parser.registerEscHandler({intermediates:".",final:x},()=>this.selectCharset("."+x)),this._parser.registerEscHandler({intermediates:"/",final:x},()=>this.selectCharset("/"+x));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(x=>(this._logService.error("Parsing error: ",x),x)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new S.DcsHandler((x,A)=>this.requestStatusString(x,A)))}getAttrData(){return this._curAttrData}_preserveStack(y,E,R,M){this._parseStack.paused=!0,this._parseStack.cursorStartX=y,this._parseStack.cursorStartY=E,this._parseStack.decodedLength=R,this._parseStack.position=M}_logSlowResolvingAsync(y){this._logService.logLevel<=d.LogLevelEnum.WARN&&Promise.race([y,new Promise((E,R)=>setTimeout(()=>R("#SLOW_TIMEOUT"),5e3))]).catch(E=>{if(E!=="#SLOW_TIMEOUT")throw E;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(y,E){let R,M=this._activeBuffer.x,$=this._activeBuffer.y,q=0;const G=this._parseStack.paused;if(G){if(R=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,E))return this._logSlowResolvingAsync(R),R;M=this._parseStack.cursorStartX,$=this._parseStack.cursorStartY,this._parseStack.paused=!1,y.length>w&&(q=this._parseStack.position+w)}if(this._logService.logLevel<=d.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof y=="string"?` "${y}"`:` "${Array.prototype.map.call(y,N=>String.fromCharCode(N)).join("")}"`),typeof y=="string"?y.split("").map(N=>N.charCodeAt(0)):y),this._parseBuffer.length<y.length&&this._parseBuffer.length<w&&(this._parseBuffer=new Uint32Array(Math.min(y.length,w))),G||this._dirtyRowTracker.clearRange(),y.length>w)for(let N=q;N<y.length;N+=w){const V=N+w<y.length?N+w:y.length,x=typeof y=="string"?this._stringDecoder.decode(y.substring(N,V),this._parseBuffer):this._utf8Decoder.decode(y.subarray(N,V),this._parseBuffer);if(R=this._parser.parse(this._parseBuffer,x))return this._preserveStack(M,$,x,N),this._logSlowResolvingAsync(R),R}else if(!G){const N=typeof y=="string"?this._stringDecoder.decode(y,this._parseBuffer):this._utf8Decoder.decode(y,this._parseBuffer);if(R=this._parser.parse(this._parseBuffer,N))return this._preserveStack(M,$,N,0),this._logSlowResolvingAsync(R),R}this._activeBuffer.x===M&&this._activeBuffer.y===$||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(y,E,R){let M,$;const q=this._charsetService.charset,G=this._optionsService.rawOptions.screenReaderMode,N=this._bufferService.cols,V=this._coreService.decPrivateModes.wraparound,x=this._coreService.modes.insertMode,A=this._curAttrData;let O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&R-E>0&&O.getWidth(this._activeBuffer.x-1)===2&&O.setCellFromCodePoint(this._activeBuffer.x-1,0,1,A.fg,A.bg,A.extended);for(let F=E;F<R;++F){if(M=y[F],$=this._unicodeService.wcwidth(M),M<127&&q){const z=q[String.fromCharCode(M)];z&&(M=z.charCodeAt(0))}if(G&&this._onA11yChar.fire((0,c.stringFromCodePoint)(M)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),$||!this._activeBuffer.x){if(this._activeBuffer.x+$-1>=N){if(V){for(;this._activeBuffer.x<N;)O.setCellFromCodePoint(this._activeBuffer.x++,0,1,A.fg,A.bg,A.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=N-1,$===2)continue}if(x&&(O.insertCells(this._activeBuffer.x,$,this._activeBuffer.getNullCell(A),A),O.getWidth(N-1)===2&&O.setCellFromCodePoint(N-1,s.NULL_CELL_CODE,s.NULL_CELL_WIDTH,A.fg,A.bg,A.extended)),O.setCellFromCodePoint(this._activeBuffer.x++,M,$,A.fg,A.bg,A.extended),$>0)for(;--$;)O.setCellFromCodePoint(this._activeBuffer.x++,0,0,A.fg,A.bg,A.extended)}else O.getWidth(this._activeBuffer.x-1)?O.addCodepointToCell(this._activeBuffer.x-1,M):O.addCodepointToCell(this._activeBuffer.x-2,M)}R-E>0&&(O.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<N&&R-E>0&&O.getWidth(this._activeBuffer.x)===0&&!O.hasContent(this._activeBuffer.x)&&O.setCellFromCodePoint(this._activeBuffer.x,0,1,A.fg,A.bg,A.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(y,E){return y.final!=="t"||y.prefix||y.intermediates?this._parser.registerCsiHandler(y,E):this._parser.registerCsiHandler(y,R=>!D(R.params[0],this._optionsService.rawOptions.windowOptions)||E(R))}registerDcsHandler(y,E){return this._parser.registerDcsHandler(y,new S.DcsHandler(E))}registerEscHandler(y,E){return this._parser.registerEscHandler(y,E)}registerOscHandler(y,E){return this._parser.registerOscHandler(y,new g.OscHandler(E))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var y;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||y===void 0)&&y.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);E.hasWidth(this._activeBuffer.x)&&!E.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const y=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-y),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(y=this._bufferService.cols-1){this._activeBuffer.x=Math.min(y,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(y,E){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=y,this._activeBuffer.y=this._activeBuffer.scrollTop+E):(this._activeBuffer.x=y,this._activeBuffer.y=E),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(y,E){this._restrictCursor(),this._setCursor(this._activeBuffer.x+y,this._activeBuffer.y+E)}cursorUp(y){const E=this._activeBuffer.y-this._activeBuffer.scrollTop;return E>=0?this._moveCursor(0,-Math.min(E,y.params[0]||1)):this._moveCursor(0,-(y.params[0]||1)),!0}cursorDown(y){const E=this._activeBuffer.scrollBottom-this._activeBuffer.y;return E>=0?this._moveCursor(0,Math.min(E,y.params[0]||1)):this._moveCursor(0,y.params[0]||1),!0}cursorForward(y){return this._moveCursor(y.params[0]||1,0),!0}cursorBackward(y){return this._moveCursor(-(y.params[0]||1),0),!0}cursorNextLine(y){return this.cursorDown(y),this._activeBuffer.x=0,!0}cursorPrecedingLine(y){return this.cursorUp(y),this._activeBuffer.x=0,!0}cursorCharAbsolute(y){return this._setCursor((y.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(y){return this._setCursor(y.length>=2?(y.params[1]||1)-1:0,(y.params[0]||1)-1),!0}charPosAbsolute(y){return this._setCursor((y.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(y){return this._moveCursor(y.params[0]||1,0),!0}linePosAbsolute(y){return this._setCursor(this._activeBuffer.x,(y.params[0]||1)-1),!0}vPositionRelative(y){return this._moveCursor(0,y.params[0]||1),!0}hVPosition(y){return this.cursorPosition(y),!0}tabClear(y){const E=y.params[0];return E===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:E===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(y){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=y.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(y){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=y.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(y){const E=y.params[0];return E===1&&(this._curAttrData.bg|=536870912),E!==2&&E!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(y,E,R,M=!1,$=!1){const q=this._activeBuffer.lines.get(this._activeBuffer.ybase+y);q.replaceCells(E,R,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),$),M&&(q.isWrapped=!1)}_resetBufferLine(y,E=!1){const R=this._activeBuffer.lines.get(this._activeBuffer.ybase+y);R&&(R.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),E),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+y),R.isWrapped=!1)}eraseInDisplay(y,E=!1){let R;switch(this._restrictCursor(this._bufferService.cols),y.params[0]){case 0:for(R=this._activeBuffer.y,this._dirtyRowTracker.markDirty(R),this._eraseInBufferLine(R++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);R<this._bufferService.rows;R++)this._resetBufferLine(R,E);this._dirtyRowTracker.markDirty(R);break;case 1:for(R=this._activeBuffer.y,this._dirtyRowTracker.markDirty(R),this._eraseInBufferLine(R,0,this._activeBuffer.x+1,!0,E),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(R+1).isWrapped=!1);R--;)this._resetBufferLine(R,E);this._dirtyRowTracker.markDirty(0);break;case 2:for(R=this._bufferService.rows,this._dirtyRowTracker.markDirty(R-1);R--;)this._resetBufferLine(R,E);this._dirtyRowTracker.markDirty(0);break;case 3:const M=this._activeBuffer.lines.length-this._bufferService.rows;M>0&&(this._activeBuffer.lines.trimStart(M),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-M,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-M,0),this._onScroll.fire(0))}return!0}eraseInLine(y,E=!1){switch(this._restrictCursor(this._bufferService.cols),y.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,E);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,E)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(y){this._restrictCursor();let E=y.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const R=this._activeBuffer.ybase+this._activeBuffer.y,M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,$=this._bufferService.rows-1+this._activeBuffer.ybase-M+1;for(;E--;)this._activeBuffer.lines.splice($-1,1),this._activeBuffer.lines.splice(R,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(y){this._restrictCursor();let E=y.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const R=this._activeBuffer.ybase+this._activeBuffer.y;let M;for(M=this._bufferService.rows-1-this._activeBuffer.scrollBottom,M=this._bufferService.rows-1+this._activeBuffer.ybase-M;E--;)this._activeBuffer.lines.splice(R,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(y){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.insertCells(this._activeBuffer.x,y.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(y){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.deleteCells(this._activeBuffer.x,y.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(y){let E=y.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(y){let E=y.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(e.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=y.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);M.deleteCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=y.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);M.insertCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=y.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);M.insertCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=y.params[0]||1;for(let R=this._activeBuffer.scrollTop;R<=this._activeBuffer.scrollBottom;++R){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);M.deleteCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),M.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(y){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(y.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(y){if(!this._parser.precedingCodepoint)return!0;const E=y.params[0]||1,R=new Uint32Array(E);for(let M=0;M<E;++M)R[M]=this._parser.precedingCodepoint;return this.print(R,0,R.length),!0}sendDeviceAttributesPrimary(y){return y.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(h.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(h.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(y){return y.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(h.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(h.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(y.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(h.C0.ESC+"[>83;40003;0c")),!0}_is(y){return(this._optionsService.rawOptions.termName+"").indexOf(y)===0}setMode(y){for(let E=0;E<y.length;E++)switch(y.params[E]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(y){for(let E=0;E<y.length;E++)switch(y.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),this._charsetService.setgCharset(1,_.DEFAULT_CHARSET),this._charsetService.setgCharset(2,_.DEFAULT_CHARSET),this._charsetService.setgCharset(3,_.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(y){for(let E=0;E<y.length;E++)switch(y.params[E]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(y){for(let E=0;E<y.length;E++)switch(y.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),y.params[E]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(y,E){const R=this._coreService.decPrivateModes,{activeProtocol:M,activeEncoding:$}=this._coreMouseService,q=this._coreService,{buffers:G,cols:N}=this._bufferService,{active:V,alt:x}=G,A=this._optionsService.rawOptions,O=K=>K?1:2,F=y.params[0];return z=F,Y=E?F===2?4:F===4?O(q.modes.insertMode):F===12?3:F===20?O(A.convertEol):0:F===1?O(R.applicationCursorKeys):F===3?A.windowOptions.setWinLines?N===80?2:N===132?1:0:0:F===6?O(R.origin):F===7?O(R.wraparound):F===8?3:F===9?O(M==="X10"):F===12?O(A.cursorBlink):F===25?O(!q.isCursorHidden):F===45?O(R.reverseWraparound):F===66?O(R.applicationKeypad):F===67?4:F===1e3?O(M==="VT200"):F===1002?O(M==="DRAG"):F===1003?O(M==="ANY"):F===1004?O(R.sendFocus):F===1005?4:F===1006?O($==="SGR"):F===1015?4:F===1016?O($==="SGR_PIXELS"):F===1048?1:F===47||F===1047||F===1049?O(V===x):F===2004?O(R.bracketedPasteMode):0,q.triggerDataEvent(`${h.C0.ESC}[${E?"":"?"}${z};${Y}$y`),!0;var z,Y}_updateAttrColor(y,E,R,M,$){return E===2?(y|=50331648,y&=-16777216,y|=o.AttributeData.fromColorRGB([R,M,$])):E===5&&(y&=-50331904,y|=33554432|255&R),y}_extractColor(y,E,R){const M=[0,0,-1,0,0,0];let $=0,q=0;do{if(M[q+$]=y.params[E+q],y.hasSubParams(E+q)){const G=y.getSubParams(E+q);let N=0;do M[1]===5&&($=1),M[q+N+1+$]=G[N];while(++N<G.length&&N+q+1+$<M.length);break}if(M[1]===5&&q+$>=2||M[1]===2&&q+$>=5)break;M[1]&&($=1)}while(++q+E<y.length&&q+$<M.length);for(let G=2;G<M.length;++G)M[G]===-1&&(M[G]=0);switch(M[0]){case 38:R.fg=this._updateAttrColor(R.fg,M[1],M[3],M[4],M[5]);break;case 48:R.bg=this._updateAttrColor(R.bg,M[1],M[3],M[4],M[5]);break;case 58:R.extended=R.extended.clone(),R.extended.underlineColor=this._updateAttrColor(R.extended.underlineColor,M[1],M[3],M[4],M[5])}return q}_processUnderline(y,E){E.extended=E.extended.clone(),(!~y||y>5)&&(y=1),E.extended.underlineStyle=y,E.fg|=268435456,y===0&&(E.fg&=-268435457),E.updateExtended()}_processSGR0(y){y.fg=e.DEFAULT_ATTR_DATA.fg,y.bg=e.DEFAULT_ATTR_DATA.bg,y.extended=y.extended.clone(),y.extended.underlineStyle=0,y.extended.underlineColor&=-67108864,y.updateExtended()}charAttributes(y){if(y.length===1&&y.params[0]===0)return this._processSGR0(this._curAttrData),!0;const E=y.length;let R;const M=this._curAttrData;for(let $=0;$<E;$++)R=y.params[$],R>=30&&R<=37?(M.fg&=-50331904,M.fg|=16777216|R-30):R>=40&&R<=47?(M.bg&=-50331904,M.bg|=16777216|R-40):R>=90&&R<=97?(M.fg&=-50331904,M.fg|=16777224|R-90):R>=100&&R<=107?(M.bg&=-50331904,M.bg|=16777224|R-100):R===0?this._processSGR0(M):R===1?M.fg|=134217728:R===3?M.bg|=67108864:R===4?(M.fg|=268435456,this._processUnderline(y.hasSubParams($)?y.getSubParams($)[0]:1,M)):R===5?M.fg|=536870912:R===7?M.fg|=67108864:R===8?M.fg|=1073741824:R===9?M.fg|=2147483648:R===2?M.bg|=134217728:R===21?this._processUnderline(2,M):R===22?(M.fg&=-134217729,M.bg&=-134217729):R===23?M.bg&=-67108865:R===24?(M.fg&=-268435457,this._processUnderline(0,M)):R===25?M.fg&=-536870913:R===27?M.fg&=-67108865:R===28?M.fg&=-1073741825:R===29?M.fg&=2147483647:R===39?(M.fg&=-67108864,M.fg|=16777215&e.DEFAULT_ATTR_DATA.fg):R===49?(M.bg&=-67108864,M.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):R===38||R===48||R===58?$+=this._extractColor(y,$,M):R===53?M.bg|=1073741824:R===55?M.bg&=-1073741825:R===59?(M.extended=M.extended.clone(),M.extended.underlineColor=-1,M.updateExtended()):R===100?(M.fg&=-67108864,M.fg|=16777215&e.DEFAULT_ATTR_DATA.fg,M.bg&=-67108864,M.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",R);return!0}deviceStatus(y){switch(y.params[0]){case 5:this._coreService.triggerDataEvent(`${h.C0.ESC}[0n`);break;case 6:const E=this._activeBuffer.y+1,R=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[${E};${R}R`)}return!0}deviceStatusPrivate(y){if(y.params[0]===6){const E=this._activeBuffer.y+1,R=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[?${E};${R}R`)}return!0}softReset(y){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(y){const E=y.params[0]||1;switch(E){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const R=E%2==1;return this._optionsService.options.cursorBlink=R,!0}setScrollRegion(y){const E=y.params[0]||1;let R;return(y.length<2||(R=y.params[1])>this._bufferService.rows||R===0)&&(R=this._bufferService.rows),R>E&&(this._activeBuffer.scrollTop=E-1,this._activeBuffer.scrollBottom=R-1,this._setCursor(0,0)),!0}windowOptions(y){if(!D(y.params[0],this._optionsService.rawOptions.windowOptions))return!0;const E=y.length>1?y.params[1]:0;switch(y.params[0]){case 14:E!==2&&this._onRequestWindowsOptionsReport.fire(L.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(L.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${h.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:E!==0&&E!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),E!==0&&E!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:E!==0&&E!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),E!==0&&E!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(y){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(y){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(y){return this._windowTitle=y,this._onTitleChange.fire(y),!0}setIconName(y){return this._iconName=y,!0}setOrReportIndexedColor(y){const E=[],R=y.split(";");for(;R.length>1;){const M=R.shift(),$=R.shift();if(/^\d+$/.exec(M)){const q=parseInt(M);if(0<=q&&q<256)if($==="?")E.push({type:0,index:q});else{const G=(0,a.parseColor)($);G&&E.push({type:1,index:q,color:G})}}}return E.length&&this._onColor.fire(E),!0}setHyperlink(y){const E=y.split(";");return!(E.length<2)&&(E[1]?this._createHyperlink(E[0],E[1]):!E[0]&&this._finishHyperlink())}_createHyperlink(y,E){this._getCurrentLinkId()&&this._finishHyperlink();const R=y.split(":");let M;const $=R.findIndex(q=>q.startsWith("id="));return $!==-1&&(M=R[$].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:M,uri:E}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(y,E){const R=y.split(";");for(let M=0;M<R.length&&!(E>=this._specialColors.length);++M,++E)if(R[M]==="?")this._onColor.fire([{type:0,index:this._specialColors[E]}]);else{const $=(0,a.parseColor)(R[M]);$&&this._onColor.fire([{type:1,index:this._specialColors[E],color:$}])}return!0}setOrReportFgColor(y){return this._setOrReportSpecialColor(y,0)}setOrReportBgColor(y){return this._setOrReportSpecialColor(y,1)}setOrReportCursorColor(y){return this._setOrReportSpecialColor(y,2)}restoreIndexedColor(y){if(!y)return this._onColor.fire([{type:2}]),!0;const E=[],R=y.split(";");for(let M=0;M<R.length;++M)if(/^\d+$/.exec(R[M])){const $=parseInt(R[M]);0<=$&&$<256&&E.push({type:2,index:$})}return E.length&&this._onColor.fire(E),!0}restoreFgColor(y){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(y){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(y){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,_.DEFAULT_CHARSET),!0}selectCharset(y){return y.length!==2?(this.selectDefaultCharset(),!0):(y[0]==="/"||this._charsetService.setgCharset(C[y[0]],_.CHARSETS[y[1]]||_.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const y=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,y,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(y){return this._charsetService.setgLevel(y),!0}screenAlignmentPattern(){const y=new i.CellData;y.content=4194304|"E".charCodeAt(0),y.fg=this._curAttrData.fg,y.bg=this._curAttrData.bg,this._setCursor(0,0);for(let E=0;E<this._bufferService.rows;++E){const R=this._activeBuffer.ybase+this._activeBuffer.y+E,M=this._activeBuffer.lines.get(R);M&&(M.fill(y),M.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(y,E){const R=this._bufferService.buffer,M=this._optionsService.rawOptions;return($=>(this._coreService.triggerDataEvent(`${h.C0.ESC}${$}${h.C0.ESC}\\`),!0))(y==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:y==='"p'?'P1$r61;1"p':y==="r"?`P1$r${R.scrollTop+1};${R.scrollBottom+1}r`:y==="m"?"P1$r0m":y===" q"?`P1$r${{block:2,underline:4,bar:6}[M.cursorStyle]-(M.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(y,E){this._dirtyRowTracker.markRangeDirty(y,E)}}t.InputHandler=W;let j=class{constructor(U){this._bufferService=U,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(U){U<this.start?this.start=U:U>this.end&&(this.end=U)}markRangeDirty(U,y){U>y&&(P=U,U=y,y=P),U<this.start&&(this.start=U),y>this.end&&(this.end=y)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};j=l([v(0,d.IBufferService)],j)},844:(B,t)=>{function n(l){for(const v of l)v.dispose();l.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const v=this._disposables.indexOf(l);v!==-1&&this._disposables.splice(v,1)}},t.toDisposable=function(l){return{dispose:l}},t.disposeArray=n,t.getDisposeArrayDisposable=function(l){return{dispose:()=>n(l)}}},1505:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(v,h,_){this._data[v]||(this._data[v]={}),this._data[v][h]=_}get(v,h){return this._data[v]?this._data[v][h]:void 0}clear(){this._data={}}}t.TwoKeyMap=n,t.FourKeyMap=class{constructor(){this._data=new n}set(l,v,h,_,m){this._data.get(l,v)||this._data.set(l,v,new n),this._data.get(l,v).set(h,_,m)}get(l,v,h,_){var m;return(m=this._data.get(l,v))===null||m===void 0?void 0:m.get(h,_)}clear(){this._data.clear()}}},6114:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof navigator>"u";const n=t.isNode?"node":navigator.userAgent,l=t.isNode?"node":navigator.platform;t.isFirefox=n.includes("Firefox"),t.isLegacyEdge=n.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(n),t.getSafariVersion=function(){if(!t.isSafari)return 0;const v=n.match(/Version\/(\d+)/);return v===null||v.length<2?0:parseInt(v[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),t.isIpad=l==="iPad",t.isIphone=l==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),t.isLinux=l.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(n)},6106:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let n=0;t.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){this._array.length!==0?(n=this._search(this._getKey(l),0,this._array.length-1),this._array.splice(n,0,l)):this._array.push(l)}delete(l){if(this._array.length===0)return!1;const v=this._getKey(l);if(v===void 0||(n=this._search(v,0,this._array.length-1),n===-1)||this._getKey(this._array[n])!==v)return!1;do if(this._array[n]===l)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===v);return!1}*getKeyIterator(l){if(this._array.length!==0&&(n=this._search(l,0,this._array.length-1),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===l)}forEachByKey(l,v){if(this._array.length!==0&&(n=this._search(l,0,this._array.length-1),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===l))do v(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===l)}values(){return this._array.values()}_search(l,v,h){if(h<v)return v;let _=Math.floor((v+h)/2);const m=this._getKey(this._array[_]);if(m>l)return this._search(l,v,_-1);if(m<l)return this._search(l,_+1,h);for(;_>0&&this._getKey(this._array[_-1])===l;)_--;return _}}},7226:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const l=n(6114);class v{constructor(){this._tasks=[],this._i=0}enqueue(m){this._tasks.push(m),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(m){this._idleCallback=void 0;let p=0,c=0,e=m.timeRemaining(),r=0;for(;this._i<this._tasks.length;){if(p=Date.now(),this._tasks[this._i]()||this._i++,p=Math.max(1,Date.now()-p),c=Math.max(p,c),r=m.timeRemaining(),1.5*c>r)return e-p<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-p))}ms`),void this._start();e=r}this.clear()}}class h extends v{_requestCallback(m){return setTimeout(()=>m(this._createDeadline(16)))}_cancelCallback(m){clearTimeout(m)}_createDeadline(m){const p=Date.now()+m;return{timeRemaining:()=>Math.max(0,p-Date.now())}}}t.PriorityTaskQueue=h,t.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends v{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:h,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},9282:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const l=n(643);t.updateWindowsModeWrappedState=function(v){const h=v.buffer.lines.get(v.buffer.ybase+v.buffer.y-1),_=h==null?void 0:h.get(v.cols-1),m=v.buffer.lines.get(v.buffer.ybase+v.buffer.y);m&&_&&(m.isWrapped=_[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&_[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(h){return[h>>>16&255,h>>>8&255,255&h]}static fromColorRGB(h){return(255&h[0])<<16|(255&h[1])<<8|255&h[2]}clone(){const h=new n;return h.fg=this.fg,h.bg=this.bg,h.extended=this.extended.clone(),h}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}t.AttributeData=n;class l{constructor(h=0,_=0){this._ext=0,this._urlId=0,this._ext=h,this._urlId=_}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(h){this._ext=h}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(h){this._ext&=-469762049,this._ext|=h<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(h){this._ext&=-67108864,this._ext|=67108863&h}get urlId(){return this._urlId}set urlId(h){this._urlId=h}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=l},9092:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;const l=n(6349),v=n(8437),h=n(511),_=n(643),m=n(4634),p=n(4863),c=n(7116),e=n(3734),r=n(7226);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(s,i,o){this._hasScrollback=s,this._optionsService=i,this._bufferService=o,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=c.DEFAULT_CHARSET,this.markers=[],this._nullCell=h.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=h.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new r.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(s){return s?(this._nullCell.fg=s.fg,this._nullCell.bg=s.bg,this._nullCell.extended=s.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new e.ExtendedAttrs),this._nullCell}getWhitespaceCell(s){return s?(this._whitespaceCell.fg=s.fg,this._whitespaceCell.bg=s.bg,this._whitespaceCell.extended=s.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new e.ExtendedAttrs),this._whitespaceCell}getBlankLine(s,i){return new v.BufferLine(this._bufferService.cols,this.getNullCell(s),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const s=this.ybase+this.y-this.ydisp;return s>=0&&s<this._rows}_getCorrectBufferLength(s){if(!this._hasScrollback)return s;const i=s+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i}fillViewportRows(s){if(this.lines.length===0){s===void 0&&(s=v.DEFAULT_ATTR_DATA);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(s))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(s,i){const o=this.getNullCell(v.DEFAULT_ATTR_DATA);let d=0;const g=this._getCorrectBufferLength(i);if(g>this.lines.maxLength&&(this.lines.maxLength=g),this.lines.length>0){if(this._cols<s)for(let a=0;a<this.lines.length;a++)d+=+this.lines.get(a).resize(s,o);let S=0;if(this._rows<i)for(let a=this._rows;a<i;a++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new v.BufferLine(s,o)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(s,o)));else for(let a=this._rows;a>i;a--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(g<this.lines.maxLength){const a=this.lines.length-g;a>0&&(this.lines.trimStart(a),this.ybase=Math.max(this.ybase-a,0),this.ydisp=Math.max(this.ydisp-a,0),this.savedY=Math.max(this.savedY-a,0)),this.lines.maxLength=g}this.x=Math.min(this.x,s-1),this.y=Math.min(this.y,i-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,s-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(s,i),this._cols>s))for(let S=0;S<this.lines.length;S++)d+=+this.lines.get(S).resize(s,o);this._cols=s,this._rows=i,this._memoryCleanupQueue.clear(),d>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let s=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,s=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return s}get _isReflowEnabled(){const s=this._optionsService.rawOptions.windowsPty;return s&&s.buildNumber?this._hasScrollback&&s.backend==="conpty"&&s.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(s,i){this._cols!==s&&(s>this._cols?this._reflowLarger(s,i):this._reflowSmaller(s,i))}_reflowLarger(s,i){const o=(0,m.reflowLargerGetLinesToRemove)(this.lines,this._cols,s,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(o.length>0){const d=(0,m.reflowLargerCreateNewLayout)(this.lines,o);(0,m.reflowLargerApplyNewLayout)(this.lines,d.layout),this._reflowLargerAdjustViewport(s,i,d.countRemoved)}}_reflowLargerAdjustViewport(s,i,o){const d=this.getNullCell(v.DEFAULT_ATTR_DATA);let g=o;for(;g-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new v.BufferLine(s,d))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-o,0)}_reflowSmaller(s,i){const o=this.getNullCell(v.DEFAULT_ATTR_DATA),d=[];let g=0;for(let S=this.lines.length-1;S>=0;S--){let a=this.lines.get(S);if(!a||!a.isWrapped&&a.getTrimmedLength()<=s)continue;const C=[a];for(;a.isWrapped&&S>0;)a=this.lines.get(--S),C.unshift(a);const w=this.ybase+this.y;if(w>=S&&w<S+C.length)continue;const D=C[C.length-1].getTrimmedLength(),L=(0,m.reflowSmallerGetNewLineLengths)(C,this._cols,s),P=L.length-C.length;let W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const j=[];for(let $=0;$<P;$++){const q=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);j.push(q)}j.length>0&&(d.push({start:S+C.length+g,newLines:j}),g+=j.length),C.push(...j);let U=L.length-1,y=L[U];y===0&&(U--,y=L[U]);let E=C.length-P-1,R=D;for(;E>=0;){const $=Math.min(R,y);if(C[U]===void 0)break;if(C[U].copyCellsFrom(C[E],R-$,y-$,$,!0),y-=$,y===0&&(U--,y=L[U]),R-=$,R===0){E--;const q=Math.max(E,0);R=(0,m.getWrappedLineTrimmedLength)(C,q,this._cols)}}for(let $=0;$<C.length;$++)L[$]<s&&C[$].setCell(L[$],o);let M=P-W;for(;M-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+g)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+i-1)}if(d.length>0){const S=[],a=[];for(let U=0;U<this.lines.length;U++)a.push(this.lines.get(U));const C=this.lines.length;let w=C-1,D=0,L=d[D];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+g);let P=0;for(let U=Math.min(this.lines.maxLength-1,C+g-1);U>=0;U--)if(L&&L.start>w+P){for(let y=L.newLines.length-1;y>=0;y--)this.lines.set(U--,L.newLines[y]);U++,S.push({index:w+1,amount:L.newLines.length}),P+=L.newLines.length,L=d[++D]}else this.lines.set(U,a[w--]);let W=0;for(let U=S.length-1;U>=0;U--)S[U].index+=W,this.lines.onInsertEmitter.fire(S[U]),W+=S[U].amount;const j=Math.max(0,C+g-this.lines.maxLength);j>0&&this.lines.onTrimEmitter.fire(j)}}translateBufferLineToString(s,i,o=0,d){const g=this.lines.get(s);return g?g.translateToString(i,o,d):""}getWrappedRangeForLine(s){let i=s,o=s;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;o+1<this.lines.length&&this.lines.get(o+1).isWrapped;)o++;return{first:i,last:o}}setupTabStops(s){for(s!=null?this.tabs[s]||(s=this.prevStop(s)):(this.tabs={},s=0);s<this._cols;s+=this._optionsService.rawOptions.tabStopWidth)this.tabs[s]=!0}prevStop(s){for(s==null&&(s=this.x);!this.tabs[--s]&&s>0;);return s>=this._cols?this._cols-1:s<0?0:s}nextStop(s){for(s==null&&(s=this.x);!this.tabs[++s]&&s<this._cols;);return s>=this._cols?this._cols-1:s<0?0:s}clearMarkers(s){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===s&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].dispose(),this.markers.splice(s--,1);this._isClearing=!1}addMarker(s){const i=new p.Marker(s);return this.markers.push(i),i.register(this.lines.onTrim(o=>{i.line-=o,i.line<0&&i.dispose()})),i.register(this.lines.onInsert(o=>{i.line>=o.index&&(i.line+=o.amount)})),i.register(this.lines.onDelete(o=>{i.line>=o.index&&i.line<o.index+o.amount&&i.dispose(),i.line>o.index&&(i.line-=o.amount)})),i.register(i.onDispose(()=>this._removeMarker(i))),i}_removeMarker(s){this._isClearing||this.markers.splice(this.markers.indexOf(s),1)}}},8437:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const l=n(482),v=n(643),h=n(511),_=n(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new _.AttributeData);let m=0;class p{constructor(e,r,s=!1){this.isWrapped=s,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const i=r||h.CellData.fromCharData([0,v.NULL_CELL_CHAR,v.NULL_CELL_WIDTH,v.NULL_CELL_CODE]);for(let o=0;o<e;++o)this.setCell(o,i);this.length=e}get(e){const r=this._data[3*e+0],s=2097151&r;return[this._data[3*e+1],2097152&r?this._combined[e]:s?(0,l.stringFromCodePoint)(s):"",r>>22,2097152&r?this._combined[e].charCodeAt(this._combined[e].length-1):s]}set(e,r){this._data[3*e+1]=r[v.CHAR_DATA_ATTR_INDEX],r[v.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=r[1],this._data[3*e+0]=2097152|e|r[v.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=r[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|r[v.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const r=this._data[3*e+0];return 2097152&r?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&r}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const r=this._data[3*e+0];return 2097152&r?this._combined[e]:2097151&r?(0,l.stringFromCodePoint)(2097151&r):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,r){return m=3*e,r.content=this._data[m+0],r.fg=this._data[m+1],r.bg=this._data[m+2],2097152&r.content&&(r.combinedData=this._combined[e]),268435456&r.bg&&(r.extended=this._extendedAttrs[e]),r}setCell(e,r){2097152&r.content&&(this._combined[e]=r.combinedData),268435456&r.bg&&(this._extendedAttrs[e]=r.extended),this._data[3*e+0]=r.content,this._data[3*e+1]=r.fg,this._data[3*e+2]=r.bg}setCellFromCodePoint(e,r,s,i,o,d){268435456&o&&(this._extendedAttrs[e]=d),this._data[3*e+0]=r|s<<22,this._data[3*e+1]=i,this._data[3*e+2]=o}addCodepointToCell(e,r){let s=this._data[3*e+0];2097152&s?this._combined[e]+=(0,l.stringFromCodePoint)(r):(2097151&s?(this._combined[e]=(0,l.stringFromCodePoint)(2097151&s)+(0,l.stringFromCodePoint)(r),s&=-2097152,s|=2097152):s=r|4194304,this._data[3*e+0]=s)}insertCells(e,r,s,i){if((e%=this.length)&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs),r<this.length-e){const o=new h.CellData;for(let d=this.length-e-r-1;d>=0;--d)this.setCell(e+r+d,this.loadCell(e+d,o));for(let d=0;d<r;++d)this.setCell(e+d,s)}else for(let o=e;o<this.length;++o)this.setCell(o,s);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs)}deleteCells(e,r,s,i){if(e%=this.length,r<this.length-e){const o=new h.CellData;for(let d=0;d<this.length-e-r;++d)this.setCell(e+d,this.loadCell(e+r+d,o));for(let d=this.length-r;d<this.length;++d)this.setCell(d,s)}else for(let o=e;o<this.length;++o)this.setCell(o,s);e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs),this.getWidth(e)!==0||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs)}replaceCells(e,r,s,i,o=!1){if(o)for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs),r<this.length&&this.getWidth(r-1)===2&&!this.isProtected(r)&&this.setCellFromCodePoint(r,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs);e<r&&e<this.length;)this.isProtected(e)||this.setCell(e,s),e++;else for(e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs),r<this.length&&this.getWidth(r-1)===2&&this.setCellFromCodePoint(r,0,1,(i==null?void 0:i.fg)||0,(i==null?void 0:i.bg)||0,(i==null?void 0:i.extended)||new _.ExtendedAttrs);e<r&&e<this.length;)this.setCell(e++,s)}resize(e,r){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const s=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*s)this._data=new Uint32Array(this._data.buffer,0,s);else{const i=new Uint32Array(s);i.set(this._data),this._data=i}for(let i=this.length;i<e;++i)this.setCell(i,r)}else{this._data=this._data.subarray(0,s);const i=Object.keys(this._combined);for(let d=0;d<i.length;d++){const g=parseInt(i[d],10);g>=e&&delete this._combined[g]}const o=Object.keys(this._extendedAttrs);for(let d=0;d<o.length;d++){const g=parseInt(o[d],10);g>=e&&delete this._extendedAttrs[g]}}return this.length=e,4*s*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,r=!1){if(r)for(let s=0;s<this.length;++s)this.isProtected(s)||this.setCell(s,e);else{this._combined={},this._extendedAttrs={};for(let s=0;s<this.length;++s)this.setCell(s,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const r in e._combined)this._combined[r]=e._combined[r];this._extendedAttrs={};for(const r in e._extendedAttrs)this._extendedAttrs[r]=e._extendedAttrs[r];this.isWrapped=e.isWrapped}clone(){const e=new p(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const r in this._combined)e._combined[r]=this._combined[r];for(const r in this._extendedAttrs)e._extendedAttrs[r]=this._extendedAttrs[r];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,r,s,i,o){const d=e._data;if(o)for(let S=i-1;S>=0;S--){for(let a=0;a<3;a++)this._data[3*(s+S)+a]=d[3*(r+S)+a];268435456&d[3*(r+S)+2]&&(this._extendedAttrs[s+S]=e._extendedAttrs[r+S])}else for(let S=0;S<i;S++){for(let a=0;a<3;a++)this._data[3*(s+S)+a]=d[3*(r+S)+a];268435456&d[3*(r+S)+2]&&(this._extendedAttrs[s+S]=e._extendedAttrs[r+S])}const g=Object.keys(e._combined);for(let S=0;S<g.length;S++){const a=parseInt(g[S],10);a>=r&&(this._combined[a-r+s]=e._combined[a])}}translateToString(e=!1,r=0,s=this.length){e&&(s=Math.min(s,this.getTrimmedLength()));let i="";for(;r<s;){const o=this._data[3*r+0],d=2097151&o;i+=2097152&o?this._combined[r]:d?(0,l.stringFromCodePoint)(d):v.WHITESPACE_CELL_CHAR,r+=o>>22||1}return i}}t.BufferLine=p},4841:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(n,l){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return l*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(B,t)=>{function n(l,v,h){if(v===l.length-1)return l[v].getTrimmedLength();const _=!l[v].hasContent(h-1)&&l[v].getWidth(h-1)===1,m=l[v+1].getWidth(0)===2;return _&&m?h-1:h}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(l,v,h,_,m){const p=[];for(let c=0;c<l.length-1;c++){let e=c,r=l.get(++e);if(!r.isWrapped)continue;const s=[l.get(c)];for(;e<l.length&&r.isWrapped;)s.push(r),r=l.get(++e);if(_>=c&&_<e){c+=s.length-1;continue}let i=0,o=n(s,i,v),d=1,g=0;for(;d<s.length;){const a=n(s,d,v),C=a-g,w=h-o,D=Math.min(C,w);s[i].copyCellsFrom(s[d],g,o,D,!1),o+=D,o===h&&(i++,o=0),g+=D,g===a&&(d++,g=0),o===0&&i!==0&&s[i-1].getWidth(h-1)===2&&(s[i].copyCellsFrom(s[i-1],h-1,o++,1,!1),s[i-1].setCell(h-1,m))}s[i].replaceCells(o,h,m);let S=0;for(let a=s.length-1;a>0&&(a>i||s[a].getTrimmedLength()===0);a--)S++;S>0&&(p.push(c+s.length-S),p.push(S)),c+=s.length-1}return p},t.reflowLargerCreateNewLayout=function(l,v){const h=[];let _=0,m=v[_],p=0;for(let c=0;c<l.length;c++)if(m===c){const e=v[++_];l.onDeleteEmitter.fire({index:c-p,amount:e}),c+=e-1,p+=e,m=v[++_]}else h.push(c);return{layout:h,countRemoved:p}},t.reflowLargerApplyNewLayout=function(l,v){const h=[];for(let _=0;_<v.length;_++)h.push(l.get(v[_]));for(let _=0;_<h.length;_++)l.set(_,h[_]);l.length=v.length},t.reflowSmallerGetNewLineLengths=function(l,v,h){const _=[],m=l.map((r,s)=>n(l,s,v)).reduce((r,s)=>r+s);let p=0,c=0,e=0;for(;e<m;){if(m-e<h){_.push(m-e);break}p+=h;const r=n(l,c,v);p>r&&(p-=r,c++);const s=l[c].getWidth(p-1)===2;s&&p--;const i=s?h-1:h;_.push(i),e+=i}return _},t.getWrappedLineTrimmedLength=n},5295:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const l=n(9092),v=n(8460),h=n(844);class _ extends h.Disposable{constructor(p,c){super(),this._optionsService=p,this._bufferService=c,this._onBufferActivate=this.register(new v.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new l.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new l.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(p){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(p),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(p,c){this._normal.resize(p,c),this._alt.resize(p,c),this.setupTabStops(p)}setupTabStops(p){this._normal.setupTabStops(p),this._alt.setupTabStops(p)}}t.BufferSet=_},511:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const l=n(482),v=n(643),h=n(3734);class _ extends h.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new h.ExtendedAttrs,this.combinedData=""}static fromCharData(p){const c=new _;return c.setFromCharData(p),c}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(p){this.fg=p[v.CHAR_DATA_ATTR_INDEX],this.bg=0;let c=!1;if(p[v.CHAR_DATA_CHAR_INDEX].length>2)c=!0;else if(p[v.CHAR_DATA_CHAR_INDEX].length===2){const e=p[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){const r=p[v.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(e-55296)+r-56320+65536|p[v.CHAR_DATA_WIDTH_INDEX]<<22:c=!0}else c=!0}else this.content=p[v.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[v.CHAR_DATA_WIDTH_INDEX]<<22;c&&(this.combinedData=p[v.CHAR_DATA_CHAR_INDEX],this.content=2097152|p[v.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=_},643:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const l=n(8460),v=n(844);class h{constructor(m){this.line=m,this.isDisposed=!1,this._disposables=[],this._id=h._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,v.disposeArray)(this._disposables),this._disposables.length=0)}register(m){return this._disposables.push(m),m}}t.Marker=h,h._nextId=1},7116:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},t.CHARSETS.A={"#":""},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},t.CHARSETS.C=t.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},t.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},t.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.E=t.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},t.CHARSETS.H=t.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},t.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(B,t)=>{var n,l;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(v){v.NUL="\0",v.SOH="",v.STX="",v.ETX="",v.EOT="",v.ENQ="",v.ACK="",v.BEL="\x07",v.BS="\b",v.HT="	",v.LF=`
`,v.VT="\v",v.FF="\f",v.CR="\r",v.SO="",v.SI="",v.DLE="",v.DC1="",v.DC2="",v.DC3="",v.DC4="",v.NAK="",v.SYN="",v.ETB="",v.CAN="",v.EM="",v.SUB="",v.ESC="\x1B",v.FS="",v.GS="",v.RS="",v.US="",v.SP=" ",v.DEL=""}(n=t.C0||(t.C0={})),(l=t.C1||(t.C1={})).PAD="",l.HOP="",l.BPH="",l.NBH="",l.IND="",l.NEL="",l.SSA="",l.ESA="",l.HTS="",l.HTJ="",l.VTS="",l.PLD="",l.PLU="",l.RI="",l.SS2="",l.SS3="",l.DCS="",l.PU1="",l.PU2="",l.STS="",l.CCH="",l.MW="",l.SPA="",l.EPA="",l.SOS="",l.SGCI="",l.SCI="",l.CSI="",l.ST="",l.OSC="",l.PM="",l.APC="",(t.C1_ESCAPED||(t.C1_ESCAPED={})).ST=`${n.ESC}\\`},7399:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const l=n(2584),v={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(h,_,m,p){const c={type:0,cancel:!1,key:void 0},e=(h.shiftKey?1:0)|(h.altKey?2:0)|(h.ctrlKey?4:0)|(h.metaKey?8:0);switch(h.keyCode){case 0:h.key==="UIKeyInputUpArrow"?c.key=_?l.C0.ESC+"OA":l.C0.ESC+"[A":h.key==="UIKeyInputLeftArrow"?c.key=_?l.C0.ESC+"OD":l.C0.ESC+"[D":h.key==="UIKeyInputRightArrow"?c.key=_?l.C0.ESC+"OC":l.C0.ESC+"[C":h.key==="UIKeyInputDownArrow"&&(c.key=_?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:if(h.altKey){c.key=l.C0.ESC+l.C0.DEL;break}c.key=l.C0.DEL;break;case 9:if(h.shiftKey){c.key=l.C0.ESC+"[Z";break}c.key=l.C0.HT,c.cancel=!0;break;case 13:c.key=h.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,c.cancel=!0;break;case 27:c.key=l.C0.ESC,h.altKey&&(c.key=l.C0.ESC+l.C0.ESC),c.cancel=!0;break;case 37:if(h.metaKey)break;e?(c.key=l.C0.ESC+"[1;"+(e+1)+"D",c.key===l.C0.ESC+"[1;3D"&&(c.key=l.C0.ESC+(m?"b":"[1;5D"))):c.key=_?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(h.metaKey)break;e?(c.key=l.C0.ESC+"[1;"+(e+1)+"C",c.key===l.C0.ESC+"[1;3C"&&(c.key=l.C0.ESC+(m?"f":"[1;5C"))):c.key=_?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(h.metaKey)break;e?(c.key=l.C0.ESC+"[1;"+(e+1)+"A",m||c.key!==l.C0.ESC+"[1;3A"||(c.key=l.C0.ESC+"[1;5A")):c.key=_?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(h.metaKey)break;e?(c.key=l.C0.ESC+"[1;"+(e+1)+"B",m||c.key!==l.C0.ESC+"[1;3B"||(c.key=l.C0.ESC+"[1;5B")):c.key=_?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:h.shiftKey||h.ctrlKey||(c.key=l.C0.ESC+"[2~");break;case 46:c.key=e?l.C0.ESC+"[3;"+(e+1)+"~":l.C0.ESC+"[3~";break;case 36:c.key=e?l.C0.ESC+"[1;"+(e+1)+"H":_?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:c.key=e?l.C0.ESC+"[1;"+(e+1)+"F":_?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:h.shiftKey?c.type=2:h.ctrlKey?c.key=l.C0.ESC+"[5;"+(e+1)+"~":c.key=l.C0.ESC+"[5~";break;case 34:h.shiftKey?c.type=3:h.ctrlKey?c.key=l.C0.ESC+"[6;"+(e+1)+"~":c.key=l.C0.ESC+"[6~";break;case 112:c.key=e?l.C0.ESC+"[1;"+(e+1)+"P":l.C0.ESC+"OP";break;case 113:c.key=e?l.C0.ESC+"[1;"+(e+1)+"Q":l.C0.ESC+"OQ";break;case 114:c.key=e?l.C0.ESC+"[1;"+(e+1)+"R":l.C0.ESC+"OR";break;case 115:c.key=e?l.C0.ESC+"[1;"+(e+1)+"S":l.C0.ESC+"OS";break;case 116:c.key=e?l.C0.ESC+"[15;"+(e+1)+"~":l.C0.ESC+"[15~";break;case 117:c.key=e?l.C0.ESC+"[17;"+(e+1)+"~":l.C0.ESC+"[17~";break;case 118:c.key=e?l.C0.ESC+"[18;"+(e+1)+"~":l.C0.ESC+"[18~";break;case 119:c.key=e?l.C0.ESC+"[19;"+(e+1)+"~":l.C0.ESC+"[19~";break;case 120:c.key=e?l.C0.ESC+"[20;"+(e+1)+"~":l.C0.ESC+"[20~";break;case 121:c.key=e?l.C0.ESC+"[21;"+(e+1)+"~":l.C0.ESC+"[21~";break;case 122:c.key=e?l.C0.ESC+"[23;"+(e+1)+"~":l.C0.ESC+"[23~";break;case 123:c.key=e?l.C0.ESC+"[24;"+(e+1)+"~":l.C0.ESC+"[24~";break;default:if(!h.ctrlKey||h.shiftKey||h.altKey||h.metaKey)if(m&&!p||!h.altKey||h.metaKey)!m||h.altKey||h.ctrlKey||h.shiftKey||!h.metaKey?h.key&&!h.ctrlKey&&!h.altKey&&!h.metaKey&&h.keyCode>=48&&h.key.length===1?c.key=h.key:h.key&&h.ctrlKey&&(h.key==="_"&&(c.key=l.C0.US),h.key==="@"&&(c.key=l.C0.NUL)):h.keyCode===65&&(c.type=1);else{const r=v[h.keyCode],s=r==null?void 0:r[h.shiftKey?1:0];if(s)c.key=l.C0.ESC+s;else if(h.keyCode>=65&&h.keyCode<=90){const i=h.ctrlKey?h.keyCode-64:h.keyCode+32;let o=String.fromCharCode(i);h.shiftKey&&(o=o.toUpperCase()),c.key=l.C0.ESC+o}else if(h.keyCode===32)c.key=l.C0.ESC+(h.ctrlKey?l.C0.NUL:" ");else if(h.key==="Dead"&&h.code.startsWith("Key")){let i=h.code.slice(3,4);h.shiftKey||(i=i.toLowerCase()),c.key=l.C0.ESC+i,c.cancel=!0}}else h.keyCode>=65&&h.keyCode<=90?c.key=String.fromCharCode(h.keyCode-64):h.keyCode===32?c.key=l.C0.NUL:h.keyCode>=51&&h.keyCode<=55?c.key=String.fromCharCode(h.keyCode-51+27):h.keyCode===56?c.key=l.C0.DEL:h.keyCode===219?c.key=l.C0.ESC:h.keyCode===220?c.key=l.C0.FS:h.keyCode===221&&(c.key=l.C0.GS)}return c}},482:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},t.utf32ToString=function(n,l=0,v=n.length){let h="";for(let _=l;_<v;++_){let m=n[_];m>65535?(m-=65536,h+=String.fromCharCode(55296+(m>>10))+String.fromCharCode(m%1024+56320)):h+=String.fromCharCode(m)}return h},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,l){const v=n.length;if(!v)return 0;let h=0,_=0;if(this._interim){const m=n.charCodeAt(_++);56320<=m&&m<=57343?l[h++]=1024*(this._interim-55296)+m-56320+65536:(l[h++]=this._interim,l[h++]=m),this._interim=0}for(let m=_;m<v;++m){const p=n.charCodeAt(m);if(55296<=p&&p<=56319){if(++m>=v)return this._interim=p,h;const c=n.charCodeAt(m);56320<=c&&c<=57343?l[h++]=1024*(p-55296)+c-56320+65536:(l[h++]=p,l[h++]=c)}else p!==65279&&(l[h++]=p)}return h}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,l){const v=n.length;if(!v)return 0;let h,_,m,p,c=0,e=0,r=0;if(this.interim[0]){let o=!1,d=this.interim[0];d&=(224&d)==192?31:(240&d)==224?15:7;let g,S=0;for(;(g=63&this.interim[++S])&&S<4;)d<<=6,d|=g;const a=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=a-S;for(;r<C;){if(r>=v)return 0;if(g=n[r++],(192&g)!=128){r--,o=!0;break}this.interim[S++]=g,d<<=6,d|=63&g}o||(a===2?d<128?r--:l[c++]=d:a===3?d<2048||d>=55296&&d<=57343||d===65279||(l[c++]=d):d<65536||d>1114111||(l[c++]=d)),this.interim.fill(0)}const s=v-4;let i=r;for(;i<v;){for(;!(!(i<s)||128&(h=n[i])||128&(_=n[i+1])||128&(m=n[i+2])||128&(p=n[i+3]));)l[c++]=h,l[c++]=_,l[c++]=m,l[c++]=p,i+=4;if(h=n[i++],h<128)l[c++]=h;else if((224&h)==192){if(i>=v)return this.interim[0]=h,c;if(_=n[i++],(192&_)!=128){i--;continue}if(e=(31&h)<<6|63&_,e<128){i--;continue}l[c++]=e}else if((240&h)==224){if(i>=v)return this.interim[0]=h,c;if(_=n[i++],(192&_)!=128){i--;continue}if(i>=v)return this.interim[0]=h,this.interim[1]=_,c;if(m=n[i++],(192&m)!=128){i--;continue}if(e=(15&h)<<12|(63&_)<<6|63&m,e<2048||e>=55296&&e<=57343||e===65279)continue;l[c++]=e}else if((248&h)==240){if(i>=v)return this.interim[0]=h,c;if(_=n[i++],(192&_)!=128){i--;continue}if(i>=v)return this.interim[0]=h,this.interim[1]=_,c;if(m=n[i++],(192&m)!=128){i--;continue}if(i>=v)return this.interim[0]=h,this.interim[1]=_,this.interim[2]=m,c;if(p=n[i++],(192&p)!=128){i--;continue}if(e=(7&h)<<18|(63&_)<<12|(63&m)<<6|63&p,e<65536||e>1114111)continue;l[c++]=e}}return c}}},225:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],l=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;t.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let h=0;h<n.length;++h)v.fill(0,n[h][0],n[h][1]+1)}}wcwidth(h){return h<32?0:h<127?1:h<65536?v[h]:function(_,m){let p,c=0,e=m.length-1;if(_<m[0][0]||_>m[e][1])return!1;for(;e>=c;)if(p=c+e>>1,_>m[p][1])c=p+1;else{if(!(_<m[p][0]))return!0;e=p-1}return!1}(h,l)?0:h>=131072&&h<=196605||h>=196608&&h<=262141?2:1}}},5981:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const l=n(8460),v=n(844);class h extends v.Disposable{constructor(m){super(),this._action=m,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(m,p){if(p!==void 0&&this._syncCalls>p)return void(this._syncCalls=0);if(this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let c;for(this._isSyncWriting=!0;c=this._writeBuffer.shift();){this._action(c);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(m,p){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(p),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=m.length,this._writeBuffer.push(m),this._callbacks.push(p)}_innerWrite(m=0,p=!0){const c=m||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],r=this._action(e,p);if(r){const i=o=>Date.now()-c>=12?setTimeout(()=>this._innerWrite(0,o)):this._innerWrite(c,o);return void r.catch(o=>(queueMicrotask(()=>{throw o}),Promise.resolve(!1))).then(i)}const s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-c>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=h},5941:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function v(h,_){const m=h.toString(16),p=m.length<2?"0"+m:m;switch(_){case 4:return m[0];case 8:return p;case 12:return(p+p).slice(0,3);default:return p+p}}t.parseColor=function(h){if(!h)return;let _=h.toLowerCase();if(_.indexOf("rgb:")===0){_=_.slice(4);const m=n.exec(_);if(m){const p=m[1]?15:m[4]?255:m[7]?4095:65535;return[Math.round(parseInt(m[1]||m[4]||m[7]||m[10],16)/p*255),Math.round(parseInt(m[2]||m[5]||m[8]||m[11],16)/p*255),Math.round(parseInt(m[3]||m[6]||m[9]||m[12],16)/p*255)]}}else if(_.indexOf("#")===0&&(_=_.slice(1),l.exec(_)&&[3,6,9,12].includes(_.length))){const m=_.length/3,p=[0,0,0];for(let c=0;c<3;++c){const e=parseInt(_.slice(m*c,m*c+m),16);p[c]=m===1?e<<4:m===2?e:m===3?e>>4:e>>8}return p}},t.toRgbString=function(h,_=16){const[m,p,c]=h;return`rgb:${v(m,_)}/${v(p,_)}/${v(c,_)}`}},5770:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const l=n(482),v=n(8742),h=n(5770),_=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=_,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}registerHandler(p,c){this._handlers[p]===void 0&&(this._handlers[p]=[]);const e=this._handlers[p];return e.push(c),{dispose:()=>{const r=e.indexOf(c);r!==-1&&e.splice(r,1)}}}clearHandler(p){this._handlers[p]&&delete this._handlers[p]}setHandlerFallback(p){this._handlerFb=p}reset(){if(this._active.length)for(let p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].unhook(!1);this._stack.paused=!1,this._active=_,this._ident=0}hook(p,c){if(this.reset(),this._ident=p,this._active=this._handlers[p]||_,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(c);else this._handlerFb(this._ident,"HOOK",c)}put(p,c,e){if(this._active.length)for(let r=this._active.length-1;r>=0;r--)this._active[r].put(p,c,e);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(p,c,e))}unhook(p,c=!0){if(this._active.length){let e=!1,r=this._active.length-1,s=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,e=c,s=this._stack.fallThrough,this._stack.paused=!1),!s&&e===!1){for(;r>=0&&(e=this._active[r].unhook(p),e!==!0);r--)if(e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,e;r--}for(;r>=0;r--)if(e=this._active[r].unhook(!1),e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,e}else this._handlerFb(this._ident,"UNHOOK",p);this._active=_,this._ident=0}};const m=new v.Params;m.addParam(0),t.DcsHandler=class{constructor(p){this._handler=p,this._data="",this._params=m,this._hitLimit=!1}hook(p){this._params=p.length>1||p.params[0]?p.clone():m,this._data="",this._hitLimit=!1}put(p,c,e){this._hitLimit||(this._data+=(0,l.utf32ToString)(p,c,e),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(p){let c=!1;if(this._hitLimit)c=!1;else if(p&&(c=this._handler(this._data,this._params),c instanceof Promise))return c.then(e=>(this._params=m,this._data="",this._hitLimit=!1,e));return this._params=m,this._data="",this._hitLimit=!1,c}}},2015:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const l=n(844),v=n(8742),h=n(6242),_=n(6351);class m{constructor(r){this.table=new Uint8Array(r)}setDefault(r,s){this.table.fill(r<<4|s)}add(r,s,i,o){this.table[s<<8|r]=i<<4|o}addMany(r,s,i,o){for(let d=0;d<r.length;d++)this.table[s<<8|r[d]]=i<<4|o}}t.TransitionTable=m;const p=160;t.VT500_TRANSITION_TABLE=function(){const e=new m(4095),r=Array.apply(null,Array(256)).map((S,a)=>a),s=(S,a)=>r.slice(S,a),i=s(32,127),o=s(0,24);o.push(25),o.push.apply(o,s(28,32));const d=s(0,14);let g;for(g in e.setDefault(1,0),e.addMany(i,0,2,0),d)e.addMany([24,26,153,154],g,3,0),e.addMany(s(128,144),g,3,0),e.addMany(s(144,152),g,3,0),e.add(156,g,0,0),e.add(27,g,11,1),e.add(157,g,4,8),e.addMany([152,158,159],g,0,7),e.add(155,g,11,3),e.add(144,g,11,9);return e.addMany(o,0,3,0),e.addMany(o,1,3,1),e.add(127,1,0,1),e.addMany(o,8,0,8),e.addMany(o,3,3,3),e.add(127,3,0,3),e.addMany(o,4,3,4),e.add(127,4,0,4),e.addMany(o,6,3,6),e.addMany(o,5,3,5),e.add(127,5,0,5),e.addMany(o,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(i,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(s(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(i,7,0,7),e.addMany(o,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(s(64,127),3,7,0),e.addMany(s(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(s(48,60),4,8,4),e.addMany(s(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(s(32,64),6,0,6),e.add(127,6,0,6),e.addMany(s(64,127),6,0,0),e.addMany(s(32,48),3,9,5),e.addMany(s(32,48),5,9,5),e.addMany(s(48,64),5,0,6),e.addMany(s(64,127),5,7,0),e.addMany(s(32,48),4,9,5),e.addMany(s(32,48),1,9,2),e.addMany(s(32,48),2,9,2),e.addMany(s(48,127),2,10,0),e.addMany(s(48,80),1,10,0),e.addMany(s(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(s(96,127),1,10,0),e.add(80,1,11,9),e.addMany(o,9,0,9),e.add(127,9,0,9),e.addMany(s(28,32),9,0,9),e.addMany(s(32,48),9,9,12),e.addMany(s(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(o,11,0,11),e.addMany(s(32,128),11,0,11),e.addMany(s(28,32),11,0,11),e.addMany(o,10,0,10),e.add(127,10,0,10),e.addMany(s(28,32),10,0,10),e.addMany(s(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(s(32,48),10,9,12),e.addMany(o,12,0,12),e.add(127,12,0,12),e.addMany(s(28,32),12,0,12),e.addMany(s(32,48),12,9,12),e.addMany(s(48,64),12,0,11),e.addMany(s(64,127),12,12,13),e.addMany(s(64,127),10,12,13),e.addMany(s(64,127),9,12,13),e.addMany(o,13,13,13),e.addMany(i,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(p,0,2,0),e.add(p,8,5,8),e.add(p,6,0,6),e.add(p,11,0,11),e.add(p,13,13,13),e}();class c extends l.Disposable{constructor(r=t.VT500_TRANSITION_TABLE){super(),this._transitions=r,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new v.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(s,i,o)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,i)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new h.OscParser),this._dcsParser=this.register(new _.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(r,s=[64,126]){let i=0;if(r.prefix){if(r.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=r.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(r.intermediates){if(r.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let d=0;d<r.intermediates.length;++d){const g=r.intermediates.charCodeAt(d);if(32>g||g>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=g}}if(r.final.length!==1)throw new Error("final must be a single byte");const o=r.final.charCodeAt(0);if(s[0]>o||o>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return i<<=8,i|=o,i}identToString(r){const s=[];for(;r;)s.push(String.fromCharCode(255&r)),r>>=8;return s.reverse().join("")}setPrintHandler(r){this._printHandler=r}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(r,s){const i=this._identifier(r,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);const o=this._escHandlers[i];return o.push(s),{dispose:()=>{const d=o.indexOf(s);d!==-1&&o.splice(d,1)}}}clearEscHandler(r){this._escHandlers[this._identifier(r,[48,126])]&&delete this._escHandlers[this._identifier(r,[48,126])]}setEscHandlerFallback(r){this._escHandlerFb=r}setExecuteHandler(r,s){this._executeHandlers[r.charCodeAt(0)]=s}clearExecuteHandler(r){this._executeHandlers[r.charCodeAt(0)]&&delete this._executeHandlers[r.charCodeAt(0)]}setExecuteHandlerFallback(r){this._executeHandlerFb=r}registerCsiHandler(r,s){const i=this._identifier(r);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);const o=this._csiHandlers[i];return o.push(s),{dispose:()=>{const d=o.indexOf(s);d!==-1&&o.splice(d,1)}}}clearCsiHandler(r){this._csiHandlers[this._identifier(r)]&&delete this._csiHandlers[this._identifier(r)]}setCsiHandlerFallback(r){this._csiHandlerFb=r}registerDcsHandler(r,s){return this._dcsParser.registerHandler(this._identifier(r),s)}clearDcsHandler(r){this._dcsParser.clearHandler(this._identifier(r))}setDcsHandlerFallback(r){this._dcsParser.setHandlerFallback(r)}registerOscHandler(r,s){return this._oscParser.registerHandler(r,s)}clearOscHandler(r){this._oscParser.clearHandler(r)}setOscHandlerFallback(r){this._oscParser.setHandlerFallback(r)}setErrorHandler(r){this._errorHandler=r}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(r,s,i,o,d){this._parseStack.state=r,this._parseStack.handlers=s,this._parseStack.handlerPos=i,this._parseStack.transition=o,this._parseStack.chunkPos=d}parse(r,s,i){let o,d=0,g=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const a=this._parseStack.handlers;let C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&C>-1){for(;C>=0&&(o=a[C](this._params),o!==!0);C--)if(o instanceof Promise)return this._parseStack.handlerPos=C,o}this._parseStack.handlers=[];break;case 4:if(i===!1&&C>-1){for(;C>=0&&(o=a[C](),o!==!0);C--)if(o instanceof Promise)return this._parseStack.handlerPos=C,o}this._parseStack.handlers=[];break;case 6:if(d=r[this._parseStack.chunkPos],o=this._dcsParser.unhook(d!==24&&d!==26,i),o)return o;d===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(d=r[this._parseStack.chunkPos],o=this._oscParser.end(d!==24&&d!==26,i),o)return o;d===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let a=S;a<s;++a){switch(d=r[a],g=this._transitions.table[this.currentState<<8|(d<160?d:p)],g>>4){case 2:for(let P=a+1;;++P){if(P>=s||(d=r[P])<32||d>126&&d<p){this._printHandler(r,a,P),a=P-1;break}if(++P>=s||(d=r[P])<32||d>126&&d<p){this._printHandler(r,a,P),a=P-1;break}if(++P>=s||(d=r[P])<32||d>126&&d<p){this._printHandler(r,a,P),a=P-1;break}if(++P>=s||(d=r[P])<32||d>126&&d<p){this._printHandler(r,a,P),a=P-1;break}}break;case 3:this._executeHandlers[d]?this._executeHandlers[d]():this._executeHandlerFb(d),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:a,code:d,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const C=this._csiHandlers[this._collect<<8|d];let w=C?C.length-1:-1;for(;w>=0&&(o=C[w](this._params),o!==!0);w--)if(o instanceof Promise)return this._preserveStack(3,C,w,g,a),o;w<0&&this._csiHandlerFb(this._collect<<8|d,this._params),this.precedingCodepoint=0;break;case 8:do switch(d){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(d-48)}while(++a<s&&(d=r[a])>47&&d<60);a--;break;case 9:this._collect<<=8,this._collect|=d;break;case 10:const D=this._escHandlers[this._collect<<8|d];let L=D?D.length-1:-1;for(;L>=0&&(o=D[L](),o!==!0);L--)if(o instanceof Promise)return this._preserveStack(4,D,L,g,a),o;L<0&&this._escHandlerFb(this._collect<<8|d),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|d,this._params);break;case 13:for(let P=a+1;;++P)if(P>=s||(d=r[P])===24||d===26||d===27||d>127&&d<p){this._dcsParser.put(r,a,P),a=P-1;break}break;case 14:if(o=this._dcsParser.unhook(d!==24&&d!==26),o)return this._preserveStack(6,[],0,g,a),o;d===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let P=a+1;;P++)if(P>=s||(d=r[P])<32||d>127&&d<p){this._oscParser.put(r,a,P),a=P-1;break}break;case 6:if(o=this._oscParser.end(d!==24&&d!==26),o)return this._preserveStack(5,[],0,g,a),o;d===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&g}}}t.EscapeSequenceParser=c},6242:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const l=n(5770),v=n(482),h=[];t.OscParser=class{constructor(){this._state=0,this._active=h,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(_,m){this._handlers[_]===void 0&&(this._handlers[_]=[]);const p=this._handlers[_];return p.push(m),{dispose:()=>{const c=p.indexOf(m);c!==-1&&p.splice(c,1)}}}clearHandler(_){this._handlers[_]&&delete this._handlers[_]}setHandlerFallback(_){this._handlerFb=_}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}reset(){if(this._state===2)for(let _=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;_>=0;--_)this._active[_].end(!1);this._stack.paused=!1,this._active=h,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||h,this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].start();else this._handlerFb(this._id,"START")}_put(_,m,p){if(this._active.length)for(let c=this._active.length-1;c>=0;c--)this._active[c].put(_,m,p);else this._handlerFb(this._id,"PUT",(0,v.utf32ToString)(_,m,p))}start(){this.reset(),this._state=1}put(_,m,p){if(this._state!==3){if(this._state===1)for(;m<p;){const c=_[m++];if(c===59){this._state=2,this._start();break}if(c<48||57<c)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+c-48}this._state===2&&p-m>0&&this._put(_,m,p)}}end(_,m=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let p=!1,c=this._active.length-1,e=!1;if(this._stack.paused&&(c=this._stack.loopPosition-1,p=m,e=this._stack.fallThrough,this._stack.paused=!1),!e&&p===!1){for(;c>=0&&(p=this._active[c].end(_),p!==!0);c--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!1,p;c--}for(;c>=0;c--)if(p=this._active[c].end(!1),p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=c,this._stack.fallThrough=!0,p}else this._handlerFb(this._id,"END",_);this._active=h,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(_){this._handler=_,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(_,m,p){this._hitLimit||(this._data+=(0,v.utf32ToString)(_,m,p),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(_){let m=!1;if(this._hitLimit)m=!1;else if(_&&(m=this._handler(this._data),m instanceof Promise))return m.then(p=>(this._data="",this._hitLimit=!1,p));return this._data="",this._hitLimit=!1,m}}},8742:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const n=2147483647;class l{constructor(h=32,_=32){if(this.maxLength=h,this.maxSubParamsLength=_,_>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(h),this.length=0,this._subParams=new Int32Array(_),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(h),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(h){const _=new l;if(!h.length)return _;for(let m=Array.isArray(h[0])?1:0;m<h.length;++m){const p=h[m];if(Array.isArray(p))for(let c=0;c<p.length;++c)_.addSubParam(p[c]);else _.addParam(p)}return _}clone(){const h=new l(this.maxLength,this.maxSubParamsLength);return h.params.set(this.params),h.length=this.length,h._subParams.set(this._subParams),h._subParamsLength=this._subParamsLength,h._subParamsIdx.set(this._subParamsIdx),h._rejectDigits=this._rejectDigits,h._rejectSubDigits=this._rejectSubDigits,h._digitIsSub=this._digitIsSub,h}toArray(){const h=[];for(let _=0;_<this.length;++_){h.push(this.params[_]);const m=this._subParamsIdx[_]>>8,p=255&this._subParamsIdx[_];p-m>0&&h.push(Array.prototype.slice.call(this._subParams,m,p))}return h}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(h){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=h>n?n:h}}addSubParam(h){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=h>n?n:h,this._subParamsIdx[this.length-1]++}}hasSubParams(h){return(255&this._subParamsIdx[h])-(this._subParamsIdx[h]>>8)>0}getSubParams(h){const _=this._subParamsIdx[h]>>8,m=255&this._subParamsIdx[h];return m-_>0?this._subParams.subarray(_,m):null}getSubParamsAll(){const h={};for(let _=0;_<this.length;++_){const m=this._subParamsIdx[_]>>8,p=255&this._subParamsIdx[_];p-m>0&&(h[_]=this._subParams.slice(m,p))}return h}addDigit(h){let _;if(this._rejectDigits||!(_=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const m=this._digitIsSub?this._subParams:this.params,p=m[_-1];m[_-1]=~p?Math.min(10*p+h,n):h}}t.Params=l},5741:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,l){const v={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(v),l.dispose=()=>this._wrappedAddonDispose(v),l.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let l=-1;for(let v=0;v<this._addons.length;v++)if(this._addons[v]===n){l=v;break}if(l===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(l,1)}}},8771:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const l=n(3785),v=n(511);t.BufferApiView=class{constructor(h,_){this._buffer=h,this.type=_}init(h){return this._buffer=h,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(h){const _=this._buffer.lines.get(h);if(_)return new l.BufferLineApiView(_)}getNullCell(){return new v.CellData}}},3785:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const l=n(511);t.BufferLineApiView=class{constructor(v){this._line=v}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(v,h){if(!(v<0||v>=this._line.length))return h?(this._line.loadCell(v,h),h):this._line.loadCell(v,new l.CellData)}translateToString(v,h,_){return this._line.translateToString(v,h,_)}}},8285:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const l=n(8771),v=n(8460);t.BufferNamespaceApi=class{constructor(h){this._core=h,this._onBufferChange=new v.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,l){return this._core.registerCsiHandler(n,v=>l(v.toArray()))}addCsiHandler(n,l){return this.registerCsiHandler(n,l)}registerDcsHandler(n,l){return this._core.registerDcsHandler(n,(v,h)=>l(v,h.toArray()))}addDcsHandler(n,l){return this.registerDcsHandler(n,l)}registerEscHandler(n,l){return this._core.registerEscHandler(n,l)}addEscHandler(n,l){return this.registerEscHandler(n,l)}registerOscHandler(n,l){return this._core.registerOscHandler(n,l)}addOscHandler(n,l){return this.registerOscHandler(n,l)}}},7090:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(B,t,n){var l=this&&this.__decorate||function(e,r,s,i){var o,d=arguments.length,g=d<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,s):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(e,r,s,i);else for(var S=e.length-1;S>=0;S--)(o=e[S])&&(g=(d<3?o(g):d>3?o(r,s,g):o(r,s))||g);return d>3&&g&&Object.defineProperty(r,s,g),g},v=this&&this.__param||function(e,r){return function(s,i){r(s,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const h=n(2585),_=n(5295),m=n(8460),p=n(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let c=class extends p.Disposable{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new m.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new m.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new _.BufferSet(e,this))}get buffer(){return this.buffers.active}resize(e,r){this.cols=e,this.rows=r,this.buffers.resize(e,r),this._onResize.fire({cols:e,rows:r})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,r=!1){const s=this.buffer;let i;i=this._cachedBlankLine,i&&i.length===this.cols&&i.getFg(0)===e.fg&&i.getBg(0)===e.bg||(i=s.getBlankLine(e,r),this._cachedBlankLine=i),i.isWrapped=r;const o=s.ybase+s.scrollTop,d=s.ybase+s.scrollBottom;if(s.scrollTop===0){const g=s.lines.isFull;d===s.lines.length-1?g?s.lines.recycle().copyFrom(i):s.lines.push(i.clone()):s.lines.splice(d+1,0,i.clone()),g?this.isUserScrolling&&(s.ydisp=Math.max(s.ydisp-1,0)):(s.ybase++,this.isUserScrolling||s.ydisp++)}else{const g=d-o+1;s.lines.shiftElements(o+1,g-1,-1),s.lines.set(d,i.clone())}this.isUserScrolling||(s.ydisp=s.ybase),this._onScroll.fire(s.ydisp)}scrollLines(e,r,s){const i=this.buffer;if(e<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else e+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);const o=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+e,i.ybase),0),o!==i.ydisp&&(r||this._onScroll.fire(i.ydisp))}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(e){const r=e-this.buffer.ydisp;r!==0&&this.scrollLines(r)}};c=l([v(0,h.IOptionsService)],c),t.BufferService=c},7994:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,l){this._charsets[n]=l,this.glevel===n&&(this.charset=l)}}},1753:function(B,t,n){var l=this&&this.__decorate||function(i,o,d,g){var S,a=arguments.length,C=a<3?o:g===null?g=Object.getOwnPropertyDescriptor(o,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(i,o,d,g);else for(var w=i.length-1;w>=0;w--)(S=i[w])&&(C=(a<3?S(C):a>3?S(o,d,C):S(o,d))||C);return a>3&&C&&Object.defineProperty(o,d,C),C},v=this&&this.__param||function(i,o){return function(d,g){o(d,g,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const h=n(2585),_=n(8460),m=n(844),p={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:i=>i.button!==4&&i.action===1&&(i.ctrl=!1,i.alt=!1,i.shift=!1,!0)},VT200:{events:19,restrict:i=>i.action!==32},DRAG:{events:23,restrict:i=>i.action!==32||i.button!==3},ANY:{events:31,restrict:i=>!0}};function c(i,o){let d=(i.ctrl?16:0)|(i.shift?4:0)|(i.alt?8:0);return i.button===4?(d|=64,d|=i.action):(d|=3&i.button,4&i.button&&(d|=64),8&i.button&&(d|=128),i.action===32?d|=32:i.action!==0||o||(d|=3)),d}const e=String.fromCharCode,r={DEFAULT:i=>{const o=[c(i,!1)+32,i.col+32,i.row+32];return o[0]>255||o[1]>255||o[2]>255?"":`\x1B[M${e(o[0])}${e(o[1])}${e(o[2])}`},SGR:i=>{const o=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${c(i,!0)};${i.col};${i.row}${o}`},SGR_PIXELS:i=>{const o=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${c(i,!0)};${i.x};${i.y}${o}`}};let s=class extends m.Disposable{constructor(i,o){super(),this._bufferService=i,this._coreService=o,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new _.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const d of Object.keys(p))this.addProtocol(d,p[d]);for(const d of Object.keys(r))this.addEncoding(d,r[d]);this.reset()}addProtocol(i,o){this._protocols[i]=o}addEncoding(i,o){this._encodings[i]=o}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(i){if(!this._protocols[i])throw new Error(`unknown protocol "${i}"`);this._activeProtocol=i,this._onProtocolChange.fire(this._protocols[i].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(i){if(!this._encodings[i])throw new Error(`unknown encoding "${i}"`);this._activeEncoding=i}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(i){if(i.col<0||i.col>=this._bufferService.cols||i.row<0||i.row>=this._bufferService.rows||i.button===4&&i.action===32||i.button===3&&i.action!==32||i.button!==4&&(i.action===2||i.action===3)||(i.col++,i.row++,i.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,i,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(i))return!1;const o=this._encodings[this._activeEncoding](i);return o&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(o):this._coreService.triggerDataEvent(o,!0)),this._lastEvent=i,!0}explainEvents(i){return{down:!!(1&i),up:!!(2&i),drag:!!(4&i),move:!!(8&i),wheel:!!(16&i)}}_equalEvents(i,o,d){if(d){if(i.x!==o.x||i.y!==o.y)return!1}else if(i.col!==o.col||i.row!==o.row)return!1;return i.button===o.button&&i.action===o.action&&i.ctrl===o.ctrl&&i.alt===o.alt&&i.shift===o.shift}};s=l([v(0,h.IBufferService),v(1,h.ICoreService)],s),t.CoreMouseService=s},6975:function(B,t,n){var l=this&&this.__decorate||function(s,i,o,d){var g,S=arguments.length,a=S<3?i:d===null?d=Object.getOwnPropertyDescriptor(i,o):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(s,i,o,d);else for(var C=s.length-1;C>=0;C--)(g=s[C])&&(a=(S<3?g(a):S>3?g(i,o,a):g(i,o))||a);return S>3&&a&&Object.defineProperty(i,o,a),a},v=this&&this.__param||function(s,i){return function(o,d){i(o,d,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const h=n(2585),_=n(8460),m=n(1439),p=n(844),c=Object.freeze({insertMode:!1}),e=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let r=class extends p.Disposable{constructor(s,i,o){super(),this._bufferService=s,this._logService=i,this._optionsService=o,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new _.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new _.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new _.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new _.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,m.clone)(c),this.decPrivateModes=(0,m.clone)(e)}reset(){this.modes=(0,m.clone)(c),this.decPrivateModes=(0,m.clone)(e)}triggerDataEvent(s,i=!1){if(this._optionsService.rawOptions.disableStdin)return;const o=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&o.ybase!==o.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${s}"`,()=>s.split("").map(d=>d.charCodeAt(0))),this._onData.fire(s)}triggerBinaryEvent(s){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${s}"`,()=>s.split("").map(i=>i.charCodeAt(0))),this._onBinary.fire(s))}};r=l([v(0,h.IBufferService),v(1,h.ILogService),v(2,h.IOptionsService)],r),t.CoreService=r},9074:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const l=n(8055),v=n(8460),h=n(844),_=n(6106);let m=0,p=0;class c extends h.Disposable{constructor(){super(),this._decorations=new _.SortedList(s=>s==null?void 0:s.marker.line),this._onDecorationRegistered=this.register(new v.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new v.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,h.toDisposable)(()=>{for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(s){if(s.marker.isDisposed)return;const i=new e(s);if(i){const o=i.marker.onDispose(()=>i.dispose());i.onDispose(()=>{i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),o.dispose())}),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(const s of this._decorations.values())s.dispose();this._decorations.clear()}*getDecorationsAtCell(s,i,o){var d,g,S;let a=0,C=0;for(const w of this._decorations.getKeyIterator(i))a=(d=w.options.x)!==null&&d!==void 0?d:0,C=a+((g=w.options.width)!==null&&g!==void 0?g:1),s>=a&&s<C&&(!o||((S=w.options.layer)!==null&&S!==void 0?S:"bottom")===o)&&(yield w)}forEachDecorationAtCell(s,i,o,d){this._decorations.forEachByKey(i,g=>{var S,a,C;m=(S=g.options.x)!==null&&S!==void 0?S:0,p=m+((a=g.options.width)!==null&&a!==void 0?a:1),s>=m&&s<p&&(!o||((C=g.options.layer)!==null&&C!==void 0?C:"bottom")===o)&&d(g)})}dispose(){for(const s of this._decorations.values())this._onDecorationRemoved.fire(s);this.reset()}}t.DecorationService=c;class e extends h.Disposable{constructor(s){super(),this.options=s,this.onRenderEmitter=this.register(new v.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new v.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=s.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=l.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=l.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const l=n(2585),v=n(8343);class h{constructor(...m){this._entries=new Map;for(const[p,c]of m)this.set(p,c)}set(m,p){const c=this._entries.get(m);return this._entries.set(m,p),c}forEach(m){for(const[p,c]of this._entries.entries())m(p,c)}has(m){return this._entries.has(m)}get(m){return this._entries.get(m)}}t.ServiceCollection=h,t.InstantiationService=class{constructor(){this._services=new h,this._services.set(l.IInstantiationService,this)}setService(_,m){this._services.set(_,m)}getService(_){return this._services.get(_)}createInstance(_,...m){const p=(0,v.getServiceDependencies)(_).sort((r,s)=>r.index-s.index),c=[];for(const r of p){const s=this._services.get(r.id);if(!s)throw new Error(`[createInstance] ${_.name} depends on UNKNOWN service ${r.id}.`);c.push(s)}const e=p.length>0?p[0].index:m.length;if(m.length!==e)throw new Error(`[createInstance] First service dependency of ${_.name} at position ${e+1} conflicts with ${m.length} static arguments`);return new _(...m,...c)}}},7866:function(B,t,n){var l=this&&this.__decorate||function(c,e,r,s){var i,o=arguments.length,d=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(c,e,r,s);else for(var g=c.length-1;g>=0;g--)(i=c[g])&&(d=(o<3?i(d):o>3?i(e,r,d):i(e,r))||d);return o>3&&d&&Object.defineProperty(e,r,d),d},v=this&&this.__param||function(c,e){return function(r,s){e(r,s,c)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;const h=n(844),_=n(2585),m={debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF};let p=class extends h.Disposable{constructor(c){super(),this._optionsService=c,this.logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=m[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(c){for(let e=0;e<c.length;e++)typeof c[e]=="function"&&(c[e]=c[e]())}_log(c,e,r){this._evalLazyOptionalParams(r),c.call(console,"xterm.js: "+e,...r)}debug(c,...e){this.logLevel<=_.LogLevelEnum.DEBUG&&this._log(console.log,c,e)}info(c,...e){this.logLevel<=_.LogLevelEnum.INFO&&this._log(console.info,c,e)}warn(c,...e){this.logLevel<=_.LogLevelEnum.WARN&&this._log(console.warn,c,e)}error(c,...e){this.logLevel<=_.LogLevelEnum.ERROR&&this._log(console.error,c,e)}};p=l([v(0,_.IOptionsService)],p),t.LogService=p},7302:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const l=n(8460),v=n(6114),h=n(844);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:v.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const _=["normal","bold","100","200","300","400","500","600","700","800","900"];class m extends h.Disposable{constructor(c){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const e=Object.assign({},t.DEFAULT_OPTIONS);for(const r in c)if(r in e)try{const s=c[r];e[r]=this._sanitizeAndValidateOption(r,s)}catch(s){console.error(s)}this.rawOptions=e,this.options=Object.assign({},e),this._setupOptions()}onSpecificOptionChange(c,e){return this.onOptionChange(r=>{r===c&&e(this.rawOptions[c])})}onMultipleOptionChange(c,e){return this.onOptionChange(r=>{c.indexOf(r)!==-1&&e()})}_setupOptions(){const c=r=>{if(!(r in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${r}"`);return this.rawOptions[r]},e=(r,s)=>{if(!(r in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${r}"`);s=this._sanitizeAndValidateOption(r,s),this.rawOptions[r]!==s&&(this.rawOptions[r]=s,this._onOptionChange.fire(r))};for(const r in this.rawOptions){const s={get:c.bind(this,r),set:e.bind(this,r)};Object.defineProperty(this.options,r,s)}}_sanitizeAndValidateOption(c,e){switch(c){case"cursorStyle":if(e||(e=t.DEFAULT_OPTIONS[c]),!function(r){return r==="block"||r==="underline"||r==="bar"}(e))throw new Error(`"${e}" is not a valid value for ${c}`);break;case"wordSeparator":e||(e=t.DEFAULT_OPTIONS[c]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=_.includes(e)?e:t.DEFAULT_OPTIONS[c];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${c} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(10*e)/10));break;case"scrollback":if((e=Math.min(e,4294967295))<0)throw new Error(`${c} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${c} cannot be less than or equal to 0, value: ${e}`);break;case"rows":case"cols":if(!e&&e!==0)throw new Error(`${c} must be numeric, value: ${e}`);break;case"windowsPty":e=e!=null?e:{}}return e}}t.OptionsService=m},2660:function(B,t,n){var l=this&&this.__decorate||function(m,p,c,e){var r,s=arguments.length,i=s<3?p:e===null?e=Object.getOwnPropertyDescriptor(p,c):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(m,p,c,e);else for(var o=m.length-1;o>=0;o--)(r=m[o])&&(i=(s<3?r(i):s>3?r(p,c,i):r(p,c))||i);return s>3&&i&&Object.defineProperty(p,c,i),i},v=this&&this.__param||function(m,p){return function(c,e){p(c,e,m)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const h=n(2585);let _=class{constructor(m){this._bufferService=m,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(m){const p=this._bufferService.buffer;if(m.id===void 0){const o=p.addMarker(p.ybase+p.y),d={data:m,id:this._nextId++,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(d,o)),this._dataByLinkId.set(d.id,d),d.id}const c=m,e=this._getEntryIdKey(c),r=this._entriesWithId.get(e);if(r)return this.addLineToLink(r.id,p.ybase+p.y),r.id;const s=p.addMarker(p.ybase+p.y),i={id:this._nextId++,key:this._getEntryIdKey(c),data:c,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(i,s)),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(m,p){const c=this._dataByLinkId.get(m);if(c&&c.lines.every(e=>e.line!==p)){const e=this._bufferService.buffer.addMarker(p);c.lines.push(e),e.onDispose(()=>this._removeMarkerFromLink(c,e))}}getLinkData(m){var p;return(p=this._dataByLinkId.get(m))===null||p===void 0?void 0:p.data}_getEntryIdKey(m){return`${m.id};;${m.uri}`}_removeMarkerFromLink(m,p){const c=m.lines.indexOf(p);c!==-1&&(m.lines.splice(c,1),m.lines.length===0&&(m.data.id!==void 0&&this._entriesWithId.delete(m.key),this._dataByLinkId.delete(m.id)))}};_=l([v(0,h.IBufferService)],_),t.OscLinkService=_},8343:(B,t)=>{function n(l,v,h){v.di$target===v?v.di$dependencies.push({id:l,index:h}):(v.di$dependencies=[{id:l,index:h}],v.di$target=v)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(l){return l.di$dependencies||[]},t.createDecorator=function(l){if(t.serviceRegistry.has(l))return t.serviceRegistry.get(l);const v=function(h,_,m){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");n(v,h,m)};return v.toString=()=>l,t.serviceRegistry.set(l,v),v}},2585:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const l=n(8343);var v;t.IBufferService=(0,l.createDecorator)("BufferService"),t.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),t.ICoreService=(0,l.createDecorator)("CoreService"),t.ICharsetService=(0,l.createDecorator)("CharsetService"),t.IInstantiationService=(0,l.createDecorator)("InstantiationService"),(v=t.LogLevelEnum||(t.LogLevelEnum={}))[v.DEBUG=0]="DEBUG",v[v.INFO=1]="INFO",v[v.WARN=2]="WARN",v[v.ERROR=3]="ERROR",v[v.OFF=4]="OFF",t.ILogService=(0,l.createDecorator)("LogService"),t.IOptionsService=(0,l.createDecorator)("OptionsService"),t.IOscLinkService=(0,l.createDecorator)("OscLinkService"),t.IUnicodeService=(0,l.createDecorator)("UnicodeService"),t.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(B,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const l=n(8460),v=n(225);t.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const h=new v.UnicodeV6;this.register(h),this._active=h.version,this._activeProvider=h}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(h){if(!this._providers[h])throw new Error(`unknown Unicode version "${h}"`);this._active=h,this._activeProvider=this._providers[h],this._onChange.fire(h)}register(h){this._providers[h.version]=h}wcwidth(h){return this._activeProvider.wcwidth(h)}getStringCellWidth(h){let _=0;const m=h.length;for(let p=0;p<m;++p){let c=h.charCodeAt(p);if(55296<=c&&c<=56319){if(++p>=m)return _+this.wcwidth(c);const e=h.charCodeAt(p);56320<=e&&e<=57343?c=1024*(c-55296)+e-56320+65536:_+=this.wcwidth(e)}_+=this.wcwidth(c)}return _}}}},k={};function T(B){var t=k[B];if(t!==void 0)return t.exports;var n=k[B]={exports:{}};return b[B].call(n.exports,n,n.exports,T),n.exports}var H={};return(()=>{var B=H;Object.defineProperty(B,"__esModule",{value:!0}),B.Terminal=void 0;const t=T(3236),n=T(9042),l=T(7975),v=T(7090),h=T(5741),_=T(8285),m=["cols","rows"];B.Terminal=class{constructor(p){this._core=new t.Terminal(p),this._addonManager=new h.AddonManager,this._publicOptions=Object.assign({},this._core.options);const c=r=>this._core.options[r],e=(r,s)=>{this._checkReadonlyOptions(r),this._core.options[r]=s};for(const r in this._core.options){const s={get:c.bind(this,r),set:e.bind(this,r)};Object.defineProperty(this._publicOptions,r,s)}}_checkReadonlyOptions(p){if(m.includes(p))throw new Error(`Option "${p}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new l.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new _.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const p=this._core.coreService.decPrivateModes;let c="none";switch(this._core.coreMouseService.activeProtocol){case"X10":c="x10";break;case"VT200":c="vt200";break;case"DRAG":c="drag";break;case"ANY":c="any"}return{applicationCursorKeysMode:p.applicationCursorKeys,applicationKeypadMode:p.applicationKeypad,bracketedPasteMode:p.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:c,originMode:p.origin,reverseWraparoundMode:p.reverseWraparound,sendFocusMode:p.sendFocus,wraparoundMode:p.wraparound}}get options(){return this._publicOptions}set options(p){for(const c in p)this._publicOptions[c]=p[c]}blur(){this._core.blur()}focus(){this._core.focus()}resize(p,c){this._verifyIntegers(p,c),this._core.resize(p,c)}open(p){this._core.open(p)}attachCustomKeyEventHandler(p){this._core.attachCustomKeyEventHandler(p)}registerLinkProvider(p){return this._core.registerLinkProvider(p)}registerCharacterJoiner(p){return this._checkProposedApi(),this._core.registerCharacterJoiner(p)}deregisterCharacterJoiner(p){this._checkProposedApi(),this._core.deregisterCharacterJoiner(p)}registerMarker(p=0){return this._verifyIntegers(p),this._core.addMarker(p)}registerDecoration(p){var c,e,r;return this._checkProposedApi(),this._verifyPositiveIntegers((c=p.x)!==null&&c!==void 0?c:0,(e=p.width)!==null&&e!==void 0?e:0,(r=p.height)!==null&&r!==void 0?r:0),this._core.registerDecoration(p)}hasSelection(){return this._core.hasSelection()}select(p,c,e){this._verifyIntegers(p,c,e),this._core.select(p,c,e)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(p,c){this._verifyIntegers(p,c),this._core.selectLines(p,c)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(p){this._verifyIntegers(p),this._core.scrollLines(p)}scrollPages(p){this._verifyIntegers(p),this._core.scrollPages(p)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(p){this._verifyIntegers(p),this._core.scrollToLine(p)}clear(){this._core.clear()}write(p,c){this._core.write(p,c)}writeln(p,c){this._core.write(p),this._core.write(`\r
`,c)}paste(p){this._core.paste(p)}refresh(p,c){this._verifyIntegers(p,c),this._core.refresh(p,c)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(p){return this._addonManager.loadAddon(this,p)}static get strings(){return n}_verifyIntegers(...p){for(const c of p)if(c===1/0||isNaN(c)||c%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...p){for(const c of p)if(c&&(c===1/0||isNaN(c)||c%1!=0||c<0))throw new Error("This API only accepts positive integers")}}})(),H})())})(tt);var zt=tt.exports,st={exports:{}};(function(u,f){(function(b,k){u.exports=k()})(self,function(){return(()=>{var b={};return(()=>{var k=b;Object.defineProperty(k,"__esModule",{value:!0}),k.FitAddon=void 0,k.FitAddon=class{constructor(){}activate(T){this._terminal=T}dispose(){}fit(){const T=this.proposeDimensions();if(!T||!this._terminal||isNaN(T.cols)||isNaN(T.rows))return;const H=this._terminal._core;this._terminal.rows===T.rows&&this._terminal.cols===T.cols||(H._renderService.clear(),this._terminal.resize(T.cols,T.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const T=this._terminal._core,H=T._renderService.dimensions;if(H.css.cell.width===0||H.css.cell.height===0)return;const B=this._terminal.options.scrollback===0?0:T.viewport.scrollBarWidth,t=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(t.getPropertyValue("height")),l=Math.max(0,parseInt(t.getPropertyValue("width"))),v=window.getComputedStyle(this._terminal.element),h=n-(parseInt(v.getPropertyValue("padding-top"))+parseInt(v.getPropertyValue("padding-bottom"))),_=l-(parseInt(v.getPropertyValue("padding-right"))+parseInt(v.getPropertyValue("padding-left")))-B;return{cols:Math.max(2,Math.floor(_/H.css.cell.width)),rows:Math.max(1,Math.floor(h/H.css.cell.height))}}}})(),b})()})})(st);var jt=st.exports,rt={exports:{}};(function(u,f){(function(b,k){u.exports=k()})(self,function(){return(()=>{var b={6:(B,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=class{constructor(l,v,h,_={}){this._terminal=l,this._regex=v,this._handler=h,this._options=_}provideLinks(l,v){const h=n.computeLink(l,this._regex,this._terminal,this._handler);v(this._addCallbacks(h))}_addCallbacks(l){return l.map(v=>(v.leave=this._options.leave,v.hover=(h,_)=>{if(this._options.hover){const{range:m}=v;this._options.hover(h,_,m)}},v))}};class n{static computeLink(v,h,_,m){const p=new RegExp(h.source,(h.flags||"")+"g"),[c,e]=n._getWindowedLineStrings(v-1,_),r=c.join("");let s;const i=[];for(;s=p.exec(r);){const o=s[0];try{const w=new URL(o),D=decodeURI(w.toString());if(o!==D&&o+"/"!==D)continue}catch{continue}const[d,g]=n._mapStrIdx(_,e,0,s.index),[S,a]=n._mapStrIdx(_,d,g,o.length);if(d===-1||g===-1||S===-1||a===-1)continue;const C={start:{x:g+1,y:d+1},end:{x:a,y:S+1}};i.push({range:C,text:o,activate:m})}return i}static _getWindowedLineStrings(v,h){let _,m=v,p=v,c=0,e="";const r=[];if(_=h.buffer.active.getLine(v)){const s=_.translateToString(!0);if(_.isWrapped&&s[0]!==" "){for(c=0;(_=h.buffer.active.getLine(--m))&&c<2048&&(e=_.translateToString(!0),c+=e.length,r.push(e),_.isWrapped&&e.indexOf(" ")===-1););r.reverse()}for(r.push(s),c=0;(_=h.buffer.active.getLine(++p))&&_.isWrapped&&c<2048&&(e=_.translateToString(!0),c+=e.length,r.push(e),e.indexOf(" ")===-1););}return[r,m]}static _mapStrIdx(v,h,_,m){const p=v.buffer.active,c=p.getNullCell();let e=_;for(;m;){const r=p.getLine(h);if(!r)return[-1,-1];for(let s=e;s<r.length;++s){r.getCell(s,c);const i=c.getChars();if(c.getWidth()&&(m-=i.length||1,s===r.length-1&&i==="")){const o=p.getLine(h+1);o&&o.isWrapped&&(o.getCell(0,c),c.getWidth()===2&&(m+=1))}if(m<0)return[h,s]}h++,e=0}return[h,e]}}t.LinkComputer=n}},k={};function T(B){var t=k[B];if(t!==void 0)return t.exports;var n=k[B]={exports:{}};return b[B](n,n.exports,T),n.exports}var H={};return(()=>{var B=H;Object.defineProperty(B,"__esModule",{value:!0}),B.WebLinksAddon=void 0;const t=T(6),n=/https?:[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function l(v,h){const _=window.open();if(_){try{_.opener=null}catch{}_.location.href=h}else console.warn("Opening link blocked as opener could not be cleared")}B.WebLinksAddon=class{constructor(v=l,h={}){this._handler=v,this._options=h}activate(v){this._terminal=v;const h=this._options,_=h.urlRegex||n;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,_,this._handler,h))}dispose(){var v;(v=this._linkProvider)===null||v===void 0||v.dispose()}}})(),H})()})})(rt);var Kt=rt.exports;var qt=Object.defineProperty,se=(u,f)=>{for(var b in f)qt(u,b,{get:f[b],enumerable:!0})},Vt={};se(Vt,{convertFileSrc:()=>Xt,invoke:()=>Pe,transformCallback:()=>oe});function Gt(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function oe(u,f=!1){let b=Gt(),k=`_${b}`;return Object.defineProperty(window,k,{value:T=>(f&&Reflect.deleteProperty(window,k),u==null?void 0:u(T)),writable:!1,configurable:!0}),b}async function Pe(u,f={}){return new Promise((b,k)=>{let T=oe(B=>{b(B),Reflect.deleteProperty(window,`_${H}`)},!0),H=oe(B=>{k(B),Reflect.deleteProperty(window,`_${T}`)},!0);window.__TAURI_IPC__({cmd:u,callback:T,error:H,...f})})}function Xt(u,f="asset"){let b=encodeURIComponent(u);return navigator.userAgent.includes("Windows")?`https://${f}.localhost/${b}`:`${f}://localhost/${b}`}async function I(u){return Pe("tauri",u)}var Yt={};se(Yt,{TauriEvent:()=>ht,emit:()=>He,listen:()=>Ie,once:()=>lt});async function nt(u,f){return I({__tauriModule:"Event",message:{cmd:"unlisten",event:u,eventId:f}})}async function ot(u,f,b){await I({__tauriModule:"Event",message:{cmd:"emit",event:u,windowLabel:f,payload:b}})}async function Oe(u,f,b){return I({__tauriModule:"Event",message:{cmd:"listen",event:u,windowLabel:f,handler:oe(b)}}).then(k=>async()=>nt(u,k))}async function at(u,f,b){return Oe(u,f,k=>{b(k),nt(u,k.id).catch(()=>{})})}var ht=(u=>(u.WINDOW_RESIZED="tauri://resize",u.WINDOW_MOVED="tauri://move",u.WINDOW_CLOSE_REQUESTED="tauri://close-requested",u.WINDOW_CREATED="tauri://window-created",u.WINDOW_DESTROYED="tauri://destroyed",u.WINDOW_FOCUS="tauri://focus",u.WINDOW_BLUR="tauri://blur",u.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",u.WINDOW_THEME_CHANGED="tauri://theme-changed",u.WINDOW_FILE_DROP="tauri://file-drop",u.WINDOW_FILE_DROP_HOVER="tauri://file-drop-hover",u.WINDOW_FILE_DROP_CANCELLED="tauri://file-drop-cancelled",u.MENU="tauri://menu",u.CHECK_UPDATE="tauri://update",u.UPDATE_AVAILABLE="tauri://update-available",u.INSTALL_UPDATE="tauri://update-install",u.STATUS_UPDATE="tauri://update-status",u.DOWNLOAD_PROGRESS="tauri://update-download-progress",u))(ht||{});async function Ie(u,f){return Oe(u,null,f)}async function lt(u,f){return at(u,null,f)}async function He(u,f){return ot(u,void 0,f)}var Jt={};se(Jt,{checkUpdate:()=>Qt,installUpdate:()=>Zt,onUpdaterEvent:()=>Fe});async function Fe(u){return Ie("tauri://update-status",f=>{u(f==null?void 0:f.payload)})}async function Zt(){let u;function f(){u&&u(),u=void 0}return new Promise((b,k)=>{function T(H){if(H.error){f(),k(H.error);return}H.status==="DONE"&&(f(),b())}Fe(T).then(H=>{u=H}).catch(H=>{throw f(),H}),He("tauri://update-install").catch(H=>{throw f(),H})})}async function Qt(){let u;function f(){u&&u(),u=void 0}return new Promise((b,k)=>{function T(B){f(),b({manifest:B,shouldUpdate:!0})}function H(B){if(B.error){f(),k(B.error);return}B.status==="UPTODATE"&&(f(),b({shouldUpdate:!1}))}lt("tauri://update-available",B=>{T(B==null?void 0:B.payload)}).catch(B=>{throw f(),B}),Fe(H).then(B=>{u=B}).catch(B=>{throw f(),B}),He("tauri://update").catch(B=>{throw f(),B})})}var ei={};se(ei,{CloseRequestedEvent:()=>vt,LogicalPosition:()=>dt,LogicalSize:()=>ct,PhysicalPosition:()=>Ce,PhysicalSize:()=>Se,UserAttentionType:()=>ut,WebviewWindow:()=>he,WebviewWindowHandle:()=>_t,WindowManager:()=>ft,appWindow:()=>be,availableMonitors:()=>ri,currentMonitor:()=>ii,getAll:()=>Be,getCurrent:()=>ti,primaryMonitor:()=>si});var ct=class{constructor(f,b){this.type="Logical",this.width=f,this.height=b}},Se=class{constructor(f,b){this.type="Physical",this.width=f,this.height=b}toLogical(f){return new ct(this.width/f,this.height/f)}},dt=class{constructor(f,b){this.type="Logical",this.x=f,this.y=b}},Ce=class{constructor(f,b){this.type="Physical",this.x=f,this.y=b}toLogical(f){return new dt(this.x/f,this.y/f)}},ut=(u=>(u[u.Critical=1]="Critical",u[u.Informational=2]="Informational",u))(ut||{});function ti(){return new he(window.__TAURI_METADATA__.__currentWindow.label,{skip:!0})}function Be(){return window.__TAURI_METADATA__.__windows.map(u=>new he(u.label,{skip:!0}))}var qe=["tauri://created","tauri://error"],_t=class{constructor(f){this.label=f,this.listeners=Object.create(null)}async listen(f,b){return this._handleTauriEvent(f,b)?Promise.resolve(()=>{let k=this.listeners[f];k.splice(k.indexOf(b),1)}):Oe(f,this.label,b)}async once(f,b){return this._handleTauriEvent(f,b)?Promise.resolve(()=>{let k=this.listeners[f];k.splice(k.indexOf(b),1)}):at(f,this.label,b)}async emit(f,b){if(qe.includes(f)){for(let k of this.listeners[f]||[])k({event:f,id:-1,windowLabel:this.label,payload:b});return Promise.resolve()}return ot(f,this.label,b)}_handleTauriEvent(f,b){return qe.includes(f)?(f in this.listeners?this.listeners[f].push(b):this.listeners[f]=[b],!0):!1}},ft=class extends _t{async scaleFactor(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"scaleFactor"}}}})}async innerPosition(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerPosition"}}}}).then(({x:f,y:b})=>new Ce(f,b))}async outerPosition(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerPosition"}}}}).then(({x:f,y:b})=>new Ce(f,b))}async innerSize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"innerSize"}}}}).then(({width:f,height:b})=>new Se(f,b))}async outerSize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"outerSize"}}}}).then(({width:f,height:b})=>new Se(f,b))}async isFullscreen(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFullscreen"}}}})}async isMinimized(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimized"}}}})}async isMaximized(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximized"}}}})}async isFocused(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isFocused"}}}})}async isDecorated(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isDecorated"}}}})}async isResizable(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isResizable"}}}})}async isMaximizable(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMaximizable"}}}})}async isMinimizable(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isMinimizable"}}}})}async isClosable(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isClosable"}}}})}async isVisible(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"isVisible"}}}})}async title(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"title"}}}})}async theme(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"theme"}}}})}async center(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"center"}}}})}async requestUserAttention(f){let b=null;return f&&(f===1?b={type:"Critical"}:b={type:"Informational"}),I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"requestUserAttention",payload:b}}}})}async setResizable(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setResizable",payload:f}}}})}async setMaximizable(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaximizable",payload:f}}}})}async setMinimizable(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinimizable",payload:f}}}})}async setClosable(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setClosable",payload:f}}}})}async setTitle(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setTitle",payload:f}}}})}async maximize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"maximize"}}}})}async unmaximize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unmaximize"}}}})}async toggleMaximize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"toggleMaximize"}}}})}async minimize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"minimize"}}}})}async unminimize(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"unminimize"}}}})}async show(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"show"}}}})}async hide(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"hide"}}}})}async close(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"close"}}}})}async setDecorations(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setDecorations",payload:f}}}})}async setAlwaysOnTop(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setAlwaysOnTop",payload:f}}}})}async setContentProtected(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setContentProtected",payload:f}}}})}async setSize(f){if(!f||f.type!=="Logical"&&f.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSize",payload:{type:f.type,data:{width:f.width,height:f.height}}}}}})}async setMinSize(f){if(f&&f.type!=="Logical"&&f.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMinSize",payload:f?{type:f.type,data:{width:f.width,height:f.height}}:null}}}})}async setMaxSize(f){if(f&&f.type!=="Logical"&&f.type!=="Physical")throw new Error("the `size` argument must be either a LogicalSize or a PhysicalSize instance");return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setMaxSize",payload:f?{type:f.type,data:{width:f.width,height:f.height}}:null}}}})}async setPosition(f){if(!f||f.type!=="Logical"&&f.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setPosition",payload:{type:f.type,data:{x:f.x,y:f.y}}}}}})}async setFullscreen(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFullscreen",payload:f}}}})}async setFocus(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setFocus"}}}})}async setIcon(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIcon",payload:{icon:typeof f=="string"?f:Array.from(f)}}}}})}async setSkipTaskbar(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setSkipTaskbar",payload:f}}}})}async setCursorGrab(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorGrab",payload:f}}}})}async setCursorVisible(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorVisible",payload:f}}}})}async setCursorIcon(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorIcon",payload:f}}}})}async setCursorPosition(f){if(!f||f.type!=="Logical"&&f.type!=="Physical")throw new Error("the `position` argument must be either a LogicalPosition or a PhysicalPosition instance");return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setCursorPosition",payload:{type:f.type,data:{x:f.x,y:f.y}}}}}})}async setIgnoreCursorEvents(f){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"setIgnoreCursorEvents",payload:f}}}})}async startDragging(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{label:this.label,cmd:{type:"startDragging"}}}})}async onResized(f){return this.listen("tauri://resize",b=>{b.payload=gt(b.payload),f(b)})}async onMoved(f){return this.listen("tauri://move",b=>{b.payload=pt(b.payload),f(b)})}async onCloseRequested(f){return this.listen("tauri://close-requested",b=>{let k=new vt(b);Promise.resolve(f(k)).then(()=>{if(!k.isPreventDefault())return this.close()})})}async onFocusChanged(f){let b=await this.listen("tauri://focus",T=>{f({...T,payload:!0})}),k=await this.listen("tauri://blur",T=>{f({...T,payload:!1})});return()=>{b(),k()}}async onScaleChanged(f){return this.listen("tauri://scale-change",f)}async onMenuClicked(f){return this.listen("tauri://menu",f)}async onFileDropEvent(f){let b=await this.listen("tauri://file-drop",H=>{f({...H,payload:{type:"drop",paths:H.payload}})}),k=await this.listen("tauri://file-drop-hover",H=>{f({...H,payload:{type:"hover",paths:H.payload}})}),T=await this.listen("tauri://file-drop-cancelled",H=>{f({...H,payload:{type:"cancel"}})});return()=>{b(),k(),T()}}async onThemeChanged(f){return this.listen("tauri://theme-changed",f)}},vt=class{constructor(f){this._preventDefault=!1,this.event=f.event,this.windowLabel=f.windowLabel,this.id=f.id}preventDefault(){this._preventDefault=!0}isPreventDefault(){return this._preventDefault}},he=class extends ft{constructor(f,b={}){super(f),b!=null&&b.skip||I({__tauriModule:"Window",message:{cmd:"createWebview",data:{options:{label:f,...b}}}}).then(async()=>this.emit("tauri://created")).catch(async k=>this.emit("tauri://error",k))}static getByLabel(f){return Be().some(b=>b.label===f)?new he(f,{skip:!0}):null}static async getFocusedWindow(){for(let f of Be())if(await f.isFocused())return f;return null}},be;"__TAURI_METADATA__"in window?be=new he(window.__TAURI_METADATA__.__currentWindow.label,{skip:!0}):(console.warn(`Could not find "window.__TAURI_METADATA__". The "appWindow" value will reference the "main" window label.
Note that this is not an issue if running this frontend on a browser instead of a Tauri window.`),be=new he("main",{skip:!0}));function We(u){return u===null?null:{name:u.name,scaleFactor:u.scaleFactor,position:pt(u.position),size:gt(u.size)}}function pt(u){return new Ce(u.x,u.y)}function gt(u){return new Se(u.width,u.height)}async function ii(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"currentMonitor"}}}}).then(We)}async function si(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"primaryMonitor"}}}}).then(We)}async function ri(){return I({__tauriModule:"Window",message:{cmd:"manage",data:{cmd:{type:"availableMonitors"}}}}).then(u=>u.map(We))}var ni={};se(ni,{isPermissionGranted:()=>oi,requestPermission:()=>ai,sendNotification:()=>hi});async function oi(){return window.Notification.permission!=="default"?Promise.resolve(window.Notification.permission==="granted"):I({__tauriModule:"Notification",message:{cmd:"isNotificationPermissionGranted"}})}async function ai(){return window.Notification.requestPermission()}function hi(u){typeof u=="string"?new window.Notification(u):new window.Notification(u.title,u)}function $e(){return navigator.appVersion.includes("Win")}var li={};se(li,{EOL:()=>ci,arch:()=>fi,locale:()=>pi,platform:()=>di,tempdir:()=>vi,type:()=>_i,version:()=>ui});var ci=$e()?`\r
`:`
`;async function di(){return I({__tauriModule:"Os",message:{cmd:"platform"}})}async function ui(){return I({__tauriModule:"Os",message:{cmd:"version"}})}async function _i(){return I({__tauriModule:"Os",message:{cmd:"osType"}})}async function fi(){return I({__tauriModule:"Os",message:{cmd:"arch"}})}async function vi(){return I({__tauriModule:"Os",message:{cmd:"tempdir"}})}async function pi(){return I({__tauriModule:"Os",message:{cmd:"locale"}})}var gi={};se(gi,{BaseDirectory:()=>ye,Dir:()=>ye,copyFile:()=>Ei,createDir:()=>yi,exists:()=>Di,readBinaryFile:()=>Si,readDir:()=>bi,readTextFile:()=>mi,removeDir:()=>wi,removeFile:()=>Li,renameFile:()=>ki,writeBinaryFile:()=>Ci,writeFile:()=>Ve,writeTextFile:()=>Ve});var ye=(u=>(u[u.Audio=1]="Audio",u[u.Cache=2]="Cache",u[u.Config=3]="Config",u[u.Data=4]="Data",u[u.LocalData=5]="LocalData",u[u.Desktop=6]="Desktop",u[u.Document=7]="Document",u[u.Download=8]="Download",u[u.Executable=9]="Executable",u[u.Font=10]="Font",u[u.Home=11]="Home",u[u.Picture=12]="Picture",u[u.Public=13]="Public",u[u.Runtime=14]="Runtime",u[u.Template=15]="Template",u[u.Video=16]="Video",u[u.Resource=17]="Resource",u[u.App=18]="App",u[u.Log=19]="Log",u[u.Temp=20]="Temp",u[u.AppConfig=21]="AppConfig",u[u.AppData=22]="AppData",u[u.AppLocalData=23]="AppLocalData",u[u.AppCache=24]="AppCache",u[u.AppLog=25]="AppLog",u))(ye||{});async function mi(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"readTextFile",path:u,options:f}})}async function Si(u,f={}){let b=await I({__tauriModule:"Fs",message:{cmd:"readFile",path:u,options:f}});return Uint8Array.from(b)}async function Ve(u,f,b){typeof b=="object"&&Object.freeze(b),typeof u=="object"&&Object.freeze(u);let k={path:"",contents:""},T=b;return typeof u=="string"?k.path=u:(k.path=u.path,k.contents=u.contents),typeof f=="string"?k.contents=f!=null?f:"":T=f,I({__tauriModule:"Fs",message:{cmd:"writeFile",path:k.path,contents:Array.from(new TextEncoder().encode(k.contents)),options:T}})}async function Ci(u,f,b){typeof b=="object"&&Object.freeze(b),typeof u=="object"&&Object.freeze(u);let k={path:"",contents:[]},T=b;return typeof u=="string"?k.path=u:(k.path=u.path,k.contents=u.contents),f&&"dir"in f?T=f:typeof u=="string"&&(k.contents=f!=null?f:[]),I({__tauriModule:"Fs",message:{cmd:"writeFile",path:k.path,contents:Array.from(k.contents instanceof ArrayBuffer?new Uint8Array(k.contents):k.contents),options:T}})}async function bi(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"readDir",path:u,options:f}})}async function yi(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"createDir",path:u,options:f}})}async function wi(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"removeDir",path:u,options:f}})}async function Ei(u,f,b={}){return I({__tauriModule:"Fs",message:{cmd:"copyFile",source:u,destination:f,options:b}})}async function Li(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"removeFile",path:u,options:f}})}async function ki(u,f,b={}){return I({__tauriModule:"Fs",message:{cmd:"renameFile",oldPath:u,newPath:f,options:b}})}async function Di(u,f={}){return I({__tauriModule:"Fs",message:{cmd:"exists",path:u,options:f}})}var Ai={};se(Ai,{BaseDirectory:()=>ye,appCacheDir:()=>Ti,appConfigDir:()=>mt,appDataDir:()=>xi,appDir:()=>Ri,appLocalDataDir:()=>Mi,appLogDir:()=>St,audioDir:()=>Bi,basename:()=>ns,cacheDir:()=>Pi,configDir:()=>Oi,dataDir:()=>Ii,delimiter:()=>Qi,desktopDir:()=>Hi,dirname:()=>ss,documentDir:()=>Fi,downloadDir:()=>Wi,executableDir:()=>$i,extname:()=>rs,fontDir:()=>Ui,homeDir:()=>Ni,isAbsolute:()=>os,join:()=>is,localDataDir:()=>zi,logDir:()=>Ji,normalize:()=>ts,pictureDir:()=>ji,publicDir:()=>Ki,resolve:()=>es,resolveResource:()=>Vi,resourceDir:()=>qi,runtimeDir:()=>Gi,sep:()=>Zi,templateDir:()=>Xi,videoDir:()=>Yi});async function Ri(){return mt()}async function mt(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:21}})}async function xi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:22}})}async function Mi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:23}})}async function Ti(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:24}})}async function Bi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:1}})}async function Pi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:2}})}async function Oi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:3}})}async function Ii(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:4}})}async function Hi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:6}})}async function Fi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:7}})}async function Wi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:8}})}async function $i(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:9}})}async function Ui(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:10}})}async function Ni(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:11}})}async function zi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:5}})}async function ji(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:12}})}async function Ki(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:13}})}async function qi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:17}})}async function Vi(u){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:u,directory:17}})}async function Gi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:14}})}async function Xi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:15}})}async function Yi(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:16}})}async function Ji(){return St()}async function St(){return I({__tauriModule:"Path",message:{cmd:"resolvePath",path:"",directory:25}})}var Zi=$e()?"\\":"/",Qi=$e()?";":":";async function es(...u){return I({__tauriModule:"Path",message:{cmd:"resolve",paths:u}})}async function ts(u){return I({__tauriModule:"Path",message:{cmd:"normalize",path:u}})}async function is(...u){return I({__tauriModule:"Path",message:{cmd:"join",paths:u}})}async function ss(u){return I({__tauriModule:"Path",message:{cmd:"dirname",path:u}})}async function rs(u){return I({__tauriModule:"Path",message:{cmd:"extname",path:u}})}async function ns(u,f){return I({__tauriModule:"Path",message:{cmd:"basename",path:u,ext:f}})}async function os(u){return I({__tauriModule:"Path",message:{cmd:"isAbsolute",path:u}})}var as={};se(as,{exit:()=>hs,relaunch:()=>ls});async function hs(u=0){return I({__tauriModule:"Process",message:{cmd:"exit",exitCode:u}})}async function ls(){return I({__tauriModule:"Process",message:{cmd:"relaunch"}})}var cs={};se(cs,{Child:()=>Ct,Command:()=>bt,EventEmitter:()=>fe,open:()=>us});async function ds(u,f,b=[],k){return typeof b=="object"&&Object.freeze(b),I({__tauriModule:"Shell",message:{cmd:"execute",program:f,args:b,options:k,onEventFn:oe(u)}})}var fe=class{constructor(){this.eventListeners=Object.create(null)}addListener(f,b){return this.on(f,b)}removeListener(f,b){return this.off(f,b)}on(f,b){return f in this.eventListeners?this.eventListeners[f].push(b):this.eventListeners[f]=[b],this}once(f,b){let k=(...T)=>{this.removeListener(f,k),b(...T)};return this.addListener(f,k)}off(f,b){return f in this.eventListeners&&(this.eventListeners[f]=this.eventListeners[f].filter(k=>k!==b)),this}removeAllListeners(f){return f?delete this.eventListeners[f]:this.eventListeners=Object.create(null),this}emit(f,...b){if(f in this.eventListeners){let k=this.eventListeners[f];for(let T of k)T(...b);return!0}return!1}listenerCount(f){return f in this.eventListeners?this.eventListeners[f].length:0}prependListener(f,b){return f in this.eventListeners?this.eventListeners[f].unshift(b):this.eventListeners[f]=[b],this}prependOnceListener(f,b){let k=(...T)=>{this.removeListener(f,k),b(...T)};return this.prependListener(f,k)}},Ct=class{constructor(f){this.pid=f}async write(f){return I({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:typeof f=="string"?f:Array.from(f)}})}async kill(){return I({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})}},bt=class extends fe{constructor(f,b=[],k){super(),this.stdout=new fe,this.stderr=new fe,this.program=f,this.args=typeof b=="string"?[b]:b,this.options=k!=null?k:{}}static sidecar(f,b=[],k){let T=new bt(f,b,k);return T.options.sidecar=!0,T}async spawn(){return ds(f=>{switch(f.event){case"Error":this.emit("error",f.payload);break;case"Terminated":this.emit("close",f.payload);break;case"Stdout":this.stdout.emit("data",f.payload);break;case"Stderr":this.stderr.emit("data",f.payload);break}},this.program,this.args,this.options).then(f=>new Ct(f))}async execute(){return new Promise((f,b)=>{this.on("error",b);let k=[],T=[];this.stdout.on("data",H=>{k.push(H)}),this.stderr.on("data",H=>{T.push(H)}),this.on("close",H=>{f({code:H.code,signal:H.signal,stdout:k.join(`
`),stderr:T.join(`
`)})}),this.spawn().catch(b)})}};async function us(u,f){return I({__tauriModule:"Shell",message:{cmd:"open",path:u,with:f}})}var _s={};se(_s,{getName:()=>vs,getTauriVersion:()=>ps,getVersion:()=>fs,hide:()=>ms,show:()=>gs});async function fs(){return I({__tauriModule:"App",message:{cmd:"getAppVersion"}})}async function vs(){return I({__tauriModule:"App",message:{cmd:"getAppName"}})}async function ps(){return I({__tauriModule:"App",message:{cmd:"getTauriVersion"}})}async function gs(){return I({__tauriModule:"App",message:{cmd:"show"}})}async function ms(){return I({__tauriModule:"App",message:{cmd:"hide"}})}var Ss={};se(Ss,{getMatches:()=>Cs});async function Cs(){return I({__tauriModule:"Cli",message:{cmd:"cliMatches"}})}var bs={};se(bs,{readText:()=>ws,writeText:()=>ys});async function ys(u){return I({__tauriModule:"Clipboard",message:{cmd:"writeText",data:u}})}async function ws(){return I({__tauriModule:"Clipboard",message:{cmd:"readText",data:null}})}var Es={};se(Es,{ask:()=>As,confirm:()=>Rs,message:()=>Ds,open:()=>Ls,save:()=>ks});async function Ls(u={}){return typeof u=="object"&&Object.freeze(u),I({__tauriModule:"Dialog",message:{cmd:"openDialog",options:u}})}async function ks(u={}){return typeof u=="object"&&Object.freeze(u),I({__tauriModule:"Dialog",message:{cmd:"saveDialog",options:u}})}async function Ds(u,f){var k,T;let b=typeof f=="string"?{title:f}:f;return I({__tauriModule:"Dialog",message:{cmd:"messageDialog",message:u.toString(),title:(k=b==null?void 0:b.title)==null?void 0:k.toString(),type:b==null?void 0:b.type,buttonLabel:(T=b==null?void 0:b.okLabel)==null?void 0:T.toString()}})}async function As(u,f){var k,T,H,B,t;let b=typeof f=="string"?{title:f}:f;return I({__tauriModule:"Dialog",message:{cmd:"askDialog",message:u.toString(),title:(k=b==null?void 0:b.title)==null?void 0:k.toString(),type:b==null?void 0:b.type,buttonLabels:[(H=(T=b==null?void 0:b.okLabel)==null?void 0:T.toString())!=null?H:"Yes",(t=(B=b==null?void 0:b.cancelLabel)==null?void 0:B.toString())!=null?t:"No"]}})}async function Rs(u,f){var k,T,H,B,t;let b=typeof f=="string"?{title:f}:f;return I({__tauriModule:"Dialog",message:{cmd:"confirmDialog",message:u.toString(),title:(k=b==null?void 0:b.title)==null?void 0:k.toString(),type:b==null?void 0:b.type,buttonLabels:[(H=(T=b==null?void 0:b.okLabel)==null?void 0:T.toString())!=null?H:"Ok",(t=(B=b==null?void 0:b.cancelLabel)==null?void 0:B.toString())!=null?t:"Cancel"]}})}var xs={};se(xs,{isRegistered:()=>Bs,register:()=>Ms,registerAll:()=>Ts,unregister:()=>Ps,unregisterAll:()=>Os});async function Ms(u,f){return I({__tauriModule:"GlobalShortcut",message:{cmd:"register",shortcut:u,handler:oe(f)}})}async function Ts(u,f){return I({__tauriModule:"GlobalShortcut",message:{cmd:"registerAll",shortcuts:u,handler:oe(f)}})}async function Bs(u){return I({__tauriModule:"GlobalShortcut",message:{cmd:"isRegistered",shortcut:u}})}async function Ps(u){return I({__tauriModule:"GlobalShortcut",message:{cmd:"unregister",shortcut:u}})}async function Os(){return I({__tauriModule:"GlobalShortcut",message:{cmd:"unregisterAll"}})}var Is={};se(Is,{Body:()=>ce,Client:()=>Et,Response:()=>wt,ResponseType:()=>yt,fetch:()=>Hs,getClient:()=>Lt});var yt=(u=>(u[u.JSON=1]="JSON",u[u.Text=2]="Text",u[u.Binary=3]="Binary",u))(yt||{}),ce=class{constructor(u,f){this.type=u,this.payload=f}static form(u){let f={},b=(k,T)=>{if(T!==null){let H;typeof T=="string"?H=T:T instanceof Uint8Array||Array.isArray(T)?H=Array.from(T):T instanceof File?H={file:T.name,mime:T.type,fileName:T.name}:typeof T.file=="string"?H={file:T.file,mime:T.mime,fileName:T.fileName}:H={file:Array.from(T.file),mime:T.mime,fileName:T.fileName},f[String(k)]=H}};if(u instanceof FormData)for(let[k,T]of u)b(k,T);else for(let[k,T]of Object.entries(u))b(k,T);return new ce("Form",f)}static json(u){return new ce("Json",u)}static text(u){return new ce("Text",u)}static bytes(u){return new ce("Bytes",Array.from(u instanceof ArrayBuffer?new Uint8Array(u):u))}},wt=class{constructor(u){this.url=u.url,this.status=u.status,this.ok=this.status>=200&&this.status<300,this.headers=u.headers,this.rawHeaders=u.rawHeaders,this.data=u.data}},Et=class{constructor(u){this.id=u}async drop(){return I({__tauriModule:"Http",message:{cmd:"dropClient",client:this.id}})}async request(u){let f=!u.responseType||u.responseType===1;return f&&(u.responseType=2),I({__tauriModule:"Http",message:{cmd:"httpRequest",client:this.id,options:u}}).then(b=>{let k=new wt(b);if(f){try{k.data=JSON.parse(k.data)}catch(T){if(k.ok&&k.data==="")k.data={};else if(k.ok)throw Error(`Failed to parse response \`${k.data}\` as JSON: ${T};
              try setting the \`responseType\` option to \`ResponseType.Text\` or \`ResponseType.Binary\` if the API does not return a JSON response.`)}return k}return k})}async get(u,f){return this.request({method:"GET",url:u,...f})}async post(u,f,b){return this.request({method:"POST",url:u,body:f,...b})}async put(u,f,b){return this.request({method:"PUT",url:u,body:f,...b})}async patch(u,f){return this.request({method:"PATCH",url:u,...f})}async delete(u,f){return this.request({method:"DELETE",url:u,...f})}};async function Lt(u){return I({__tauriModule:"Http",message:{cmd:"createClient",options:u}}).then(f=>new Et(f))}var Re=null;async function Hs(u,f){var b;return Re===null&&(Re=await Lt()),Re.request({url:u,method:(b=f==null?void 0:f.method)!=null?b:"GET",...f})}var xe=Pe;const Fs="#DCD7BA",Ws="#727169",$s="#393836",Us="#223249",Ns="#1F1F28",zs="#DCD7BA",js="#0d0c0c",Ks="#c4746e",qs="#8a9a7b",Vs="#c4b28a",Gs="#8ba4b0",Xs="#a292a3",Ys="#8ea4a2",Js="#C8C093",Zs="#a6a69c",Qs="#E46876",er="#87a987",tr="#E6C384",ir="#7FB4CA",sr="#938AA9",rr="#7AA89F",nr="#c5c9c5",or={cursor:Fs,cursorAccent:Ws,selectionInactiveBackground:$s,selectionBackground:Us,background:Ns,foreground:zs,black:js,red:Ks,green:qs,yellow:Vs,blue:Gs,magenta:Xs,cyan:Ys,white:Js,brightBlack:Zs,brightRed:Qs,brightGreen:er,brightYellow:tr,brightBlue:ir,brightMagenta:sr,brightCyan:rr,brightWhite:nr},ar=De('<div class="flex-grow"><div id="terminal" class="w-screen h-screen">');function hr(){const[u,f]=Me(null),b={...or},k=new zt.Terminal({fontFamily:["Noto Mono for Powerline","Roboto Mono for Powerline","Jetbrains Mono","Menlo","Monaco","Consolas","Liberation Mono","Courier New","Noto Sans Mono CJK SC","Noto Sans Mono CJK TC","Noto Sans Mono CJK KR","Noto Sans Mono CJK JP","Noto Sans Mono CJK HK","Noto Color Emoji","Noto Sans Symbols","monospace","sans-serif"].join(","),convertEol:!0,cursorBlink:!0,cursorStyle:"bar",cursorWidth:2,allowProposedApi:!1,tabStopWidth:4,smoothScrollDuration:0,scrollback:80,scrollOnUserInput:!0,scrollSensitivity:1,cols:80,rows:24,theme:b}),T=async()=>{H.fit(),console.log("Resizing terminal"),console.log(k.rows,k.cols),await xe("resize_pty",{rows:k.rows,cols:k.cols})},H=new jt.FitAddon;xt(()=>{const n=u();n&&(k.loadAddon(new Kt.WebLinksAddon),k.loadAddon(H),k.open(n),xe("async_shell").catch(l=>{console.error("Error creating shell:",l)}),T())});const B=n=>{k.write(n.payload)},t=n=>{xe("write_to_pty",{data:n})};return Mt(()=>{k.dispose(),window.removeEventListener("resize",T)}),k.onData(t),be.emit("resize",T),window.addEventListener("resize",T),Ie("data",B),T(),(()=>{const n=ar(),l=n.firstChild;return Ut(f,l),n})()}const lr=De('<div><ul class="flex space-x-2"><li class="cursor-pointer py-2 px-4 bg-gray-200 hover:bg-gray-300">+ New Tab</li></ul><div class="mt-4">'),cr=De('<li>Tab <button class="ml-2 text-red-600 hover:text-red-800">X'),dr=De("<div>");function kt(){const[u,f]=Me([{id:0}]),[b,k]=Me(0),T=()=>{const t=u().length;f([...u(),{id:t}]),k(t)},H=t=>{const n=u().filter(l=>l.id!==t);f(n),b()===t&&n.length>0&&(k(n[n.length-1].id),console.log(b()))},B=t=>{k(t),console.log("Switched to tab",t)};return console.log("activeTab",b()),(()=>{const t=lr(),n=t.firstChild,l=n.firstChild,v=n.nextSibling;return le(n,()=>u().map(h=>(()=>{const _=cr(),m=_.firstChild,p=m.nextSibling;return _.$$click=()=>B(h.id),le(_,()=>h.id+1,p),p.$$click=()=>H(h.id),de(c=>{const e=h.id,r=`cursor-pointer py-2 px-4 ${b()===h.id?"bg-gray-300":"bg-gray-200"}`;return e!==c._v$&&ze(_,"key",c._v$=e),r!==c._v$2&&je(_,c._v$2=r),c},{_v$:void 0,_v$2:void 0}),_})()),l),l.$$click=T,le(v,()=>u().map(h=>(()=>{const _=dr();return le(_,ke(hr,{})),de(m=>{const p=h.id,c=h.id===b()?"block":"hidden";return p!==m._v$3&&ze(_,"key",m._v$3=p),c!==m._v$4&&je(_,m._v$4=c),m},{_v$3:void 0,_v$4:void 0}),_})())),t})()}$t(["click"]);ke(kt,{});function ur(){return ke(kt,{})}Wt(()=>ke(ur,{}),document.getElementById("root"));
